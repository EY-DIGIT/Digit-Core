function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n=require("react"),r=e(n),a=require("react-router-dom"),o=require("react-i18next"),i=require("@egovernments/digit-ui-react-components"),l=require("redux"),c=require("react-redux"),u=e(require("lodash.merge")),s=require("react-hook-form"),m=require("react-query");function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(a[n]=e[n]);return a}function E(e,t){switch(void 0===e&&(e={}),t.type){case"CREATE_COMPLAINT":return d({},e,{response:t.payload});case"FETCH_COMPLAINTS":return d({},e,{list:t.payload.complaints});case"UPDATE_COMPLAINT":return d({},e,{response:t.payload});case"APPLY_INBOX_FILTER":return d({},e,{response:t.payload.response.instances});default:return e}}var f=function(e,t){return""+e.path+t},C=function(e){var t=a.useHistory(),l=o.useTranslation().t,c=a.useParams().id,u=n.useState(null),s=u[0],m=u[1],p=n.useState(!0),E=p[0],f=p[1];return r.createElement(i.Card,null,r.createElement(i.CardHeader,null,l("CS_REOPEN_COMPLAINT")),r.createElement(i.CardText,null),E?null:r.createElement(i.CardLabelError,null,l("CS_ADDCOMPLAINT_ERROR_REOPEN_REASON")),r.createElement(i.RadioButtons,{onSelect:function(e){var t=Digit.SessionStorage.get("reopen."+c);Digit.SessionStorage.set("reopen."+c,d({},t,{reason:e})),m(e)},selectedOption:s,options:[l("CS_REOPEN_OPTION_ONE"),l("CS_REOPEN_OPTION_TWO"),l("CS_REOPEN_OPTION_THREE"),l("CS_REOPEN_OPTION_FOUR")]}),r.createElement(i.SubmitBar,{label:l("CS_COMMON_NEXT"),onSubmit:function(){null===s?f(!1):t.push(e.match.path+"/upload-photo/"+c)}}))},S=function(e){var t,l,c=o.useTranslation().t,u=a.useHistory(),s=a.useParams().id,m=n.useState(null),p=m[0],E=m[1],f=n.useState(!0),C=f[0],S=f[1];return n.useEffect(function(){var e=Digit.SessionStorage.get("reopen."+s);Digit.SessionStorage.set("reopen."+s,d({},e,{verificationDocuments:p}))},[p,s]),r.createElement(r.Fragment,null,r.createElement(i.Card,null,r.createElement(i.ImageUploadHandler,{header:c("CS_ADDCOMPLAINT_UPLOAD_PHOTO"),tenantId:null==e||null===(t=e.complaintDetails)||void 0===t||null===(l=t.service)||void 0===l?void 0:l.tenantId,cardText:"",onPhotoChange:function(e){!function(e){if(null!=e&&e.length){var t=e.map(function(e){return{documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}}});E(t)}}(e)},uploadedImages:null}),C?null:r.createElement(i.CardLabelError,null,c("CS_ADDCOMPLAINT_UPLOAD_ERROR_MESSAGE")),r.createElement(i.SubmitBar,{label:c("PT_COMMONS_NEXT"),onSubmit:function(){null===p?S(!1):u.push(e.match.path+"/addional-details/"+s)}}),e.skip?r.createElement(i.LinkButton,{label:c("CORE_COMMON_SKIP_CONTINUE"),onClick:function(){u.push(e.match.path+"/addional-details/"+s)}}):null))},O=function(e){var t=e.cityCode,n=e.complaintType,r=e.description,a=e.landmark,o=e.city,i=e.district,l=e.region,c=e.state,u=e.pincode,s=e.localityCode,m=e.localityName,d=e.uploadedImages,p=e.mobileNumber,E=e.name;return function(e,f){try{return Promise.resolve(Digit.Complaint.create({cityCode:t,complaintType:n,description:r,landmark:a,city:o,district:i,region:l,state:c,pincode:u,localityCode:s,localityName:m,uploadedImages:d,mobileNumber:p,name:E})).then(function(t){e({type:"CREATE_COMPLAINT",payload:t})})}catch(e){return Promise.reject(e)}}},_=function(e){return function(t){try{return Promise.resolve(Digit.PGRService.update(e)).then(function(e){t({type:"UPDATE_COMPLAINT",payload:e})})}catch(e){return Promise.reject(e)}}},v=function(e){var t=a.useHistory(),l=a.useParams().id,u=c.useDispatch(),s=c.useSelector(function(e){return e}).common,m=o.useTranslation().t,p=e.complaintDetails;n.useEffect(function(){if(s.complaints){var n=s.complaints.response;n&&"successful"===n.responseInfo.status&&t.push(e.match.path+"/response/:"+l)}},[s.complaints,e.history]);var E=n.useCallback(function(n){try{return Promise.resolve(u(_(n))).then(function(){t.push(e.match.path+"/response/"+l)})}catch(e){return Promise.reject(e)}},[u]);return r.createElement(r.Fragment,null,r.createElement(i.Card,null,r.createElement(i.CardHeader,null,m("CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS")),r.createElement(i.CardText,null,m("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT")),r.createElement(i.TextArea,{name:"AdditionalDetails",onChange:function(e){var t=Digit.SessionStorage.get("reopen."+l);Digit.SessionStorage.set("reopen."+l,d({},t,{addtionalDetail:e.target.value}))}}),r.createElement("div",{onClick:function(){var t=Digit.SessionStorage.get("reopen."+l);return p&&(p.workflow=function(e,t){return{action:"REOPEN",comments:e.addtionalDetail,assignes:[],verificationDocuments:e.verificationDocuments}}(t),p.service.additionalDetail={REOPEN_REASON:t.reason},E({service:p.service,workflow:p.workflow})),r.createElement(a.Redirect,{to:{pathname:e.parentRoute+"/response",state:{complaintDetails:p}}})}},r.createElement(i.SubmitBar,{label:m("CS_HEADER_REOPEN_COMPLAINT")}))))},T=function(e){var t=e.action,n=o.useTranslation().t;switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},g=function(e){var t=e.response.complaints,n=o.useTranslation().t;return r.createElement(i.Banner,t&&t.response&&t.response.responseInfo?{message:T(t.response.ServiceWrappers[0].workflow),complaintNumber:t.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:n("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},N=function(e){var t=e.response.complaints,n=o.useTranslation().t;if(t&&t.response&&t.response.responseInfo)return r.createElement(i.CardText,null,n("RATE"===t.response.ServiceWrappers[0].workflow.action?"CS_COMMON_RATING_SUBMIT_TEXT":"CS_COMMON_TRACK_COMPLAINT_TEXT"))},y=function(e){var t=o.useTranslation().t,n=c.useSelector(function(e){return e}).pgr;return r.createElement(i.Card,null,n.complaints.response&&r.createElement(g,{response:n}),n.complaints.response&&r.createElement(N,{response:n}),r.createElement(a.Link,{to:"/digit-ui/citizen"},r.createElement(i.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))},h=function(e){var t,n=e.match,o=e.parentRoute,i=window.location.pathname.split("/"),l=i[i.length-1],c=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId(),u=Digit.Hooks.pgr.useComplaintDetails({tenantId:c,id:l}).complaintDetails;return r.createElement(a.Switch,null,r.createElement(a.Route,{exact:!0,path:f(n,"/:id"),component:function(){return r.createElement(C,{match:n,complaintDetails:u})}}),r.createElement(a.Route,{path:f(n,"/upload-photo/:id"),component:function(){return r.createElement(S,{match:n,skip:!0,complaintDetails:u})}}),r.createElement(a.Route,{path:f(n,"/addional-details/:id"),component:function(){return r.createElement(v,{match:n,parentRoute:o,complaintDetails:u})}}),r.createElement(a.Route,{path:f(n,"/response"),component:function(){return r.createElement(y,{match:n})}}))},M=function(e){var t=e.action,n=o.useTranslation().t;switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},I=function(e){var n=e.response.complaints;return r.createElement(i.Banner,n&&n.response&&n.response.responseInfo?{message:M(n.response.ServiceWrappers[0].workflow),complaintNumber:n.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},A=function(e){var t=o.useTranslation().t,n=c.useSelector(function(e){return e}).pgr;return r.createElement(i.Card,null,n.complaints.response&&r.createElement(I,{response:n}),r.createElement(i.CardText,null,t("CS_COMMON_TRACK_COMPLAINT_TEXT")),r.createElement(a.Link,{to:"/digit-ui/citizen"},r.createElement(i.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))},P={routes:{"complaint-type":{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=n.useState(function(){return l.complaintType||{}}),u=c[0],s=c[1],m=a.texts,p=Digit.Hooks.pgr.useComplaintTypes({stateCode:Digit.ULBService.getCurrentTenantId()});return r.createElement(i.TypeSelectCard,d({},m,{menu:p,optionsKey:"name",selected:function(e){s(e)},selectedOption:u,onSave:function(){o({complaintType:u})},t:t,disabled:0===Object.keys(u).length||null===u}))},texts:{headerCaption:"",header:"CS_ADDCOMPLAINT_COMPLAINT_TYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_TYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"sub-type"},"sub-type":{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=n.useState(function(){return l.subType||{}}),u=c[0],s=c[1],m=l.complaintType,p=Digit.Hooks.pgr.useComplaintSubType(m,t),E=d({},a.texts,{headerCaption:t("SERVICEDEFS."+m.key.toUpperCase())},{menu:p},{optionsKey:"name"},{selected:function(e){s(e)}},{selectedOption:u},{onSave:function(){o({subType:u})}});return r.createElement(i.TypeSelectCard,d({},E,{disabled:0===Object.keys(u).length||null===u,t:t}))},texts:{header:"CS_ADDCOMPLAINT_COMPLAINT_SUBTYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_SUBTYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"map"},map:{component:function(e){var t=e.onSelect,n=e.t,a="";return r.createElement(i.LocationSearchCard,{header:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_HEADER"),cardText:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_TEXT"),nextText:n("CS_COMMON_NEXT"),skipAndContinueText:n("CS_COMMON_SKIP"),skip:function(){return t()},onSave:function(){return t({pincode:a})},onChange:function(e){return a=e}})},nextStep:"pincode"},pincode:{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=Digit.Hooks.pgr.useTenants(),u=n.useState(function(){return l.pincode}),s=u[0],m=u[1],p=!s,E=n.useState(null),f=E[1];return r.createElement(i.FormStep,{t:t,config:a,onSelect:function(e){try{var t=c.find(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t==(null==e?void 0:e.pincode)})}),n=function(){if(t)return Digit.SessionStorage.set("city_complaint",t),Promise.resolve(Digit.LocationService.getLocalities(t.code)).then(function(n){Digit.LocalityService.get(n.TenantBoundary[0]).filter(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t==e.pincode})}),o(d({},e,{city_complaint:t}))});Digit.SessionStorage.set("city_complaint",void 0),Digit.SessionStorage.set("selected_localities",void 0),f("CS_COMMON_PINCODE_NOT_SERVICABLE")}();return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},value:s,onChange:function(e){m(e.target.value),p=!e.target.value,f(null)},onSkip:function(){return o()},forcedError:t(E[0]),isDisabled:p})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PINCODE_LABEL",cardText:"CS_ADDCOMPLAINT_CHANGE_PINCODE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CORE_COMMON_PINCODE",type:"text",name:"pincode",validation:{minLength:6,maxLength:7},error:"CORE_COMMON_PINCODE_INVALID"}],nextStep:"address"},address:{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=Digit.Hooks.pgr.useTenants(),u=null!=l&&l.pincode?c.filter(function(e){var t;return null==e||null===(t=e.pincode)||void 0===t?void 0:t.some(function(e){return e==l.pincode})}):c,s=n.useState(function(){return l.city_complaint||null}),m=s[0],d=s[1],p=Digit.Hooks.useBoundaryLocalities(null==m?void 0:m.code,"admin",{enabled:!!m},t).data,E=n.useState(null),f=E[0],C=E[1],S=n.useState(function(){return l.locality_complaint||null}),O=S[0],_=S[1];function v(e){_(null),C(null),d(e)}function T(e){_(e)}return n.useEffect(function(){if(m&&p){var e=l.pincode,t=e?p.filter(function(t){return t.pincode==e}):p;C(t)}},[m,p]),r.createElement(i.FormStep,{config:a,onSelect:function(){o({city_complaint:m,locality_complaint:O})},t:t,isDisabled:!O},r.createElement("div",null,r.createElement(i.CardLabel,null,t("MYCITY_CODE_LABEL")),(null==u?void 0:u.length)<5?r.createElement(i.RadioButtons,{selectedOption:m,options:u,optionsKey:"i18nKey",onSelect:v}):r.createElement(i.Dropdown,{isMandatory:!0,selected:m,option:u,select:v,optionKey:"i18nKey",t:t}),m&&f&&r.createElement(i.CardLabel,null,t("CS_CREATECOMPLAINT_MOHALLA")),m&&f&&r.createElement(r.Fragment,null,(null==f?void 0:f.length)<5?r.createElement(i.RadioButtons,{selectedOption:O,options:f,optionsKey:"i18nkey",onSelect:T}):r.createElement(i.Dropdown,{isMandatory:!0,selected:O,optionKey:"i18nkey",option:f,select:T,t:t}))))},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_ADDCOMPLAINT_PROVIDE_COMPLAINT_ADDRESS",cardText:"CS_ADDCOMPLAINT_CITY_MOHALLA_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"landmark"},landmark:{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=n.useState(function(){return l.landmark||""}),u=c[1];return r.createElement(i.FormStep,{config:a,value:c[0],onChange:function(e){u(e.target.value)},onSelect:function(e){return o(e)},onSkip:function(){return o()},t:t})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE",cardText:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CS_ADDCOMPLAINT_LANDMARK",type:"textarea",name:"landmark"}],nextStep:"upload-photos"},"upload-photos":{component:function(e){var t,a=e.t,o=e.config,l=e.onSelect,c=e.onSkip,u=e.value,s=n.useState(function(){return u.uploadedImages||null}),m=s[0],d=s[1];return r.createElement(i.FormStep,{config:o,onSelect:function(){if(!m||0===m.length)return c();l({uploadedImages:m})},onSkip:c,t:a},r.createElement(i.ImageUploadHandler,{tenantId:null===(t=u.city_complaint)||void 0===t?void 0:t.code,uploadedImages:m,onPhotoChange:function(e){d(e)}}))},texts:{header:"CS_ADDCOMPLAINT_UPLOAD_PHOTO",cardText:"CS_ADDCOMPLAINT_UPLOAD_PHOTO_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},nextStep:"additional-details"},"additional-details":{component:function(e){var t=e.t,a=e.config,o=e.onSelect,l=e.value,c=n.useState(function(){return l.details||""}),u=c[0],s=c[1];return r.createElement(i.FormStep,{config:a,onChange:function(e){s(e.target.value)},onSelect:function(){return o({details:u})},value:u,t:t})},texts:{header:"CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS",cardText:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT",submitBarLabel:"CS_COMMON_NEXT"},inputs:[{label:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS",type:"textarea",name:"details"}],nextStep:null}},indexRoute:"complaint-type"},D=["city_complaint","locality_complaint","uploadedImages","complaintType","subType","details"],L=function(e){var t=e.data,n=e.path,l=t.serviceCode,c=t.serviceRequestId,u=t.applicationStatus,s=a.useHistory(),m=o.useTranslation().t,d=["RESOLVED","REJECTED","CLOSEDAFTERREJECTION","CLOSEDAFTERRESOLUTION"];return r.createElement(r.Fragment,null,r.createElement(i.Card,{onClick:function(){s.push(n+"/"+c)}},r.createElement(i.CardSubHeader,null,m("SERVICEDEFS."+l.toUpperCase())),r.createElement(i.DateWrap,{date:Digit.DateUtils.ConvertTimestampToDate(t.auditDetails.createdTime)}),r.createElement(i.KeyNote,{keyValue:m("CS_COMMON_COMPLAINT_NO"),note:c}),r.createElement("div",{className:"status-highlight "+(d.includes(u)?"success":"")},r.createElement("p",null,(d.includes(u)?m("CS_COMMON_CLOSED"):m("CS_COMMON_OPEN")).toUpperCase())),m("CS_COMMON_"+u)))};"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var b=function(e){var t=e.name,n=e.isCompleted,a=e.mobile,l=e.text,c=e.customChild,u=o.useTranslation();return r.createElement(i.CheckPoint,{label:(0,u.t)("CS_COMMON_PENDINGATLME"),isCompleted:n,customChild:r.createElement("div",null,t&&a?r.createElement(i.TelePhone,{mobile:a,text:l+" "+t}):null,c)})},R=function(e){return r.createElement(i.CheckPoint,{isCompleted:e.isCompleted,label:e.text,customChild:e.customChild})},k=function(e){return r.createElement(i.Rating,{text:e.text,withText:!0,currentRating:e.rating,maxRating:5,onFeedback:function(){}})},x=function(e){var t=e.action,n=e.nextActions,l=e.complaintDetails,c=e.ComplainMaxIdleTime,u=void 0===c?36e5:c,s=e.serviceRequestId,m=e.reopenDate,d=e.isCompleted,p=e.customChild,E=o.useTranslation().t;if("RESOLVE"===t){var f=n&&n.map(function(e,t){if(e&&"COMMENT"!==e)return r.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+s},r.createElement(i.ActionLinks,null,E("CS_COMMON_"+e)))});return r.createElement(i.CheckPoint,{isCompleted:d,label:E("CS_COMMON_COMPLAINT_RESOLVED"),customChild:r.createElement("div",null,f,p)})}if("RATE"===t)return r.createElement(i.CheckPoint,{isCompleted:d,label:E("CS_COMMON_COMPLAINT_RESOLVED"),customChild:r.createElement("div",null,p)});if("REOPEN"===t)return r.createElement(i.CheckPoint,{isCompleted:d,label:E("CS_COMMON_COMPLAINT_REOPENED"),info:m,customChild:p});var C=n&&n.map(function(e,t){var n,o;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==l||null===(n=l.service)||void 0===n||null===(o=n.auditDetails)||void 0===o?void 0:o.lastModifiedTime)<u))return r.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+s},r.createElement(i.ActionLinks,null,E("CS_COMMON_"+e)))});return r.createElement(i.CheckPoint,{isCompleted:d,label:E("CS_COMMON_COMPLAINT_RESOLVED"),customChild:r.createElement("div",null,C,p)})},w=function(e){var t=e.action,n=e.nextActions,l=e.complaintDetails,c=e.ComplainMaxIdleTime,u=void 0===c?36e5:c,s=e.rating,m=e.serviceRequestId,d=e.reopenDate,p=e.isCompleted,E=o.useTranslation().t;if("REJECTED"===t){var f=n&&n.map(function(e,t){if(e&&"COMMENT"!==e)return r.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+m},r.createElement(i.ActionLinks,null,E("CS_COMMON_"+e)))});return r.createElement(i.CheckPoint,{isCompleted:p,label:E("CS_COMMON_COMPLAINT_REJECTED"),customChild:r.createElement("div",null,f)})}if("RATE"===t&&s)return r.createElement(i.CheckPoint,{isCompleted:p,label:E("CS_COMMON_COMPLAINT_REJECTED"),customChild:r.createElement("div",null,s?r.createElement(k,{text:E("CS_ADDCOMPLAINT_YOU_RATED"),rating:s}):null,customChild)});if("REOPEN"===t)return r.createElement(i.CheckPoint,{isCompleted:p,label:E("CS_COMMON_COMPLAINT_REOPENED"),info:d});var C=n&&n.map(function(e,t){var n,o;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==l||null===(n=l.service)||void 0===n||null===(o=n.auditDetails)||void 0===o?void 0:o.lastModifiedTime)<u))return r.createElement(a.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+m},r.createElement(i.ActionLinks,null,E("CS_COMMON_"+e)))});return r.createElement(i.CheckPoint,{isCompleted:p,label:E("CS_COMMON_COMPLAINT_REJECTED"),customChild:r.createElement("div",null,C)})},F=function(e){var t=e.data,n=o.useTranslation().t;return r.createElement("div",null,(null==t?void 0:t.date)&&r.createElement("p",null,null==t?void 0:t.date),r.createElement("p",null,null==t?void 0:t.name),r.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&r.createElement("p",null,n("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))))},H=function(e){var t=e.data,a=e.serviceRequestId,l=e.complaintWorkflow,c=e.rating,u=e.zoomImage,s=e.complaintDetails,m=e.ComplainMaxIdleTime,p=o.useTranslation().t,E=t.timeline,f=n.useMemo(function(){return null==E?void 0:E.length},[E]);n.useEffect(function(){null==E||E.filter(function(e,t,n){return t===n.length-1&&"PENDINGFORASSIGNMENT"===e.status});var e=(null==E?void 0:E.filter(function(e){return"PENDINGFORASSIGNMENT"===(null==e?void 0:e.status)})).at(-1);null==E||E.push(d({},e,{performedAction:"FILED",status:"COMPLAINT_FILED"}))},[E]);var C=function(e){var t,a=e.comment,o=e.thumbnailsToShow,l=e.auditDetails,c=e.assigner,m={date:null==l?void 0:l.lastModified,name:null==c?void 0:c.name,mobileNumber:null==c?void 0:c.mobileNumber,source:"COMPLAINT_FILED"==e.status?null==s?void 0:s.audit.source:""};return r.createElement(n.Fragment,null,a?r.createElement("div",null,null==a?void 0:a.map(function(e){return r.createElement("div",{className:"TLComments"},r.createElement("h3",null,p("WF_COMMON_COMMENTS")),r.createElement("p",null,e))})):null,(null==o||null===(t=o.thumbs)||void 0===t?void 0:t.length)>0?r.createElement("div",{className:"TLComments"},r.createElement("h3",null,p("CS_COMMON_ATTACHMENTS")),r.createElement(i.DisplayPhotos,{srcs:o.thumbs,onClick:function(e,t){!function(e,t,n){var r,a,o=null===(r=n.thumbs)||void 0===r?void 0:r.findIndex(function(t){return t===e});u(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}(e,0,o)}})):null,null!=m&&m.date?r.createElement(F,{data:m,comments:a}):null)};return r.createElement(r.Fragment,null,r.createElement(i.CardSubHeader,null,p("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),E&&f>0?r.createElement(i.ConnectingCheckPoints,null,E.map(function(e,t,n){return function(e){var t=e.status,n=e.caption,o=e.auditDetails,u=e.timeLineActions,E=e.index,f=e.comment,S=e.thumbnailsToShow,O=e.assigner,_=e.totalTimelineLength,v=0===E;switch(t){case"PENDINGFORREASSIGNMENT":return r.createElement(i.CheckPoint,{isCompleted:v,key:E,label:p("CS_COMMON_"+t),customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O})});case"PENDINGFORASSIGNMENT":var T=_-(E+1)==0;return r.createElement(R,{key:E,isCompleted:v,text:p("CS_COMMON_"+t),customChild:C(d({comment:f},T?{auditDetails:o}:{thumbnailsToShow:S,auditDetails:o}))});case"PENDINGFORASSIGNMENT_AFTERREOPEN":return r.createElement(R,{isCompleted:v,key:E,text:p("CS_COMMON_"+t),customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O})});case"PENDINGATLME":var g=n&&n.length>0?n[0]:{name:"",mobileNumber:""},N=g.name,y=g.mobileNumber,h=""+p("CS_COMMON_"+t);return r.createElement(b,{isCompleted:v,key:E,name:N,mobile:y,text:h,customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O})});case"RESOLVED":return r.createElement(x,{key:E,isCompleted:v,action:l.action,nextActions:E<=1&&u,complaintDetails:s,ComplainMaxIdleTime:m,serviceRequestId:a,reopenDate:Digit.DateUtils.ConvertTimestampToDate(o.lastModifiedTime),customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O})});case"REJECTED":return r.createElement(w,{key:E,isCompleted:v,action:l.action,nextActions:E<=1&&u,complaintDetails:s,ComplainMaxIdleTime:m,serviceRequestId:a,reopenDate:Digit.DateUtils.ConvertTimestampToDate(o.lastModifiedTime),customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O})});case"CLOSEDAFTERRESOLUTION":return r.createElement(i.CheckPoint,{isCompleted:v,key:E,label:p("CS_COMMON_CS_COMMON_"+t),customChild:r.createElement("div",null,C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O}),c?r.createElement(k,{text:p("CS_ADDCOMPLAINT_YOU_RATED"),rating:c}):null)});case"COMPLAINT_FILED":return r.createElement(i.CheckPoint,{isCompleted:v,key:E,label:p("CS_COMMON_COMPLAINT_FILED"),customChild:C({comment:f,auditDetails:o,assigner:O,status:t})});default:return r.createElement(i.CheckPoint,{isCompleted:v,key:E,label:p("CS_COMMON_"+t),customChild:C({comment:f,thumbnailsToShow:S,auditDetails:o,assigner:O,status:t})})}}({status:e.status,caption:e.caption,auditDetails:e.auditDetails,timeLineActions:e.timeLineActions,index:t,array:n,performedAction:e.performedAction,comment:e.wfComment,thumbnailsToShow:e.thumbnailsToShow,assigner:e.assigner,totalTimelineLength:f})})):r.createElement(i.Loader,null))},U=function(e){var t,a=e.complaintDetails,o=e.id,i=e.getWorkFlow,l=e.zoomImage,c=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||a.service.tenantId,u=Digit.Hooks.useWorkflowDetails({tenantId:c,id:o,moduleCode:"PGR"}),s=Digit.Hooks.pgr.useMDMS.ComplainClosingTime(null==c?void 0:c.split(".")[0]).data;return n.useEffect(function(){i(u.data)},[u.data]),n.useEffect(function(){u.revalidate()},[]),!u.isLoading&&r.createElement(H,{data:u.data,serviceRequestId:o,complaintWorkflow:a.workflow,rating:a.audit.rating,zoomImage:l,complaintDetails:a,ComplainMaxIdleTime:s})},B=["path","url"],G=function(){var e,t,n,l,c,u,s,m,E,f,C=o.useTranslation().t,S=a.useRouteMatch(),O=S.path,_=S.url,v=p(S,B),T=a.useLocation(),g=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintCitizen"),N=null===(n=Digit)||void 0===n||null===(l=n.ComponentRegistryService)||void 0===l?void 0:l.getComponent("PGRComplaintsList"),y=null===(c=Digit)||void 0===c||null===(u=c.ComponentRegistryService)||void 0===u?void 0:u.getComponent("PGRComplaintDetailsPage"),M=null===(s=Digit)||void 0===s||null===(m=s.ComponentRegistryService)||void 0===m?void 0:m.getComponent("PGRSelectRating"),I=null===(E=Digit)||void 0===E||null===(f=E.ComponentRegistryService)||void 0===f?void 0:f.getComponent("PGRResponseCitzen");return r.createElement(r.Fragment,null,r.createElement("div",{className:"pgr-citizen-wrapper"},!T.pathname.includes("/response")&&r.createElement(i.BackButton,null,C("CS_COMMON_BACK")),r.createElement(a.Switch,null,r.createElement(i.PrivateRoute,{path:O+"/create-complaint",component:g}),r.createElement(i.PrivateRoute,{path:O+"/complaints",exact:!0,component:N}),r.createElement(i.PrivateRoute,{path:O+"/complaints/:id*",component:y}),r.createElement(i.PrivateRoute,{path:O+"/reopen",component:function(){return r.createElement(h,{match:d({},v,{url:_,path:O+"/reopen"}),parentRoute:O})}}),r.createElement(i.PrivateRoute,{path:O+"/rate/:id*",component:function(){return r.createElement(M,{parentRoute:O})}}),r.createElement(i.PrivateRoute,{path:O+"/response",component:function(){return r.createElement(I,{match:d({},v,{url:_,path:O})})}}))))},j=function(){n.useState(!1),n.useState(!1);var e,t,l,c,u,s,m,d,p=a.useRouteMatch(),E=o.useTranslation().t,f={home:{content:E("CS_COMMON_HOME"),path:"/digit-ui/employee"},inbox:{content:E("CS_COMMON_INBOX"),path:p.url+"/inbox"},createComplaint:{content:E("CS_PGR_CREATE_COMPLAINT"),path:p.url+"/complaint/create"},complaintDetails:{content:E("CS_PGR_COMPLAINT_DETAILS"),path:p.url+"/complaint/details/:id"},response:{content:E("CS_PGR_RESPONSE"),path:p.url+"/response"}},C=a.useLocation().pathname,S=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintEmp"),O=null===(l=Digit)||void 0===l||null===(c=l.ComponentRegistryService)||void 0===c?void 0:c.getComponent("PGRComplaintDetails"),_=null===(u=Digit)||void 0===u||null===(s=u.ComponentRegistryService)||void 0===s?void 0:s.getComponent("PGRInbox"),v=null===(m=Digit)||void 0===m||null===(d=m.ComponentRegistryService)||void 0===d?void 0:d.getComponent("PGRResponseEmp");return r.createElement(r.Fragment,null,r.createElement("div",{className:"ground-container"},!C.includes("/response")&&r.createElement(a.Switch,null,r.createElement(a.Route,{path:p.url+"/complaint/create",component:function(){return r.createElement(i.BreadCrumb,{crumbs:[f.home,f.createComplaint]})}}),r.createElement(a.Route,{path:p.url+"/complaint/details/:id",component:function(){return r.createElement(i.BreadCrumb,{crumbs:[f.home,f.inbox,f.complaintDetails]})}}),r.createElement(a.Route,{path:p.url+"/inbox",component:function(){return r.createElement(i.BreadCrumb,{crumbs:[f.home,f.inbox]})}}),r.createElement(a.Route,{path:p.url+"/response",component:r.createElement(i.BreadCrumb,{crumbs:[f.home,f.response]})})),r.createElement(a.Switch,null,r.createElement(a.Route,{path:p.url+"/complaint/create",component:function(){return r.createElement(S,{parentUrl:p.url})}}),r.createElement(a.Route,{path:p.url+"/complaint/details/:id*",component:function(){return r.createElement(O,null)}}),r.createElement(a.Route,{path:p.url+"/inbox",component:_}),r.createElement(a.Route,{path:p.url+"/response",component:v}))))},V=function(){return r.createElement(i.EmployeeAppContainer,null,r.createElement(j,null))},$=function(){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},r.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),r.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}))},z=function(e){return r.createElement("h1",{className:"heading-m"},e.label)},Y=function(e){return r.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},r.createElement($,null))},W=function(e){var t=e.data,n=e.comments,a=o.useTranslation().t;return r.createElement("div",null,(null==t?void 0:t.date)&&r.createElement("p",null,null==t?void 0:t.date),r.createElement("p",null,null==t?void 0:t.name),r.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&r.createElement("p",null,a("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))),null==n?void 0:n.map(function(e){return r.createElement("div",{className:"TLComments"},r.createElement("h3",null,a("WF_COMMON_COMMENTS")),r.createElement("p",null,e))}))},K=function(e){var t,a,o,l,c,u,s,m=e.workflowDetails,d=e.complaintDetails,p=e.close,E=e.popup,f=e.selectedAction,C=e.onAssign,S=e.tenantId,O=e.t,_=null==m||null===(t=m.data)||void 0===t||null===(a=t.initialActionState)||void 0===a||null===(o=a.nextActions)||void 0===o?void 0:o.filter(function(e){return(null==e?void 0:e.action)==f}),v=Digit.Hooks.pgr.useEmployeeFilter(S,(null==_||null===(l=_[0])||void 0===l||null===(c=l.assigneeRoles)||void 0===c?void 0:c.length)>0?null==_||null===(u=_[0])||void 0===u||null===(s=u.assigneeRoles)||void 0===s?void 0:s.join(","):"",d),T=v?v.map(function(e){return{heading:e.department,options:e.employees}}):null,g=n.useState(null),N=g[0],y=g[1],h=n.useState(""),M=h[0],I=h[1],A=n.useState(null),P=A[0],D=A[1],L=n.useState(null),b=L[0],R=L[1],k=n.useState(null),x=k[0],w=k[1],F=Digit.ULBService.getCurrentUlb(),H=n.useState(null),U=H[0],B=H[1];n.useEffect(function(){!function(){try{w(null);var e=function(){if(P){var e=function(){if(P.size>=5242880)w(O("CS_MAXIMUM_UPLOAD_SIZE_EXCEEDED"));else{var e=function(e,t){try{var n=Promise.resolve(Digit.UploadServices.Filestorage("property-upload",P,F.code)).then(function(e){var t,n,r,a;(null==e||null===(t=e.data)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)>0?R(null==e||null===(r=e.data)||void 0===r||null===(a=r.files[0])||void 0===a?void 0:a.fileStoreId):w(O("CS_FILE_UPLOAD_ERROR"))})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){w(O("CS_FILE_UPLOAD_ERROR"))});if(e&&e.then)return e.then(function(){})}}();if(e&&e.then)return e.then(function(){})}}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[P]);var G=[O("CS_REOPEN_OPTION_ONE"),O("CS_REOPEN_OPTION_TWO"),O("CS_REOPEN_OPTION_THREE"),O("CS_REOPEN_OPTION_FOUR")];return r.createElement(i.Modal,{headerBarMain:r.createElement(z,{label:O("ASSIGN"===f||"REASSIGN"===f?"CS_ACTION_ASSIGN":"REJECT"===f?"CS_ACTION_REJECT":"REOPEN"===f?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE")}),headerBarEnd:r.createElement(Y,{onClick:function(){return p(E)}}),actionCancelLabel:O("CS_COMMON_CANCEL"),actionCancelOnSubmit:function(){return p(E)},actionSaveLabel:O("ASSIGN"===f||"REASSIGN"===f?"CS_COMMON_ASSIGN":"REJECT"===f?"CS_COMMON_REJECT":"REOPEN"===f?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE"),actionSaveOnSubmit:function(){"REJECT"!==f||M?C(N,M,b):w(O("CS_MANDATORY_COMMENTS"))},error:x,setError:w},r.createElement(i.Card,null,"REJECT"===f||"RESOLVE"===f||"REOPEN"===f?null:r.createElement(r.Fragment,null,r.createElement(i.CardLabel,null,O("CS_COMMON_EMPLOYEE_NAME")),T&&r.createElement(i.SectionalDropdown,{selected:N,menuData:T,displayKey:"name",select:function(e){y(e)}})),"REOPEN"===f?r.createElement(r.Fragment,null,r.createElement(i.CardLabel,null,O("CS_REOPEN_COMPLAINT")),r.createElement(i.Dropdown,{selected:U,option:G,select:function(e){B(e)}})):null,r.createElement(i.CardLabel,null,O("CS_COMMON_EMPLOYEE_COMMENTS")),r.createElement(i.TextArea,{name:"comment",onChange:function(e){w(null),I(e.target.value)},value:M}),r.createElement(i.CardLabel,null,O("CS_ACTION_SUPPORTING_DOCUMENTS")),r.createElement(i.CardLabelDesc,null,O("CS_UPLOAD_RESTRICTIONS")),r.createElement(i.UploadFile,{id:"pgr-doc",accept:".jpg",onUpload:function(e){D(e.target.files[0])},onDelete:function(){R(null)},message:b?"1 "+O("CS_ACTION_FILEUPLOADED"):O("CS_ACTION_NO_FILEUPLOADED")})))},q=function(e){var t=s.useForm(),a=t.register,l=t.handleSubmit,c=t.errors,u=o.useTranslation().t,m=n.useMemo(function(){var t;return null===(t=e.config)||void 0===t?void 0:t.map(function(e,t,n){return r.createElement(r.Fragment,{key:t},r.createElement(i.CardSectionHeader,null,e.head),e.body.map(function(e,t){var n;return r.createElement(r.Fragment,{key:t},c[e.populators.name]&&(null===(n=e.populators)||void 0===n||!n.validate||c[e.populators.validate])&&r.createElement(i.CardLabelError,null,e.populators.error),r.createElement(i.LabelFieldPair,null,r.createElement(i.CardLabel,null,e.label,e.isMandatory?" * ":null),r.createElement("div",{className:"field"},function(e,t){switch(e){case"text":return r.createElement("div",{className:"field-container"},t.componentInFront?t.componentInFront:null,r.createElement(i.TextInput,d({className:"field desktop-w-full"},t,{inputRef:a(t.validation)})));case"textarea":return r.createElement(i.TextArea,d({className:"field desktop-w-full",name:t.name||""},t,{inputRef:a(t.validation)}));default:return!1!==t.dependency?t:null}}(e.type,e.populators))))}),n.length-1===t?null:r.createElement(i.BreakLine,null))})},[e.config,c]),p=e.isDisabled||!1;return r.createElement("form",{onSubmit:l(function(t){e.onSubmit(t)})},r.createElement(i.Card,null,r.createElement(i.CardSubHeader,null,e.heading),m,e.children,r.createElement(i.ActionBar,null,r.createElement(i.SubmitBar,{disabled:p,label:u(e.label),submit:"submit"}))))},X=function(e){var t=o.useTranslation().t,l=[{text:"ES_PGR_NEW_COMPLAINT",link:"/digit-ui/employee/pgr/complaint/create",accessTo:["CSR"]}],c=n.useState([]),u=c[0],s=c[1];return n.useEffect(function(){var e=[];l.forEach(function(t){t.accessTo?Digit.UserService.hasAccess(t.accessTo)&&e.push(t):e.push(t)}),s(e)},[]),r.createElement(i.Card,{className:"employeeCard filter inboxLinks"},r.createElement("div",{className:"complaint-links-container"},r.createElement("div",{className:"header"},r.createElement("span",{className:"logo"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},r.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"})))," ",r.createElement("span",{className:"text"},t("ES_PGR_HEADER_COMPLAINT"))),r.createElement("div",{className:"body"},u.map(function(e,n){return r.createElement("span",{className:"link",key:n},r.createElement(a.Link,{to:e.link},t(e.text)))}))))},J=function(e){return r.createElement(i.Table,{t:e.t,data:e.data,columns:e.columns,getCellProps:e.getCellProps,onNextPage:e.onNextPage,onPrevPage:e.onPrevPage,currentPage:e.currentPage,totalRecords:e.totalRecords,onPageSizeChange:e.onPageSizeChange,pageSizeLimit:e.pageSizeLimit})},Z=function(e){var t,n=e.complaints,a=e.onAssignmentChange,l=e.pgrfilters,c=o.useTranslation().t,u=Digit.Hooks.pgr.useComplaintStatusCount(n),s=null==l||null===(t=l.applicationStatus)||void 0===t?void 0:t.length;return r.createElement("div",{className:"status-container"},r.createElement("div",{className:"filter-label"},c("ES_PGR_FILTER_STATUS")),0===u.length&&r.createElement(i.Loader,null),u.map(function(e,t){return r.createElement(i.CheckBox,{key:t,onChange:function(t){return a(t,e)},checked:!!s&&0!==l.applicationStatus.filter(function(t){return t.code===e.code}).length,label:e.name+" ("+(e.count||0)+")"})}))},Q={},ee={},te=function(e){var t,a,l,c,u,s,m,p=Digit.UserService.getUser().info.uuid,E=e.searchParams,f=o.useTranslation().t,C=!(null==E||null===(t=E.filters)||void 0===t||null===(a=t.wfFilters)||void 0===a||!a.assignee||null==E||null===(l=E.filters)||void 0===l||null===(c=l.wfFilters)||void 0===c||null===(u=c.assignee[0])||void 0===u||!u.code),S=n.useMemo(function(){return[{code:"ASSIGNED_TO_ME",name:f("ASSIGNED_TO_ME")},{code:"ASSIGNED_TO_ALL",name:f("ASSIGNED_TO_ALL")}]},[f]),O=n.useState(C?S[0]:S[1]),_=O[0],v=O[1];n.useEffect(function(){return v(C?S[0]:S[1])},[f]);var T=n.useState(null),g=T[0],N=T[1],y=n.useState(null),h=y[0],M=y[1],I=n.useState((null==E||null===(s=E.filters)||void 0===s?void 0:s.pgrfilters)||{serviceCode:[],locality:[],applicationStatus:[]}),A=I[0],P=I[1],D=n.useState((null==E||null===(m=E.filters)||void 0===m?void 0:m.wfFilters)||{assignee:[{code:p}]}),L=D[0],b=D[1],R=Digit.ULBService.getCurrentTenantId(),k=Digit.Hooks.useBoundaryLocalities(R,"admin",{},f).data,x=Digit.Hooks.pgr.useServiceDefs(R,"PGR");n.useEffect(function(){var t,n=0;for(var r in A)if(Array.isArray(A[r])){n+=A[r].length;var a,o=A[r].map(function(e){return e.code}).join();o?Q[r]=o:null===(a=Q)||void 0===a||delete a[r]}for(var i in L)if(Array.isArray(L[i])){var l=L[i].map(function(e){return e.code}).join();l?ee[i]=l:ee={}}n+=(null==L||null===(t=L.assignee)||void 0===t?void 0:t.length)||0,"mobile"!==e.type&&U(),Digit.inboxFilterCount=n},[A,L]);var w=function(e,t){return e.filter(function(e){return e.code===t.code}).length};n.useEffect(function(){N(A.serviceCode.length>1?{i18nKey:A.serviceCode.length+" selected"}:A.serviceCode[0])},[A.serviceCode]),n.useEffect(function(){M(A.locality.length>1?{name:A.locality.length+" selected"}:A.locality[0])},[A.locality]);var F=function(e,t){var n,r=A[t].filter(function(t,n){return n!==e});P(d({},A,((n={})[t]=r,n)))};function H(){P({serviceCode:[],locality:[],applicationStatus:[]}),b({assigned:[{code:[]}]}),Q={},ee={},v(""),N(null),M(null)}var U=function(){e.onFilterChange({pgrQuery:Q,wfQuery:ee,wfFilters:L,pgrfilters:A})},B=function(e,t,n,a,o,l,c){var u;return void 0===n&&(n=null),n=n||((u={})[o]=" ",u.code="",u),r.createElement("div",null,r.createElement("div",{className:"filter-label"},e),r.createElement(i.Dropdown,{option:t,selected:n,select:function(e){return a(e,c)},optionKey:o}),r.createElement("div",{className:"tag-container"},A[c].length>0&&A[c].map(function(e,t){return r.createElement(i.RemoveableTag,{key:t,text:e[o].slice(0,22)+" ...",onClick:function(){return l(t,c)}})})))};return r.createElement(r.Fragment,null,r.createElement("div",{className:"filter"},r.createElement("div",{className:"filter-card"},r.createElement("div",{className:"heading"},r.createElement("div",{className:"filter-label"},f("ES_COMMON_FILTER_BY"),":"),r.createElement("div",{className:"clearAll",onClick:H},f("ES_COMMON_CLEAR_ALL")),"desktop"===e.type&&r.createElement("span",{className:"clear-search",onClick:H},f("ES_COMMON_CLEAR_ALL")),"mobile"===e.type&&r.createElement("span",{onClick:e.onClose},r.createElement(i.CloseSvg,null))),r.createElement("div",null,r.createElement(i.RadioButtons,{onSelect:function(e){v(e),b(d({},L,{assignee:[{code:p="ASSIGNED_TO_ME"===e.code?p:""}]}))},selectedOption:_,optionsKey:"name",options:S}),r.createElement("div",null,B(f("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),x,g,function(e){var t={i18nKey:f("SERVICEDEFS."+e.serviceCode.toUpperCase()),code:e.serviceCode};w(A.serviceCode,t)||P(d({},A,{serviceCode:[].concat(A.serviceCode,[t])}))},"i18nKey",F,"serviceCode")),r.createElement("div",null,B(f("CS_PGR_LOCALITY"),k,h,function(e,t){w(A.locality,e)||P(d({},A,{locality:[].concat(A.locality,[e])}))},"i18nkey",F,"locality")),r.createElement(Z,{complaints:e.complaints,onAssignmentChange:function(e,t){if(e.target.checked)P(d({},A,{applicationStatus:[].concat(A.applicationStatus,[{code:t.code}])}));else{var n=A.applicationStatus.filter(function(e){return e.code!==t.code});P(d({},A,{applicationStatus:n}))}},pgrfilters:A})))),r.createElement(i.ActionBar,null,"mobile"===e.type&&r.createElement(i.ApplyFilterBar,{labelLink:f("ES_COMMON_CLEAR_ALL"),buttonLink:f("ES_COMMON_FILTER"),onClear:H,onSubmit:function(){U(),e.onClose()}})))},ne=function(e){var t,a,l=e.onSearch,c=e.type,u=e.onClose,m=e.searchParams,d=n.useState((null==m||null===(t=m.search)||void 0===t?void 0:t.serviceRequestId)||""),p=d[0],E=d[1],f=n.useState((null==m||null===(a=m.search)||void 0===a?void 0:a.mobileNumber)||""),C=f[0],S=f[1],O=s.useForm(),_=O.register,v=O.errors,T=O.handleSubmit,g=O.reset,N=o.useTranslation().t;return r.createElement("form",{onSubmit:T(function(e){Object.keys(v).filter(function(e){return v[e]}).length||(l(""!==e.serviceRequestId?{serviceRequestId:e.serviceRequestId}:""!==e.mobileNumber?{mobileNumber:e.mobileNumber}:{}),"mobile"===c&&u())}),style:{marginLeft:"24px"}},r.createElement(r.Fragment,null,r.createElement("div",{className:"search-container",style:{width:"auto"}},r.createElement("div",{className:"search-complaint-container"},"mobile"===c&&r.createElement("div",{className:"complaint-header"},r.createElement("h2",null," ",N("CS_COMMON_SEARCH_BY"),":"),r.createElement("span",{onClick:u},r.createElement(i.CloseSvg,null))),r.createElement("div",{className:"complaint-input-container"},r.createElement("span",{className:"complaint-input"},r.createElement(i.Label,null,N("CS_COMMON_COMPLAINT_NO"),"."),r.createElement(i.TextInput,{name:"serviceRequestId",value:p,onChange:function(e){E(e.target.value)},inputRef:_({pattern:/(?!^$)([^\s])/}),style:{marginBottom:"8px"}})),r.createElement("span",{className:"mobile-input"},r.createElement(i.Label,null,N("CS_COMMON_MOBILE_NO"),"."),r.createElement(i.TextInput,{name:"mobileNumber",value:C,onChange:function(e){S(e.target.value)},inputRef:_({pattern:/^[6-9]\d{9}$/})})),"desktop"===c&&r.createElement(i.SubmitBar,{style:{marginTop:32,marginLeft:"16px",width:"calc( 100% - 16px )"},label:N("ES_COMMON_SEARCH"),submit:!0,disabled:Object.keys(v).filter(function(e){return v[e]}).length})),"desktop"===c&&r.createElement("span",{className:"clear-search"},r.createElement(i.LinkLabel,{className:"clear-search-label",onClick:function(){g(),l({}),E(""),S("")}},N("ES_COMMON_CLEAR_SEARCH"))))),"mobile"===c&&r.createElement(i.ActionBar,null,r.createElement(i.SubmitBar,{label:"Search",submit:!0}))))},re=function(e){var t,n,l=e.data,c=e.onFilterChange,u=e.onSearch,s=e.isLoading,m=e.searchParams,d=e.onNextPage,p=e.onPrevPage,E=e.currentPage,f=e.pageSizeLimit,C=e.onPageSizeChange,S=e.totalRecords,O=o.useTranslation().t,_=function(e){return r.createElement("span",{className:"cell-text"},e)},v=r.useMemo(function(){return[{Header:O("CS_COMMON_COMPLAINT_NO"),Cell:function(e){var t=e.row;return r.createElement("div",null,r.createElement("span",{className:"link"},r.createElement(a.Link,{to:"/digit-ui/employee/pgr/complaint/details/"+t.original.serviceRequestId},t.original.serviceRequestId)),r.createElement("br",null),r.createElement("span",{className:"complain-no-cell-text"},O("SERVICEDEFS."+t.original.complaintSubType.toUpperCase())))}},{Header:O("WF_INBOX_HEADER_LOCALITY"),Cell:function(e){var t=e.row;return _(O(Digit.Utils.locale.getLocalityCode(t.original.locality,t.original.tenantId)))}},{Header:O("CS_COMPLAINT_DETAILS_CURRENT_STATUS"),Cell:function(e){return _(O("CS_COMMON_"+e.row.original.status))}},{Header:O("WF_INBOX_HEADER_CURRENT_OWNER"),Cell:function(e){return _(e.row.original.taskOwner)}},{Header:O("WF_INBOX_HEADER_SLA_DAYS_REMAINING"),Cell:function(e){var t;return r.createElement("span",(t=e.row.original.sla)<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},t||"")}}]},[O]);return n=s?r.createElement(i.Loader,null):l&&0===l.length?r.createElement(i.Card,{style:{marginTop:20}},O("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})):l.length>0?r.createElement(J,{t:O,data:l,columns:v,getCellProps:function(e){return{style:{minWidth:e.column.Header===O("CS_COMMON_COMPLAINT_NO")?"240px":"",padding:"20px 18px",fontSize:"16px"}}},onNextPage:d,onPrevPage:p,totalRecords:S,onPageSizeChagne:C,currentPage:E,pageSizeLimit:f}):r.createElement(i.Card,{style:{marginTop:20}},O("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})),r.createElement("div",{className:"inbox-container"},r.createElement("div",{className:"filters-container"},r.createElement(X,null),r.createElement("div",null,r.createElement(te,{complaints:l,onFilterChange:c,type:"desktop",searchParams:m}))),r.createElement("div",{style:{flex:1}},r.createElement(ne,{onSearch:u,type:"desktop"}),r.createElement("div",{style:(t={marginTop:"24px"},t.marginTop="24px",t.marginLeft="24px",t.flex=1,t)},n)))},ae=function(e){var t,a=e.data,l=e.onFilterChange,c=e.onSearch,u=e.serviceRequestIdKey,s=e.searchParams,m=o.useTranslation().t,d=n.useState(!1),p=d[0],E=d[1],f=n.useState(null),C=f[0],S=f[1],O=n.useState(Digit.inboxFilterCount||1)[0],_=function(e){"SEARCH"===e?S(r.createElement(ne,{type:"mobile",onClose:v,onSearch:c,searchParams:s})):"FILTER"===e&&S(r.createElement(te,{complaints:a,onFilterChange:l,onClose:v,type:"mobile",searchParams:s})),E(!0)},v=function(){E(!1),S(null)};return t=a&&0===(null==a?void 0:a.length)?r.createElement(i.Card,{style:{marginTop:20}},m("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})):a&&(null==a?void 0:a.length)>0?r.createElement(i.DetailsCard,{data:a,serviceRequestIdKey:u,linkPrefix:"/digit-ui/employee/pgr/complaint/details/"}):r.createElement(i.Card,{style:{marginTop:20}},m("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})),r.createElement(r.Fragment,null,r.createElement("div",{className:"searchBox"},r.createElement(i.SearchAction,{text:"SEARCH",handleActionClick:function(){return _("SEARCH")}}),r.createElement(i.FilterAction,{filterCount:O,text:"FILTER",handleActionClick:function(){return _("FILTER")}})),t,p&&r.createElement(i.PopUp,null,r.createElement("div",{className:"popup-module"},C)))};function oe(e,t){return e(t={exports:{}},t.exports),t.exports}var ie="function"==typeof Symbol&&Symbol.for,le=ie?Symbol.for("react.element"):60103,ce=ie?Symbol.for("react.portal"):60106,ue=ie?Symbol.for("react.fragment"):60107,se=ie?Symbol.for("react.strict_mode"):60108,me=ie?Symbol.for("react.profiler"):60114,de=ie?Symbol.for("react.provider"):60109,pe=ie?Symbol.for("react.context"):60110,Ee=ie?Symbol.for("react.async_mode"):60111,fe=ie?Symbol.for("react.concurrent_mode"):60111,Ce=ie?Symbol.for("react.forward_ref"):60112,Se=ie?Symbol.for("react.suspense"):60113,Oe=ie?Symbol.for("react.suspense_list"):60120,_e=ie?Symbol.for("react.memo"):60115,ve=ie?Symbol.for("react.lazy"):60116,Te=ie?Symbol.for("react.block"):60121,ge=ie?Symbol.for("react.fundamental"):60117,Ne=ie?Symbol.for("react.responder"):60118,ye=ie?Symbol.for("react.scope"):60119;function he(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case le:switch(e=e.type){case Ee:case fe:case ue:case me:case se:case Se:return e;default:switch(e=e&&e.$$typeof){case pe:case Ce:case ve:case _e:case de:return e;default:return t}}case ce:return t}}}function Me(e){return he(e)===fe}var Ie={AsyncMode:Ee,ConcurrentMode:fe,ContextConsumer:pe,ContextProvider:de,Element:le,ForwardRef:Ce,Fragment:ue,Lazy:ve,Memo:_e,Portal:ce,Profiler:me,StrictMode:se,Suspense:Se,isAsyncMode:function(e){return Me(e)||he(e)===Ee},isConcurrentMode:Me,isContextConsumer:function(e){return he(e)===pe},isContextProvider:function(e){return he(e)===de},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===le},isForwardRef:function(e){return he(e)===Ce},isFragment:function(e){return he(e)===ue},isLazy:function(e){return he(e)===ve},isMemo:function(e){return he(e)===_e},isPortal:function(e){return he(e)===ce},isProfiler:function(e){return he(e)===me},isStrictMode:function(e){return he(e)===se},isSuspense:function(e){return he(e)===Se},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===ue||e===fe||e===me||e===se||e===Se||e===Oe||"object"==typeof e&&null!==e&&(e.$$typeof===ve||e.$$typeof===_e||e.$$typeof===de||e.$$typeof===pe||e.$$typeof===Ce||e.$$typeof===ge||e.$$typeof===Ne||e.$$typeof===ye||e.$$typeof===Te)},typeOf:he},Ae=oe(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,i=e?Symbol.for("react.profiler"):60114,l=e?Symbol.for("react.provider"):60109,c=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,s=e?Symbol.for("react.concurrent_mode"):60111,m=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,E=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,C=e?Symbol.for("react.block"):60121,S=e?Symbol.for("react.fundamental"):60117,O=e?Symbol.for("react.responder"):60118,_=e?Symbol.for("react.scope"):60119;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:var p=e.type;switch(p){case u:case s:case a:case i:case o:case d:return p;default:var C=p&&p.$$typeof;switch(C){case c:case m:case f:case E:case l:return C;default:return t}}case r:return t}}}var T=s,g=c,N=l,y=n,h=m,M=a,I=f,A=E,P=r,D=i,L=o,b=d,R=!1;function k(e){return v(e)===s}t.AsyncMode=u,t.ConcurrentMode=T,t.ContextConsumer=g,t.ContextProvider=N,t.Element=y,t.ForwardRef=h,t.Fragment=M,t.Lazy=I,t.Memo=A,t.Portal=P,t.Profiler=D,t.StrictMode=L,t.Suspense=b,t.isAsyncMode=function(e){return R||(R=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),k(e)||v(e)===u},t.isConcurrentMode=k,t.isContextConsumer=function(e){return v(e)===c},t.isContextProvider=function(e){return v(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return v(e)===m},t.isFragment=function(e){return v(e)===a},t.isLazy=function(e){return v(e)===f},t.isMemo=function(e){return v(e)===E},t.isPortal=function(e){return v(e)===r},t.isProfiler=function(e){return v(e)===i},t.isStrictMode=function(e){return v(e)===o},t.isSuspense=function(e){return v(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===s||e===i||e===o||e===d||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===E||e.$$typeof===l||e.$$typeof===c||e.$$typeof===m||e.$$typeof===S||e.$$typeof===O||e.$$typeof===_||e.$$typeof===C)},t.typeOf=v}()}),Pe=oe(function(e){e.exports="production"===process.env.NODE_ENV?Ie:Ae}),De=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;function Re(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var ke=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,a=Re(e),o=1;o<arguments.length;o++){for(var i in n=Object(arguments[o]))Le.call(n,i)&&(a[i]=n[i]);if(De){r=De(n);for(var l=0;l<r.length;l++)be.call(n,r[l])&&(a[r[l]]=n[r[l]])}}return a},xe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",we=Function.call.bind(Object.prototype.hasOwnProperty),Fe=function(){};if("production"!==process.env.NODE_ENV){var He=xe,Ue={},Be=we;Fe=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function Ge(e,t,n,r,a){if("production"!==process.env.NODE_ENV)for(var o in e)if(Be(e,o)){var i;try{if("function"!=typeof e[o]){var l=Error((r||"React class")+": "+n+" type `"+o+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[o]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw l.name="Invariant Violation",l}i=e[o](t,o,r,n,null,He)}catch(e){i=e}if(!i||i instanceof Error||Fe((r||"React class")+": type specification of "+n+" `"+o+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof i+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),i instanceof Error&&!(i.message in Ue)){Ue[i.message]=!0;var c=a?a():"";Fe("Failed "+n+" type: "+i.message+(null!=c?c:""))}}}Ge.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(Ue={})};var je=Ge,Ve=function(){};function $e(){return null}function ze(){}function Ye(){}"production"!==process.env.NODE_ENV&&(Ve=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),Ye.resetWarningCache=ze;var We=oe(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var n="function"==typeof Symbol&&Symbol.iterator,r={array:l("array"),bigint:l("bigint"),bool:l("boolean"),func:l("function"),number:l("number"),object:l("object"),string:l("string"),symbol:l("symbol"),any:i($e),arrayOf:function(e){return i(function(t,n,r,a,i){if("function"!=typeof e)return new o("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var l=t[n];if(!Array.isArray(l))return new o("Invalid "+a+" `"+i+"` of type `"+s(l)+"` supplied to `"+r+"`, expected an array.");for(var c=0;c<l.length;c++){var u=e(l,c,r,a,i+"["+c+"]",xe);if(u instanceof Error)return u}return null})},element:i(function(t,n,r,a,i){var l=t[n];return e(l)?null:new o("Invalid "+a+" `"+i+"` of type `"+s(l)+"` supplied to `"+r+"`, expected a single ReactElement.")}),elementType:i(function(e,t,n,r,a){var i=e[t];return Pe.isValidElementType(i)?null:new o("Invalid "+r+" `"+a+"` of type `"+s(i)+"` supplied to `"+n+"`, expected a single ReactElement type.")}),instanceOf:function(e){return i(function(t,n,r,a,i){var l;return t[n]instanceof e?null:new o("Invalid "+a+" `"+i+"` of type `"+((l=t[n]).constructor&&l.constructor.name?l.constructor.name:"<<anonymous>>")+"` supplied to `"+r+"`, expected instance of `"+(e.name||"<<anonymous>>")+"`.")})},node:i(function(e,t,n,r,a){return u(e[t])?null:new o("Invalid "+r+" `"+a+"` supplied to `"+n+"`, expected a ReactNode.")}),objectOf:function(e){return i(function(t,n,r,a,i){if("function"!=typeof e)return new o("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var l=t[n],c=s(l);if("object"!==c)return new o("Invalid "+a+" `"+i+"` of type `"+c+"` supplied to `"+r+"`, expected an object.");for(var u in l)if(we(l,u)){var m=e(l,u,r,a,i+"."+u,xe);if(m instanceof Error)return m}return null})},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Ve(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),$e;function t(t,n,r,i,l){for(var c=t[n],u=0;u<e.length;u++)if(a(c,e[u]))return null;var s=JSON.stringify(e,function(e,t){return"symbol"===m(t)?String(t):t});return new o("Invalid "+i+" `"+l+"` of value `"+String(c)+"` supplied to `"+r+"`, expected one of "+s+".")}return i(t)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Ve("Invalid argument supplied to oneOfType, expected an instance of array."),$e;for(var t=0;t<e.length;t++){var n=e[t];if("function"!=typeof n)return Ve("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+d(n)+" at index "+t+"."),$e}return i(function(t,n,r,a,i){for(var l=[],c=0;c<e.length;c++){var u=(0,e[c])(t,n,r,a,i,xe);if(null==u)return null;u.data&&we(u.data,"expectedType")&&l.push(u.data.expectedType)}return new o("Invalid "+a+" `"+i+"` supplied to `"+r+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")})},shape:function(e){return i(function(t,n,r,a,i){var l=t[n],u=s(l);if("object"!==u)return new o("Invalid "+a+" `"+i+"` of type `"+u+"` supplied to `"+r+"`, expected `object`.");for(var d in e){var p=e[d];if("function"!=typeof p)return c(r,a,i,d,m(p));var E=p(l,d,r,a,i+"."+d,xe);if(E)return E}return null})},exact:function(e){return i(function(t,n,r,a,i){var l=t[n],u=s(l);if("object"!==u)return new o("Invalid "+a+" `"+i+"` of type `"+u+"` supplied to `"+r+"`, expected `object`.");var d=ke({},t[n],e);for(var p in d){var E=e[p];if(we(e,p)&&"function"!=typeof E)return c(r,a,i,p,m(E));if(!E)return new o("Invalid "+a+" `"+i+"` key `"+p+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var f=E(l,p,r,a,i+"."+p,xe);if(f)return f}return null})}};function a(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function o(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function i(e){function t(t,n,r,a,i,l,c){if(a=a||"<<anonymous>>",l=l||r,c!==xe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}return null==n[r]?t?new o(null===n[r]?"The "+i+" `"+l+"` is marked as required in `"+a+"`, but its value is `null`.":"The "+i+" `"+l+"` is marked as required in `"+a+"`, but its value is `undefined`."):null:e(n,r,a,i,l)}process;var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function l(e){return i(function(t,n,r,a,i,l){var c=t[n];return s(c)!==e?new o("Invalid "+a+" `"+i+"` of type `"+m(c)+"` supplied to `"+r+"`, expected `"+e+"`.",{expectedType:e}):null})}function c(e,t,n,r,a){return new o((e||"React class")+": "+t+" type `"+n+"."+r+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+a+"`.")}function u(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(u);if(null===t||e(t))return!0;var r=function(e){var t=e&&(n&&e[n]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!r)return!1;var a,o=r.call(t);if(r!==t.entries){for(;!(a=o.next()).done;)if(!u(a.value))return!1}else for(;!(a=o.next()).done;){var i=a.value;if(i&&!u(i[1]))return!1}return!0;default:return!1}}function s(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function m(e){if(null==e)return""+e;var t=s(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function d(e){var t=m(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return o.prototype=Error.prototype,r.checkPropTypes=je,r.resetWarningCache=je.resetWarningCache,r.PropTypes=r,r}(Pe.isElement):function(){function e(e,t,n,r,a,o){if(o!==xe){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Ye,resetWarningCache:ze};return n.PropTypes=n,n}()}),Ke=function(e){var t,n=e.data,a=e.onFilterChange,l=e.onSearch,c=e.isLoading,u=e.searchParams,s=o.useTranslation().t,m=null==n?void 0:n.map(function(e){var t,n,a=e.locality,o=e.tenantId,i=e.serviceRequestId,l=e.complaintSubType,c=e.sla,u=e.status,m=e.taskOwner;return(t={})[s("CS_COMMON_COMPLAINT_NO")]=i,t[s("CS_ADDCOMPLAINT_COMPLAINT_SUB_TYPE")]=s("SERVICEDEFS."+l.toUpperCase()),t[s("WF_INBOX_HEADER_LOCALITY")]=s(Digit.Utils.locale.getLocalityCode(a,o)),t[s("CS_COMPLAINT_DETAILS_CURRENT_STATUS")]=s("CS_COMMON_"+u),t[s("WF_INBOX_HEADER_CURRENT_OWNER")]=m,t[s("WF_INBOX_HEADER_SLA_DAYS_REMAINING")]=r.createElement("span",(n=c)<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},n),t});return t=c?r.createElement(i.Loader,null):r.createElement(ae,{data:m,onFilterChange:a,serviceRequestIdKey:s("CS_COMMON_COMPLAINT_NO"),onSearch:l,searchParams:u}),r.createElement("div",{style:{padding:0}},r.createElement("div",{className:"inbox-container"},r.createElement("div",{className:"filters-container"},r.createElement(X,{isMobile:!0}),t)))};Ke.propTypes={data:We.any,onFilterChange:We.func,onSearch:We.func,isLoading:We.bool,searchParams:We.any},Ke.defaultProps={onFilterChange:function(){},searchParams:{}};var qe=function(e){var n,a,l=e.response.complaints;return r.createElement(i.Banner,l&&l.response&&l.response.responseInfo?{message:(n=l.response.ServiceWrappers[0].workflow,a=n.action,(0,o.useTranslation().t)("REOPEN"===a?"CS_COMMON_COMPLAINT_REOPENED":"CS_COMMON_COMPLAINT_SUBMITTED")),complaintNumber:l.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},Xe={PGRModule:function(e){var t=e.stateCode,n=e.userType,a=e.tenants,o=Digit.StoreData.getCurrentLanguage();return Digit.Services.useStore({stateCode:t,moduleCode:"PGR",language:o}).isLoading?r.createElement(i.Loader,null):(Digit.SessionStorage.set("PGR_TENANTS",a),r.createElement("citizen"===n?G:V,null))},PGRLinks:function(e){var t=e.matchPath,a=o.useTranslation().t,l=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{})[2];n.useEffect(function(){l()},[]);var c=[{link:t+"/create-complaint/complaint-type",i18nKey:a("CS_COMMON_FILE_A_COMPLAINT")},{link:t+"/complaints",i18nKey:a("CS_HOME_MY_COMPLAINTS")}];return r.createElement(i.CitizenHomeCard,{header:a("CS_COMMON_HOME_COMPLAINTS"),links:c,Icon:i.ComplaintIcon})},PGRCard:function(){var e=o.useTranslation().t;if(e("ES_PGR_INBOX"),e("ES_PGR_NEW_COMPLAINT"),!Digit.Utils.pgrAccess())return null;var t=function(){return r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},r.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"}))},n=[{label:e("ES_PGR_NEW_COMPLAINT"),link:"/digit-ui/employee/pgr/complaint/create",role:"CSR"}];n=n.filter(function(e){return e.role&&Digit.Utils.didEmployeeHasRole(e.role)});var a={Icon:r.createElement(t,null),moduleName:e("ES_PGR_HEADER_COMPLAINT"),kpis:[{label:e("TOTAL_PGR"),link:"/digit-ui/employee/pgr/inbox"},{label:e("TOTAL_NEARING_SLA"),link:"/digit-ui/employee/pgr/inbox"}],links:[{label:e("ES_PGR_INBOX"),link:"/digit-ui/employee/pgr/inbox"}].concat(n)};return r.createElement(i.EmployeeModuleCard,a)},PGRComplaintDetails:function(e){var t,l,c,u,s,p,E,f,C,S,O,_,v,T=a.useParams().id,g=o.useTranslation().t,N=n.useState(!1),y=N[0],h=N[1],M=n.useState(null),I=M[0],A=M[1],P=n.useState(!1),D=P[0],L=P[1],b=Digit.ULBService.getCurrentTenantId(),R=Digit.Hooks.pgr.useComplaintDetails({tenantId:b,id:T}),x=R.isLoading,w=R.complaintDetails,F=R.revalidate,H=Digit.Hooks.useWorkflowDetails({tenantId:b,id:T,moduleCode:"PGR",role:"EMPLOYEE"}),U=n.useState([]),B=U[0],G=U[1];H&&null!=H&&H.data&&(H.data.initialActionState=(null==H||null===(_=H.data)||void 0===_?void 0:_.initialActionState)||d({},null==H||null===(v=H.data)||void 0===v?void 0:v.actionState)||{},H.data.actionState=d({},H.data)),n.useEffect(function(){if(H){var e=H.data,t=(void 0===e?{}:e).timeline;if(t){var n=(null==t?void 0:t.find(function(e){return"APPLY"===(null==e?void 0:e.performedAction)})).thumbnailsToShow;n&&G(n)}}},[H]);var j=n.useState(!1),V=j[0],$=j[1],q=n.useState(!1),X=q[0],J=q[1],Z=n.useState(null),Q=Z[0],ee=Z[1],te=n.useState(null),ne=te[0],re=te[1],ae=n.useState(!1),oe=ae[0],ie=ae[1],le=n.useState(1),ce=le[0],ue=le[1],se=m.useQueryClient();n.useEffect(function(){try{var e,t;return Promise.resolve(null===(e=Digit)||void 0===e||null===(t=e.WorkflowService)||void 0===t?void 0:t.getByBusinessId(b,T)).then(function(){})}catch(e){Promise.reject(e)}},[w]);var me=function(){try{return Promise.resolve(se.refetchQueries(["fetchInboxData"])).then(function(){return Promise.resolve(H.revalidate()).then(function(){return Promise.resolve(F()).then(function(){})})})}catch(e){return Promise.reject(e)}};function de(e){switch(e){case y:h(!y);break;case X:J(!X)}}function pe(e,t){A(e)}if(n.useEffect(function(){!function(){try{var e=function(){if(w)return ie(!0),Promise.resolve(me()).then(function(){ie(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),x||H.isLoading||oe)return r.createElement(i.Loader,null);if(H.isError)return r.createElement(r.Fragment,null,H.error);var Ee=function(e,t,a){var o,l,c,u,s=e.wfComment,m=e.thumbnailsToShow;function p(e,t,n){var r,a,o=null===(r=n.thumbs)||void 0===r?void 0:r.findIndex(function(t){return t===e});pe(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}var E=d({date:null==e||null===(o=e.auditDetails)||void 0===o?void 0:o.lastModified,name:null==e||null===(l=e.assigner)||void 0===l?void 0:l.name,mobileNumber:null==e||null===(c=e.assigner)||void 0===c?void 0:c.mobileNumber},"COMPLAINT_FILED"===e.status&&null!=w&&w.audit?{source:w.audit.source}:{});if("PENDINGFORASSIGNMENT"===e.status&&null!=w&&w.audit){if(a.length-(t+1)==1){var f={date:Digit.DateUtils.ConvertTimestampToDate(w.audit.details.createdTime)};return r.createElement(W,{data:f,comments:null==e?void 0:e.wfComment})}var C,S,O={date:Digit.DateUtils.ConvertTimestampToDate(w.audit.details.createdTime)};return r.createElement(n.Fragment,null,null!=e&&e.wfComment?r.createElement("div",null,null==e||null===(C=e.wfComment)||void 0===C?void 0:C.map(function(e){return r.createElement("div",{className:"TLComments"},r.createElement("h3",null,g("WF_COMMON_COMMENTS")),r.createElement("p",null,e))})):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(S=m.thumbs)||void 0===S?void 0:S.length)>0?r.createElement("div",{className:"TLComments"},r.createElement("h3",null,g("CS_COMMON_ATTACHMENTS")),r.createElement(i.DisplayPhotos,{srcs:m.thumbs,onClick:function(e,t){return p(e,0,m)}})):null,null!=O&&O.date?r.createElement(W,{data:O}):null)}return r.createElement(n.Fragment,null,s?r.createElement("div",null,null==s?void 0:s.map(function(e){return r.createElement("div",{className:"TLComments"},r.createElement("h3",null,g("WF_COMMON_COMMENTS")),r.createElement("p",null,e))})):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(u=m.thumbs)||void 0===u?void 0:u.length)>0?r.createElement("div",{className:"TLComments"},r.createElement("h3",null,g("CS_COMMON_ATTACHMENTS")),r.createElement(i.DisplayPhotos,{srcs:m.thumbs,onClick:function(e,t){return p(e,0,m)}})):null,null!=E&&E.date?r.createElement(W,{data:E}):null,"CLOSEDAFTERRESOLUTION"==e.status&&"RATE"==w.workflow.action&&t<=1&&w.audit.rating?r.createElement(k,{text:g("CS_ADDCOMPLAINT_YOU_RATED"),rating:w.audit.rating}):null)};return r.createElement(r.Fragment,null,r.createElement(i.Card,null,r.createElement(i.CardSubHeader,null,g("CS_HEADER_COMPLAINT_SUMMARY")),r.createElement(i.CardLabel,{style:{fontWeight:"700"}},g("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS")),x?r.createElement(i.Loader,null):r.createElement(i.StatusTable,null,w&&Object.keys(null==w?void 0:w.details).map(function(e,t,n){return r.createElement(i.Row,{key:e,label:g(e),text:Array.isArray(null==w?void 0:w.details[e])?null==w?void 0:w.details[e].map(function(e){return g("object"==typeof e?null==e?void 0:e.code:e)}):g(null==w?void 0:w.details[e])||"N/A",last:n.length-1===t})}),null),null!=B&&B.thumbs?r.createElement(i.DisplayPhotos,{srcs:null==B?void 0:B.thumbs,onClick:function(e,t){return function(e,t){pe(null==B?void 0:B.fullImage[t])}(0,t)}}):null,r.createElement(i.BreakLine,null),(null==H?void 0:H.isLoading)&&r.createElement(i.Loader,null),!(null!=H&&H.isLoading)&&r.createElement(r.Fragment,null,r.createElement(i.CardSubHeader,null,g("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),null!=H&&null!==(t=H.data)&&void 0!==t&&t.timeline&&1===(null==H||null===(l=H.data)||void 0===l||null===(c=l.timeline)||void 0===c?void 0:c.length)?r.createElement(i.CheckPoint,{isCompleted:!0,label:g("CS_COMMON_"+(null==H||null===(u=H.data)||void 0===u||null===(s=u.timeline[0])||void 0===s?void 0:s.status))}):r.createElement(i.ConnectingCheckPoints,null,(null==H||null===(p=H.data)||void 0===p?void 0:p.timeline)&&(null==H||null===(E=H.data)||void 0===E?void 0:E.timeline.map(function(e,t,n){return r.createElement(r.Fragment,{key:t},r.createElement(i.CheckPoint,{keyValue:t,isCompleted:0===t,label:g("CS_COMMON_"+e.status),customChild:Ee(e,t,n)}))}))))),y?r.createElement(i.PopUp,null,r.createElement("div",{className:"popup-module"},r.createElement(i.HeaderBar,{main:r.createElement(z,{label:"Complaint Geolocation"}),end:r.createElement(Y,{onClick:function(){return de(y)}})}),r.createElement("div",{className:"popup-module-main"},r.createElement("img",{src:"https://via.placeholder.com/912x568"})))):null,I?r.createElement(i.ImageViewer,{imageSrc:I,onClose:function(){A(null)}}):null,X?r.createElement(K,{workflowDetails:H,complaintDetails:w,close:de,popup:X,selectedAction:Q,onAssign:function(e,t,n){try{return J(!1),Promise.resolve(Digit.Complaint.assign(w,Q,e,t,n,b)).then(function(e){return re(e),L(!0),ie(!0),Promise.resolve(me()).then(function(){ie(!1),ue(ce+1),setTimeout(function(){return L(!1)},1e4)})})}catch(e){return Promise.reject(e)}},tenantId:b,t:g}):null,D&&r.createElement(i.Toast,{label:g(ne?"CS_ACTION_"+Q+"_TEXT":"CS_ACTION_ASSIGN_FAILED"),onClose:function(){L(!1)}}),!(null!=H&&H.isLoading)&&(null==H||null===(f=H.data)||void 0===f||null===(C=f.nextActions)||void 0===C?void 0:C.length)>0&&r.createElement(i.ActionBar,null,V&&null!=H&&null!==(S=H.data)&&void 0!==S&&S.nextActions?r.createElement(i.Menu,{options:null==H||null===(O=H.data)||void 0===O?void 0:O.nextActions.map(function(e){return e.action}),t:g,onSelect:function(e){switch(ee(e),e){case"ASSIGN":case"REASSIGN":case"RESOLVE":case"REJECT":case"REOPEN":J(!0),$(!1);break;default:$(!1)}}}):null,r.createElement(i.SubmitBar,{label:g("WF_TAKE_ACTION"),onSubmit:function(){return $(!V)}})))},PGRCreateComplaintEmp:function(e){var t,l=e.parentUrl,u=Digit.Hooks.pgr.useTenants(),s=o.useTranslation().t,p=function(){return(null==u?void 0:u.filter(function(e){return e.code===Digit.ULBService.getCurrentTenantId()}))||[]},E=n.useState({}),f=E[0],C=E[1],S=n.useState([]),_=S[0],v=S[1],T=n.useState({}),g=T[0],N=T[1],y=n.useState(""),h=y[0],M=y[1],I=n.useState(p()[0]?p()[0]:null),A=I[0],P=I[1],D=Digit.Hooks.useBoundaryLocalities(null===(t=p()[0])||void 0===t?void 0:t.code,"admin",{enabled:!!p()[0]},s).data,L=n.useState(D),b=L[0],R=L[1],k=n.useState(null),x=k[0],w=k[1],F=n.useState(!1),H=F[0],U=F[1],B=n.useState(!1),G=B[0],j=B[1],V=n.useState(!1),$=V[0],z=V[1],Y=(n.useState({}),window.Digit.SessionStorage.get("Employee.tenantId")),W=Digit.Hooks.pgr.useComplaintTypes({stateCode:Y}),K=c.useDispatch(),X=(a.useRouteMatch(),a.useHistory()),J=Digit.GetServiceDefinitions,Z=m.useQueryClient();n.useEffect(function(){U(!!(null!=f&&f.key&&null!=g&&g.key&&null!=A&&A.code&&null!=x&&x.code))},[f,g,A,x]),n.useEffect(function(){R(D)},[D]),n.useEffect(function(){var e,t=u.find(function(e){var t;return null===(t=e.pincode)||void 0===t?void 0:t.find(function(e){return e==h})});if((null==t?void 0:t.code)===(null===(e=p()[0])||void 0===e?void 0:e.code)){z(!1),P(t),w(null);var n=D.filter(function(e){return e.pincode==h});R(n)}else""===h||null===h?(z(!1),R(D)):z(!0)},[h]);var Q=[{head:s("ES_CREATECOMPLAINT_PROVIDE_COMPLAINANT_DETAILS"),body:[{label:s("ES_CREATECOMPLAINT_MOBILE_NUMBER"),isMandatory:!0,type:"text",populators:{name:"mobileNumber",validation:{required:!0,pattern:/^[6-9]\d{9}$/},componentInFront:r.createElement("div",{className:"employee-card-input employee-card-input--front"},"+91"),error:s("CORE_COMMON_MOBILE_ERROR")}},{label:s("ES_CREATECOMPLAINT_COMPLAINT_NAME"),isMandatory:!0,type:"text",populators:{name:"name",validation:{required:!0,pattern:/^[A-Za-z]/},error:s("CS_ADDCOMPLAINT_NAME_ERROR")}}]},{head:s("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS"),body:[{label:s("CS_COMPLAINT_DETAILS_COMPLAINT_TYPE"),isMandatory:!0,type:"dropdown",populators:r.createElement(i.Dropdown,{option:W,optionKey:"name",id:"complaintType",selected:f,select:function(e){try{var t=function(){if(e.key!==f.key){var t=function(){if("Others"!==e.key)return N({name:""}),C(e),Promise.resolve(J.getSubMenu(Y,e,s)).then(function(e){v(e)});N({name:""}),C(e),v([{key:"Others",name:s("SERVICEDEFS.OTHERS")}])}();if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}})},{label:s("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),isMandatory:!0,type:"dropdown",menu:d({},_),populators:r.createElement(i.Dropdown,{option:_,optionKey:"name",id:"complaintSubType",selected:g,select:function(e){N(e)}})}]},{head:s("CS_ADDCOMPLAINT_LOCATION"),body:[{label:s("CORE_COMMON_PINCODE"),type:"text",populators:{name:"pincode",validation:{pattern:/^[1-9][0-9]{5}$/,validate:function(){return!$}},error:s("CORE_COMMON_PINCODE_INVALID"),onChange:function(e){var t=e.target.value;M(t),t||z(!1)}}},{label:s("CS_COMPLAINT_DETAILS_CITY"),isMandatory:!0,type:"dropdown",populators:r.createElement(i.Dropdown,{isMandatory:!0,selected:A,freeze:!0,option:p(),id:"city",select:function(e){return Promise.resolve()},optionKey:"i18nKey",t:s})},{label:s("CS_CREATECOMPLAINT_MOHALLA"),type:"dropdown",isMandatory:!0,dependency:!(!A||!b),populators:r.createElement(i.Dropdown,{isMandatory:!0,selected:x,optionKey:"i18nkey",id:"locality",option:b,select:function(e){w(e)},t:s})},{label:s("CS_COMPLAINT_DETAILS_LANDMARK"),type:"textarea",populators:{name:"landmark"}}]},{head:s("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),body:[{label:s("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),type:"textarea",populators:{name:"description"}}]}];return r.createElement(q,{heading:s("ES_CREATECOMPLAINT_NEW_COMPLAINT"),config:Q,onSubmit:function(e){H&&(j(!0),!G&&function(e){try{if(!H)return Promise.resolve();var t=d({},e,{cityCode:A.code,city:A.city.name,district:A.city.name,region:A.city.name,localityCode:x.code,localityName:x.name,landmark:e.landmark,complaintType:g.key,mobileNumber:e.mobileNumber,name:e.name});Promise.resolve(K(O(t))).then(function(){return Promise.resolve(Z.refetchQueries(["fetchInboxData"])).then(function(){X.push(l+"/response")})})}catch(e){return Promise.reject(e)}}(e))},isDisabled:!H&&!G,label:s("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_SUBMIT_COMPLAINT")})},PGRInbox:function(){var e=o.useTranslation().t,t=Digit.ULBService.getCurrentTenantId(),a=Digit.UserService.getUser().info.uuid,l=n.useState(0),c=l[0],u=l[1],s=n.useState(10),m=s[0],p=s[1],E=n.useState(0),f=E[0],C=E[1],S=n.useState({filters:{wfFilters:{assignee:[{code:a}]}},search:"",sort:{}}),O=S[0],_=S[1];n.useEffect(function(){try{var e,n,r,a=null==O||null===(e=O.filters)||void 0===e||null===(n=e.pgrfilters)||void 0===n||null===(r=n.applicationStatus)||void 0===r?void 0:r.map(function(e){return e.code}).join(",");return Promise.resolve(Digit.PGRService.count(t,(null==a?void 0:a.length)>0?{applicationStatus:a}:{})).then(function(e){null!=e&&e.count&&C(e.count)})}catch(e){Promise.reject(e)}},[O]);var v=function(e){_(d({},O,{filters:e}))},T=function(e){void 0===e&&(e=""),_(d({},O,{search:e}))},g=Digit.Hooks.pgr.useInboxData(d({},O,{offset:c,limit:m})),N=g.data,y=g.isLoading,h=Digit.Utils.browser.isMobile();return null!==(null==N?void 0:N.length)?h?r.createElement(Ke,{data:N,isLoading:y,onFilterChange:v,onSearch:T,searchParams:O}):r.createElement("div",null,r.createElement(i.Header,null,e("ES_COMMON_INBOX")),r.createElement(re,{data:N,isLoading:y,onFilterChange:v,onSearch:T,searchParams:O,onNextPage:function(){u(function(e){return e+10})},onPrevPage:function(){u(function(e){return e-10})},onPageSizeChange:function(e){p(Number(e.target.value))},currentPage:Math.floor(c/m),totalRecords:f,pageSizeLimit:m})):r.createElement(i.Loader,null)},PGRResponseEmp:function(e){var t=o.useTranslation().t,n=(a.useRouteMatch(),c.useSelector(function(e){return e}).pgr);return r.createElement(i.Card,null,n.complaints.response&&r.createElement(qe,{response:n}),r.createElement(i.CardText,null,t("ES_COMMON_TRACK_COMPLAINT_TEXT")),r.createElement(a.Link,{to:"/digit-ui/employee"},r.createElement(i.SubmitBar,{label:t("CORE_COMMON_GO_TO_HOME")})))},PGRCreateComplaintCitizen:function(){var e=Digit.Contexts.ComponentProvider,t=o.useTranslation().t,i=a.useLocation().pathname,l=a.useRouteMatch(),s=a.useHistory(),E=(n.useContext(e),c.useDispatch()),f=Digit.Hooks.useStore.getInitData(),C=f.isLoading,S=(f.data||{}).stateInfo,_=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{}),v=_[0],T=_[1],g=n.useMemo(function(){return u(P,Digit.Customizations.PGR.complaintConfig)},[Digit.Customizations.PGR.complaintConfig]),N=n.useState(v),y=N[0],h=N[1],M=n.useState(""),I=M[0],L=M[1],b=n.useState(!1),R=b[0],k=b[1],x=(n.useState(0),m.useQueryClient());n.useEffect(function(){k(!1)},[]),n.useEffect(function(){h(v),null===I?F():s.push(l.path+"/"+I)},[v,I]);var w=function(){var e=i.split("/").pop(),n=g.routes[e].nextStep,r=Digit.SessionStorage.get("PGR_CITIZEN_CREATE_COMPLAINT");"sub-type"===n&&"Others"===r.complaintType.key&&(T(d({},v,{complaintType:{key:"Others",name:t("SERVICEDEFS.OTHERS")},subType:{key:"Others",name:t("SERVICEDEFS.OTHERS")}})),n=g.routes[n].nextStep),L(n)},F=function(){R||(k(!0),H())},H=function(){try{var e=function(){if(null!=y&&y.complaintType){var e=y.city_complaint,t=y.locality_complaint,n=y.uploadedImages,r=y.subType,a=y.details,o=p(y,D),i=e.code,c=e.name,u=t.code,m=t.name,f=null==n?void 0:n.map(function(e){return{documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}}}),C=d({},o,{complaintType:r.key,cityCode:i,city:c,description:a,district:c,region:c,localityCode:u,localityName:m,state:S.name,uploadedImages:f});return Promise.resolve(E(O(C))).then(function(){return Promise.resolve(x.refetchQueries(["complaintsList"])).then(function(){s.push(l.path+"/response")})})}}();return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},U=function(e){T(d({},v,e)),w()},B=function(){w()};return C?null:r.createElement(a.Switch,null,Object.keys(g.routes).map(function(e,n){var o=g.routes[e],i=o.component,c=o.texts,u=o.inputs,s="string"==typeof i?Digit.ComponentRegistryService.getComponent(i):i;return r.createElement(a.Route,{path:l.path+"/"+e,key:n},r.createElement(s,{config:{texts:c,inputs:u},onSelect:U,onSkip:B,value:v,t:t}))}),r.createElement(a.Route,{path:l.path+"/response"},r.createElement(A,{match:l})),r.createElement(a.Route,null,r.createElement(a.Redirect,{to:l.path+"/"+g.indexRoute})))},PGRComplaintsList:function(e){var t,l,c,u,s=Digit.UserService.getUser(),m=s.mobileNumber||(null==s||null===(t=s.info)||void 0===t?void 0:t.mobileNumber)||(null==s||null===(l=s.info)||void 0===l||null===(c=l.userInfo)||void 0===c?void 0:c.mobileNumber),d=(null===(u=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===u?void 0:u.code)||Digit.ULBService.getCurrentTenantId(),p=o.useTranslation().t,E=a.useRouteMatch().path,f=Digit.Hooks.pgr.useComplaintsListByMobile(d,m),C=f.isLoading,S=f.error,O=f.data,_=f.revalidate;if(n.useEffect(function(){_()},[]),C)return r.createElement(r.Fragment,null,r.createElement(i.Header,null,p("CS_HOME_MY_COMPLAINTS")),r.createElement(i.Loader,null));var v,T=null==O?void 0:O.ServiceWrappers;return v=S?r.createElement(i.Card,null,p("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})):0===T.length?r.createElement(i.Card,null,p("CS_MYCOMPLAINTS_NO_COMPLAINTS").split("\\n").map(function(e,t){return r.createElement("p",{key:t,style:{textAlign:"center"}},e)})):T.map(function(e,t){return r.createElement(L,{key:t,data:e.service,path:E})}),r.createElement(r.Fragment,null,r.createElement("div",{className:"applications-list-container"},r.createElement(i.Header,null,p("CS_HOME_MY_COMPLAINTS")),v))},PGRComplaintDetailsPage:function(e){var t,l=o.useTranslation().t,c=a.useParams().id,u=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId(),s=Digit.Hooks.pgr.useComplaintDetails({tenantId:u,id:c}),m=s.isLoading,d=s.isError,p=s.complaintDetails,E=s.revalidate,f=n.useState({}),C=f[0],S=f[1],O=n.useState(null),_=O[0],v=O[1],T=(n.useState(""),n.useState(!1)),g=T[0],N=T[1],y=n.useState(null)[0],h=n.useState(!0)[1],M=n.useState(!1),I=M[0],A=M[1];function P(e,t){v(e)}return n.useEffect(function(){!function(){try{var e=function(){if(p)return A(!0),Promise.resolve(E()).then(function(){A(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),m||I?r.createElement(i.Loader,null):d?r.createElement("h2",null,"Error"):r.createElement(r.Fragment,null,r.createElement("div",{className:"complaint-summary"},r.createElement(i.Header,null,l("CS_HEADER_COMPLAINT_SUMMARY")),Object.keys(p).length>0?r.createElement(r.Fragment,null,r.createElement(i.Card,null,r.createElement(i.CardSubHeader,null,l("SERVICEDEFS."+p.audit.serviceCode.toUpperCase())),r.createElement(i.StatusTable,null,Object.keys(p.details).map(function(e,t,n){return r.createElement(i.Row,{key:t,label:l(e),text:Array.isArray(p.details[e])?p.details[e].map(function(e){return l("object"==typeof e?null==e?void 0:e.code:e)}):l(p.details[e])||"N/A",last:t===n.length-1})})),null!=C&&C.thumbs?r.createElement(i.DisplayPhotos,{srcs:null==C?void 0:C.thumbs,onClick:function(e,t){return function(e,t){P(null==C?void 0:C.fullImage[t])}(0,t)}}):null,_?r.createElement(i.ImageViewer,{imageSrc:_,onClose:function(){v(null)}}):null),r.createElement(i.Card,null,(null==p?void 0:p.service)&&r.createElement(U,{getWorkFlow:function(e){var t,n=null==e?void 0:e.timeline;if(n&&null!==(t=n[0].timeLineActions)&&void 0!==t&&t.filter(function(e){return"COMMENT"===e}).length?h(!1):h(!0),n){var r=n.find(function(e){return"APPLY"===(null==e?void 0:e.performedAction)});S(r.thumbnailsToShow)}},complaintDetails:p,id:c,zoomImage:P})),g&&r.createElement(i.Toast,{error:y,label:l(y?"CS_COMPLAINT_COMMENT_ERROR":"CS_COMPLAINT_COMMENT_SUCCESS"),onClose:function(){return N(!1)}})," "):r.createElement(i.Loader,null)))},PGRSelectRating:function(e){var t,l=e.parentRoute,u=o.useTranslation().t,s=a.useParams().id,m=c.useDispatch(),d=a.useHistory(),p=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId(),E=Digit.Hooks.pgr.useComplaintDetails({tenantId:p,id:s}).complaintDetails,f=n.useCallback(function(e){return m(_(e))},[m]),C=n.useState(!1),S=C[0],O=C[1],v={texts:{header:"CS_COMPLAINT_RATE_HELP_TEXT",submitBarLabel:"CS_COMMONS_NEXT"},inputs:[{type:"rate",maxRating:5,label:u("CS_COMPLAINT_RATE_TEXT"),error:S?r.createElement(i.CardLabelError,null,u("CS_FEEDBACK_ENTER_RATING_ERROR")):null},{type:"checkbox",label:"CS_FEEDBACK_WHAT_WAS_GOOD",checkLabels:[u("CS_FEEDBACK_SERVICES"),u("CS_FEEDBACK_RESOLUTION_TIME"),u("CS_FEEDBACK_QUALITY_OF_WORK"),u("CS_FEEDBACK_OTHERS")]},{type:"textarea",label:u("CS_COMMON_COMMENTS"),name:"comments"}]};return r.createElement(i.RatingCard,{config:v,t:u,onSelect:function(e){E&&e.rating>0?(E.service.rating=e.rating,E.service.additionalDetail=e.CS_FEEDBACK_WHAT_WAS_GOOD.join(","),E.workflow={action:"RATE",comments:e.comments,verificationDocuments:[]},f({service:E.service,workflow:E.workflow}),d.push(l+"/response")):O(!0)}})},PGRResponseCitzen:y};exports.PGRReducers=function(){return l.combineReducers({complaints:E})},exports.initPGRComponents=function(){Object.entries(Xe).forEach(function(e){Digit.ComponentRegistryService.setComponent(e[0],e[1])})};
