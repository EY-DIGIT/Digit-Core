var e,t=require("@egovernments/digit-ui-react-components"),n=require("react"),l=(e=n)&&"object"==typeof e&&"default"in e?e.default:e,a=require("react-i18next"),o=require("react-router-dom"),i=require("react-hook-form"),r=require("react-query"),u=require("@egovernments/digit-ui-libraries");function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}function s(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function d(e,t){if(null==e)return{};var n,l,a={},o=Object.keys(e);for(l=0;l<o.length;l++)t.indexOf(n=o[l])>=0||(a[n]=e[n]);return a}var m=function(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),""==t)return e;for(;e.includes(t);)e=e.replace(t,n);return e},v=["state"],E=function(e){var r,u,c,s,E,f,p,_,y,S,N={code:"PAY_BY_OWNER",i18nKey:"PT_PAY_BY_OWNER",name:"I am making the payment as the owner/ consumer of the service"},b={code:"PAY_BEHALF_OWNER",i18nKey:"PT_PAY_BEHALF_OWNER",name:"I am making the payment on behalf of the owner/ consumer of the service"},h=null===(r=Digit.UserService.getUser())||void 0===r?void 0:r.info,A=null==h?void 0:h.name,C=null==h?void 0:h.mobileNumber,g=a.useTranslation().t,P=o.useHistory(),T=o.useLocation(),D=T.state,O=(d(T,v),o.useParams()),M=O.consumerCode,L=O.businessService,w=O.paymentAmt,I=Digit.Hooks.useQueryParams(),R=I.workflow,k=I.tenantId,x=I.ConsumerName,B=n.useState(null==D?void 0:D.bill),F=B[0],U=B[1],Y=(null==D?void 0:D.tenantId)||k||(null===(u=Digit.UserService.getUser().info)||void 0===u?void 0:u.tenantId),H=Digit.UserService.getUser(),j=null!=D&&D.bill?{isLoading:!1}:Digit.Hooks.useFetchPayment({tenantId:Y,businessService:L,consumerCode:M}),W=j.data,V=j.isLoading,z=(null==W||null===(c=W.Bill)||void 0===c||null===(s=c[0])||void 0===s?void 0:s.userId)||"",G=(E=Digit.Hooks).useCustomAPIHook.apply(E,["/user/_search",{},{data:{uuid:[z]}},{recordId:z,plainRequestFields:["mobileNumber"]},{enabled:!!z,cacheTime:100}]),K=G.isLoading,q=G.data,Q=(null==F||null===(f=F.billDetails)||void 0===f||null===(p=f.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||void 0===p?void 0:p[0])||[],Z=(null==F||null===(_=F.billDetails)||void 0===_||null===(y=_.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||void 0===y||y.reduce(function(e,t,n){return 0===n?e:e+t.amount},0),n.useState(N)),$=Z[0],X=Z[1],J=n.useState(""),ee=J[0],te=J[1],ne=n.useState(""),le=ne[0],ae=ne[1],oe=i.useForm().handleSubmit,ie=n.useState(!1),re=ie[0],ue=ie[1],ce=n.useState(null),se=ce[0],de=ce[1],me=n.useState(!1),ve=me[0],Ee=me[1],fe=n.useState(!1),pe=fe[0],_e=fe[1],ye=n.useState(""),Se=ye[0],Ne=ye[1],be=Digit.Hooks.useCustomMDMS(Digit.ULBService.getStateId(),"common-masters",[{name:"CitizenConsentForm"}]),he=be.isLoading,Ae=be.data;function Ce(e){Ee(e.target.checked)}return n.useEffect(function(){var e,t,n,l,a;null!=Ae&&null!==(e=Ae["common-masters"])&&void 0!==e&&null!==(t=e.CitizenConsentForm)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.isCitizenConsentFormEnabled&&_e(null==Ae||null===(l=Ae["common-masters"])||void 0===l||null===(a=l.CitizenConsentForm)||void 0===a?void 0:a[0])},[Ae]),n.useEffect(function(){if(!F&&W){var e,t=null==W||null===(e=W.Bill)||void 0===e?void 0:e.filter(function(e){return e.consumerCode==M})[0];U(t)}},[V]),V||K||he?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.BackButton,null,g("CS_COMMON_BACK")),l.createElement("form",{onSubmit:oe(function(){var e,t,n,l,a,o,i,r;"WNS"===R?P.push("/"+(null===(e=window)||void 0===e?void 0:e.contextPath)+"/citizen/payment/collect/"+L+"/"+M+"?workflow=WNS&consumerCode="+m(M,"+","/"),{paymentAmount:w,tenantId:Q.tenantId,name:(null==$?void 0:$.code)!==(null==b?void 0:b.code)&&"undefined"!==x?x:h?A:ee,mobileNumber:(null==$?void 0:$.code)!==(null==b?void 0:b.code)?null!=F&&null!==(t=F.mobileNumber)&&void 0!==t&&t.includes("*")?null==q||null===(n=q.user)||void 0===n||null===(l=n[0])||void 0===l?void 0:l.mobileNumber:null==F?void 0:F.mobileNumber:h?C:le}):P.push("/"+(null===(a=window)||void 0===a?void 0:a.contextPath)+"/citizen/payment/collect/"+L+"/"+M,{paymentAmount:w,tenantId:Q.tenantId,name:(null==$?void 0:$.code)!==(null==b?void 0:b.code)?null==F?void 0:F.payerName:h?A:ee,mobileNumber:(null==$?void 0:$.code)!==(null==b?void 0:b.code)?null!=F&&null!==(o=F.mobileNumber)&&void 0!==o&&o.includes("*")?null==q||null===(i=q.user)||void 0===i||null===(r=i[0])||void 0===r?void 0:r.mobileNumber:null==F?void 0:F.mobileNumber:h?C:le})})},l.createElement(t.Header,null,g("PT_PAYERS_DETAILS_HEADER")),l.createElement(t.Card,null,l.createElement("span",{className:"card-label-error"},g(se)),l.createElement(t.RadioButtons,{selectedOption:$,onSelect:X,options:[N,b],optionsKey:"name",inputStyle:{marginTop:"11px"},innerStyles:{display:"flex"}}),l.createElement("div",{style:{position:"relative"}},(null==$?void 0:$.code)===(null==N?void 0:N.code)||h?null:l.createElement("div",{style:{position:"relative"}},l.createElement("span",null,l.createElement("span",null,g("PT_PAYERS_MOBILE_NO")),l.createElement(t.MobileNumber,{onChange:function(e){de(null),e.match("^\\d{10}$")||(de("CORE_COMMON_PHONENO_INVALIDMSG"),ue(!1)),ae(e),ue(10==e.length&&""!=ee)},value:le})),l.createElement("span",null,l.createElement("span",null,g("PT_PAYERS_NAME")),l.createElement(t.TextInput,{onChange:function(e){return te(t=e.target.value),void ue(0!==t.length&&"CORE_COMMON_PHONENO_INVALIDMSG"!=se&&""!=ee&&""!=le);var t},value:ee})))),(null==pe?void 0:pe.isCitizenConsentFormEnabled)&&!(null!=H&&H.access_token)&&l.createElement("div",null,l.createElement(t.CheckBox,{className:"form-field",label:l.createElement("span",null,null==pe||null===(S=pe.checkBoxLabels)||void 0===S?void 0:S.map(function(e,t){var n;return l.createElement("span",null,(null==e?void 0:e.linkPrefix)&&l.createElement("span",null,g((null==e?void 0:e.linkPrefix)+"_")),(null==e?void 0:e.link)&&l.createElement("span",{id:null==e?void 0:e.linkId,onClick:function(e){!function(e){Ne(e.target.id)}(e)},style:{color:"#F47738",cursor:"pointer"}},g((null==e?void 0:e.link)+"_")),(null==e?void 0:e.linkPostfix)&&l.createElement("span",null,g((null==e?void 0:e.linkPostfix)+"_")),t==(null==pe||null===(n=pe.checkBoxLabels)||void 0===n?void 0:n.length)-1&&g("LABEL"))})),value:ve,checked:ve,style:{marginTop:"5px",marginLeft:"55px"},styles:{marginBottom:"30px"},onChange:Ce}),l.createElement(t.CitizenConsentForm,{styles:{},t:g,isCheckBoxChecked:Ce,labels:null==pe?void 0:pe.checkBoxLabels,mdmsConfig:Se,setMdmsConfig:Ne})),l.createElement(t.SubmitBar,{label:g("CS_COMMON_NEXT"),disabled:null==pe||!pe.isCitizenConsentFormEnabled||null!=H&&H.access_token?(null==$?void 0:$.code)===(null==b?void 0:b.code)&&!h&&!re:!(((null==$?void 0:$.code)!==(null==b?void 0:b.code)||h||re)&&ve),submit:!0}))))},f=function(e){var n,i=e.bill,r=e.currentPath,u=e.businessService,c=e.getKeyNotesConfig,s=a.useTranslation().t,d=o.useHistory();return l.createElement(l.Fragment,null,"function"==typeof c&&l.createElement(t.Card,null,c(u,s)["my-bill"].map(function(e,n){var a=e.keyPath.reduce(function(e,t){return"function"==typeof t?t(e):e[t]},i);return l.createElement(t.KeyNote,{key:n+e.keyValue,keyValue:s(e.keyValue),note:a||e.fallback,noteStyle:e.noteStyle||{}})}),l.createElement(t.SubmitBar,{disabled:!(null!==(n=i.totalAmount)&&void 0!==n&&n.toFixed(2)),onSubmit:function(){d.push(r+"/"+i.consumerCode,{tenantId:null==i?void 0:i.tenantId})},label:s("CS_MY_APPLICATION_VIEW_DETAILS")})))},p=function(e){var i,r=e.billsList,u=e.currentPath,s=e.businessService,d=a.useTranslation().t,m=(o.useHistory(),r.map(function(e){return e.consumerCode})),v=Digit.Hooks.useApplicationsForBusinessServiceSearch({filters:{consumerCodes:m.join()},businessService:s}),E=v.key,p=n.useState([]),_=p[0],y=p[1],S=n.useState(function(){var e;return null===(e=Digit.ComponentRegistryService)||void 0===e?void 0:e.getComponent("getBillDetailsConfigWithBusinessService")})[0],N=n.useMemo(function(){return{}},[]),b=n.useMemo(function(){return{}},[]);return n.useEffect(function(){v.data&&v.refetch()},[]),n.useEffect(function(){if(v.data){var e=v.data.filter(function(e){return m.includes(e[E])}),t=e.map(function(e){return e[E]});e.forEach(function(e){N[e[E]]=e}),r.forEach(function(e){b[e.consumerCode]=e});var n=t.map(function(e){return c({},b[e],N[e])});y(n)}},[v.data,S]),v.isLoading?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement("div",{className:"static"},l.createElement(t.Header,null,d("CS_TITLE_MY_BILLS")+" ("+_.length+")"),(null==_?void 0:_.length)>0&&S&&_.map(function(e,t){return l.createElement("div",{key:t},l.createElement(f,{bill:e,currentPath:u,businessService:s,getKeyNotesConfig:S}))}),!(null!=_&&_.length)>0&&l.createElement("p",{style:{paddingLeft:"16px"}},d("CS_BILLS_TEXT_NO_BILLS_FOUND")),"PT"===s&&l.createElement("p",{style:{paddingLeft:"16px",paddingTop:"16px"}},d("PT_TEXT_NOT_ABLE_TO_FIND_THE_PROPERTY"),l.createElement("span",{className:"link"},l.createElement(o.Link,{to:"/"+(null===(i=window)||void 0===i?void 0:i.contextPath)+"/citizen/pt/property/citizen-search"},d("PT_COMMON_CLICK_HERE"))))))},_={root:{width:"100%",marginTop:"2px",overflowX:"auto",boxShadow:"none"},table:{minWidth:700,backgroundColor:"rgba(250, 250, 250, var(--bg-opacity))"},cell:{maxWidth:"7em",minWidth:"1em",border:"1px solid #e8e7e6",padding:"4px 5px",fontSize:"0.8em",textAlign:"left",lineHeight:"1.5em"},cellHeader:{overflow:"hidden",textOverflow:"ellipsis"},cellLeft:{},cellRight:{}},y=function(e){var t=e.headers,n=void 0===t?[]:t,o=e.values,i=void 0===o?[]:o,r=e.arrears,u=void 0===r?0:r,s=a.useTranslation().t;return l.createElement(l.Fragment,null,l.createElement("div",{style:_.root},l.createElement("table",{className:"table-fixed-column-common-pay",style:_.table},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{style:c({},_.cell,_.cellLeft,_.cellHeader)},s("CS_BILL_PERIOD")),n.map(function(e,t){return l.createElement("th",{style:c({},_.cell,n.length==t+1?_.cellRight:{},_.cellHeader),key:t},s(e))}))),l.createElement("tbody",null,Object.values(i).map(function(e,t){return l.createElement("tr",{key:t},l.createElement("td",{style:c({},_.cell,_.cellLeft),component:"th",scope:"row"},Object.keys(i)[t]),n.map(function(t,a){return l.createElement("td",{style:c({},_.cell,{textAlign:"left"},n.length==a+1?_.cellRight:{},{whiteSpace:"pre"}),key:a,numeric:!0},a>1&&"₹",e[t]&&e[t].value||"0")}))}),l.createElement("tr",null,l.createElement("td",{style:c({},_.cell,_.cellLeft)}),n.map(function(e,t){return t==n.length-1?l.createElement("td",{style:c({},_.cell,_.cellRight,{textAlign:"left",fontWeight:"700",whiteSpace:"pre"}),key:t,numeric:!0},u):t==n.length-2?l.createElement("td",{style:c({},_.cell,{textAlign:"left"}),key:t,numeric:!0},s("COMMON_ARREARS_TOTAL")):l.createElement("td",{style:_.cell,key:t,numeric:!0})}))))))},S={buttonStyle:{display:"flex",justifyContent:"flex-end",color:"#f47738"},headerStyle:{marginTop:"10px",fontSize:"16px",fontWeight:"700",lineHeight:"24px",color:" rgba(11, 12, 12, var(--text-opacity))"}},N=function(e){var t,o,i,r=e.bill,u=void 0===r?{}:r,c=a.useTranslation().t,s={},d=(null==u||null===(t=u.billDetails)||void 0===t?void 0:t.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||[],m=(null===(o=d=[].concat(d))||void 0===o?void 0:o.reduce(function(e,t,n){return 0===n?e:e+t.amount},0))||0,v="₹ "+((null==m||null===(i=m.toFixed)||void 0===i?void 0:i.call(m,0))||Number(0).toFixed(0));d.shift(),d.map(function(e){var t,n,l,a,o=function(e){var t,n,l;void 0===e&&(e={});var a={},o=e.billAccountDetails;return(void 0===o?[]:o).map(function(e){a[e.taxHeadCode]={value:e.amount,order:e.order}}),a.CS_BILL_NO={value:(null===(t=e)||void 0===t?void 0:t.billNumber)||"NA",order:-2},a.CS_BILL_DUEDATE={value:(null===(n=e)||void 0===n?void 0:n.expiryDate)&&new Date(null===(l=e)||void 0===l?void 0:l.expiryDate).toLocaleDateString()||"NA",order:-1},a.TL_COMMON_TOTAL_AMT={value:e.amount,order:10},a}(e);s[(t=e.fromPeriod,n=e.toPeriod,l=new Date(t),a=new Date(n),a.getYear()-l.getYear()!=0?"FY"+(l.getYear()+1900)+"-"+(a.getYear()-100):l.toLocaleDateString()+"-"+a.toLocaleDateString())]=o});var E={};!s||Object.keys(s).map(function(e,t){Object.keys(s[e]).map(function(t){E[t]=s[e]&&s[e][t]&&s[e][t].order||0})});var f=[];(f=Object.keys(E)).sort(function(e,t){return E[e]-E[t]});var p=n.useState(!1),_=p[0],N=p[1];return 0==m||m<0?l.createElement("span",null):l.createElement(l.Fragment,null,l.createElement("div",{style:S.headerStyle},c("CS_ARREARS_DETAILS")),_&&l.createElement(y,{headers:[].concat(f),values:s,arrears:v}),!_&&l.createElement("div",{style:S.buttonStyle},l.createElement("button",{type:"button",onClick:function(){N(!0)}},c("CS_SHOW_CARD"))),_&&l.createElement("div",{style:S.buttonStyle},l.createElement("button",{type:"button",onClick:function(){N(!1)}},c("CS_HIDE_CARD"))))},b=function(e){var t,o=e.billAccountDetails,i=e.total,r=e.arrears,u=a.useTranslation().t,c=Digit.Hooks.useQueryParams().workflow;return n.useEffect(function(){"mcollect"===c&&o&&o.map(function(e){e.taxHeadCode.includes("CGST")?e.order=3:e.taxHeadCode.includes("SGST")&&(e.order=4)})},[o]),l.createElement(l.Fragment,null,l.createElement("div",{className:"bill-summary"},o.sort(function(e,t){return e.order-t.order}).map(function(e,t){var n;return l.createElement("div",{key:t,className:"bill-account-details"},l.createElement("div",{className:"label"},u(e.taxHeadCode)),l.createElement("div",{className:"value"},"₹ ",Math.abs(null==e||null===(n=e.amount)||void 0===n?void 0:n.toFixed(2))))}),l.createElement("div",{className:"bill-account-details"},l.createElement("div",{className:"label"},u("COMMON_ARREARS")),l.createElement("div",{className:"value"},"₹ ",Math.abs((null==r||null===(t=r.toFixed)||void 0===t?void 0:t.call(r,2))||Number(0).toFixed(2)))),l.createElement("hr",{className:"underline"}),l.createElement("div",{className:"amount-details"},l.createElement("div",{className:"label"},u("CS_PAYMENT_TOTAL_AMOUNT")),l.createElement("div",{className:"value"},"₹ ",Number(i).toFixed(2)))))},h=function(e){var i,r,u,c,s,d,v,E,f,p,_,y,S,h=e.paymentRules,A=e.businessService,C=a.useTranslation().t,g=o.useHistory(),P=o.useLocation(),T=P.state,D=P.pathname,O=P.search,M=Digit.UserService.getUser(),L=o.useParams().consumerCode,w=Digit.Hooks.useQueryParams(),I=w.workflow,R=w.tenantId,k=w.authorization,x=w.ConsumerName,B=n.useState(null==T?void 0:T.bill),F=B[0],U=B[1],Y=(null==T?void 0:T.tenantId)||R||(null===(i=Digit.UserService.getUser().info)||void 0===i?void 0:i.tenantId),H=null==T?void 0:T.propertyId;"WNS"===I&&L.includes("?")&&(L=L.substring(0,L.indexOf("?")));var j=null!=T&&T.bill?{isLoading:!1}:Digit.Hooks.useFetchPayment({tenantId:Y,businessService:A,consumerCode:"WNS"===I?m(L,"+","/"):L}),W=j.data,V=j.isLoading,z=(null==W||null===(r=W.Bill)||void 0===r||null===(u=r[0])||void 0===u?void 0:u.userId)||"",G=(c=Digit.Hooks).useCustomAPIHook.apply(c,["/user/_search",{},{data:{uuid:[z]}},{recordId:z,plainRequestFields:["mobileNumber"]},{enabled:!!z,cacheTime:100}]).data,K=Digit.Hooks.fsm.useApplicationDetail(C,Y,L,{enabled:!!D.includes("FSM")},"CITIZEN"),q=K.isLoading,Q=K.data,Z=h.minAmountPayable,$=h.isAdvanceAllowed;Z="WNS"===I?100:Z;var X,J,ee,te,ne,le,ae,oe,ie,re=(null==F||null===(s=F.billDetails)||void 0===s||null===(d=s.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||void 0===d?void 0:d[0])||[],ue=(null==F||null===(v=F.billDetails)||void 0===v||null===(E=v.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||void 0===E?void 0:E.reduce(function(e,t,n){return 0===n?e:e+t.amount},0))||0,ce=Digit.Hooks.useApplicationsForBusinessServiceSearch({businessService:A},{enabled:!1}).label,se=function(){return(null==F?void 0:F.totalAmount)||0},de=n.useState(C("CS_PAYMENT_FULL_AMOUNT")),me=de[0],ve=de[1],Ee=n.useState(se()),fe=Ee[0],pe=Ee[1],_e=n.useState(!0),ye=_e[0],Se=_e[1],Ne=n.useState(""),be=Ne[0],he=Ne[1];return"true"!==k||null!=M&&M.access_token||(localStorage.clear(),sessionStorage.clear(),window.location.href="/"+(null===(X=window)||void 0===X?void 0:X.contextPath)+"/citizen/login?from="+encodeURIComponent(D+O)),n.useEffect(function(){window.scroll({top:0,behavior:"smooth"})},[]),n.useEffect(function(){me==C("CS_PAYMENT_FULL_AMOUNT")&&pe(se())},[me,F]),n.useEffect(function(){var e=$;$&&"WNS"===I&&(e=!1);var t=Z&&fe>=Z&&!e&&fe<=se()&&!be;me!=C("CS_PAYMENT_FULL_AMOUNT")?Se(t):Se(!0)},[me,fe]),n.useEffect(function(){var e;q||"PENDING_APPL_FEE_PAYMENT"!==(null==Q||null===(e=Q.pdfData)||void 0===e?void 0:e.applicationStatus)||(Se(!0),ve(C("CS_PAYMENT_ADV_COLLECTION")))}),n.useEffect(function(){if(!F&&W){var e=W.Bill.filter(function(e){return e.consumerCode==("WNS"===I?m(L,"+","/"):L)})[0];U(e)}},[V]),V||q?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Header,null,C("CS_PAYMENT_BILL_DETAILS")),l.createElement(t.Card,null,l.createElement("div",null,l.createElement(t.KeyNote,{keyValue:C("PT.MUTATION"==A?"PDF_STATIC_LABEL_MUATATION_NUMBER_LABEL":ce),note:"WNS"===I?m(L,"+","/"):L}),"PT.MUTATION"!==A&&"FSM.TRIP_CHARGES"!==A&&l.createElement(t.KeyNote,{keyValue:C("CS_PAYMENT_BILLING_PERIOD"),note:(oe=re.fromPeriod,ie=re.toPeriod,oe&&ie?"mcollect"===I||"WNS"===I?(ee=new Date(oe).getDate().toString()+" "+(null===(ne=Digit.Utils.date.monthNames[new Date(oe).getMonth()])||void 0===ne?void 0:ne.toString())+" "+new Date(oe).getFullYear().toString())+" - "+(te=new Date(ie).getDate()+" "+Digit.Utils.date.monthNames[new Date(ie).getMonth()]+" "+new Date(ie).getFullYear()):(ee=new Date(re.fromPeriod).getFullYear().toString())===(te=new Date(re.toPeriod).getFullYear().toString())?window.location.href.includes("BPA")?new Date(null==W||null===(le=W.Bill)||void 0===le||null===(ae=le[0])||void 0===ae?void 0:ae.billDate).getMonth()+1<4?"FY "+(parseInt(ee)-1).toString()+"-"+te:"FY "+ee+"-"+(parseInt(te)+1).toString():"FY "+ee:"FY "+ee+"-"+te:"N/A")}),(null==A?void 0:A.includes("PT"))||"WNS"===I&&(null==re?void 0:re.currentBillNo)&&l.createElement(t.KeyNote,{keyValue:C("CS_BILL_NO"),note:null==re?void 0:re.currentBillNo}),(null==A?void 0:A.includes("PT"))||"WNS"===I&&(null==re?void 0:re.currentExpiryDate)&&l.createElement(t.KeyNote,{keyValue:C("CS_BILL_DUEDATE"),note:new Date(null==re?void 0:re.currentExpiryDate).toLocaleDateString()}),"FSM.TRIP_CHARGES"===A?l.createElement("div",null,l.createElement(t.KeyNote,{keyValue:C("ES_PAYMENT_DETAILS_TOTAL_AMOUNT"),note:null==Q||null===(f=Q.pdfData)||void 0===f?void 0:f.totalAmount}),l.createElement(t.KeyNote,{keyValue:C("ES_PAYMENT_DETAILS_ADV_AMOUNT"),note:null==Q||null===(p=Q.pdfData)||void 0===p?void 0:p.advanceAmount}),"PENDING_APPL_FEE_PAYMENT"!==(null==Q||null===(_=Q.pdfData)||void 0===_?void 0:_.applicationStatus)?l.createElement(t.KeyNote,{keyValue:C("FSM_DUE_AMOUNT_TO_BE_PAID"),note:null==F?void 0:F.totalAmount}):null):l.createElement(b,{billAccountDetails:(null==re?void 0:re.billAccountDetails)||[],total:se(),businessService:A,arrears:ue}),l.createElement(N,{bill:F})),l.createElement("div",{className:"bill-payment-amount"},l.createElement("hr",{className:"underline"}),l.createElement(t.CardSubHeader,null,C("CS_COMMON_PAYMENT_AMOUNT")),"FSM.TRIP_CHARGES"===A?null:l.createElement(t.RadioButtons,{selectedOption:me,onSelect:ve,options:h.partPaymentAllowed&&"POST_PAY"!==(null==Q||null===(y=Q.pdfData)||void 0===y?void 0:y.paymentPreference)&&"PENDING_APPL_FEE_PAYMENT"===(null==Q||null===(S=Q.pdfData)||void 0===S?void 0:S.applicationStatus)?[C("CS_PAYMENT_ADV_COLLECTION")]:[C("CS_PAYMENT_FULL_AMOUNT")]}),l.createElement("div",{style:{position:"relative"}},l.createElement("span",{className:"payment-amount-front",style:{border:"1px solid "+(C("CS_PAYMENT_FULL_AMOUNT"),"#9a9a9a")}},"₹"),me!==C("CS_PAYMENT_FULL_AMOUNT")?l.createElement(t.TextInput,"FSM.TRIP_CHARGES"===A?{className:"text-indent-xl",onChange:function(){},value:null==Q||null===(J=Q.pdfData)||void 0===J?void 0:J.advanceAmount,disable:!0}:{className:"text-indent-xl",onChange:function(e){return t=e.target.value,he(""),isNaN(t)||t.includes(".")?he("AMOUNT_INVALID"):!$&&t>se()?he("CS_ADVANCED_PAYMENT_NOT_ALLOWED"):t<Z&&he("CS_CANT_PAY_BELOW_MIN_AMOUNT"),void pe(t);var t},value:fe,disable:0===se()}):l.createElement(t.TextInput,{className:"text-indent-xl",value:se(),onChange:function(){},disable:!0}),"CS_CANT_PAY_BELOW_MIN_AMOUNT"===be?l.createElement("span",{className:"card-label-error"},C(be),": ","₹"+Z):l.createElement("span",{className:"card-label-error"},C(be))),l.createElement(t.SubmitBar,{disabled:!ye||0===se(),onSubmit:function(){var e,t,n=me===C("CS_PAYMENT_FULL_AMOUNT")?se():fe||"FSM.TRIP_CHARGES"===A?null==Q||null===(e=Q.pdfData)||void 0===e?void 0:e.advanceAmount:fe;if(window.location.href.includes("mcollect"))g.push("/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/citizen/payment/collect/"+A+"/"+L+"?workflow=mcollect",{paymentAmount:n,tenantId:re.tenantId});else if("WNS"===I){var l,a,o,i;g.push("/"+(null===(l=window)||void 0===l?void 0:l.contextPath)+"/citizen/payment/billDetails/"+A+"/"+L+"/"+n+"?workflow=WNS&ConsumerName="+x,{paymentAmount:n,tenantId:re.tenantId,name:F.payerName,mobileNumber:F.mobileNumber&&null!==(a=F.mobileNumber)&&void 0!==a&&a.includes("*")?null==G||null===(o=G.user)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.mobileNumber:F.mobileNumber})}else if("PT"===A){var r,u,c,s;g.push("/"+(null===(r=window)||void 0===r?void 0:r.contextPath)+"/citizen/payment/billDetails/"+A+"/"+L+"/"+n,{paymentAmount:n,tenantId:re.tenantId,name:F.payerName,mobileNumber:F.mobileNumber&&null!==(u=F.mobileNumber)&&void 0!==u&&u.includes("*")?null==G||null===(c=G.user)||void 0===c||null===(s=c[0])||void 0===s?void 0:s.mobileNumber:F.mobileNumber})}else{var d;g.push("/"+(null===(d=window)||void 0===d?void 0:d.contextPath)+"/citizen/payment/collect/"+A+"/"+L,{paymentAmount:n,tenantId:re.tenantId,propertyId:H})}},label:C("CS_COMMON_PROCEED_TO_PAY")}))))},A=["url"],C=function(e){var n=e.billsList,a=e.paymentRules,i=e.businessService,r=o.useRouteMatch(),u=r.url;return d(r,A),l.createElement(l.Fragment,null,l.createElement(t.BackButton,null),l.createElement(o.Switch,null,l.createElement(o.Route,{exact:!0,path:""+u,component:function(){return l.createElement(p,{billsList:n,currentPath:u,paymentRules:a,businessService:i})}}),l.createElement(o.Route,{path:u+"/:consumerCode",component:function(){return l.createElement(h,{paymentRules:a,businessService:i})}})))},g=function(e){var n,a,i,r,u=e.stateCode,c=o.useParams().businessService,s=Digit.Hooks.useQueryParams(),d=s.tenantId,m=s.isDisoconnectFlow,v=(Digit.Services.useStore({stateCode:u,moduleCode:c,language:Digit.StoreData.getCurrentLanguage()}),o.useHistory()),E=o.useRouteMatch().url,f=o.useLocation(),p=((null===(n=Digit.UserService.getUser())||void 0===n?void 0:n.info)||(null==f?void 0:f.state)||{tenantId:d}||{}).tenantId;p||null!=f&&null!==(a=f.state)&&void 0!==a&&a.fromSearchResults||v.replace("/"+(null===(r=window)||void 0===r?void 0:r.contextPath)+"/citizen/login",{from:E});var _,y,S,N,b,h=Digit.Hooks.useFetchCitizenBillsForBuissnessService({businessService:c},{refetchOnMount:!0,enabled:!(null!=f&&null!==(i=f.state)&&void 0!==i&&i.fromSearchResults)}).data,A=Digit.Hooks.useGetPaymentRulesForBusinessServices(p),g=A.data,P=(null==h?void 0:h.Bill)||[];return A.isLoading?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(C,{billsList:P,paymentRules:(N=null==g||null===(_=g.MdmsRes)||void 0===_||null===(y=_.BillingService)||void 0===y?void 0:y.BusinessService,b="WS"!==c&&"SW"!==c||"true"!==m?c:"DISCONNECT",null!=N&&N.length?(null===(S=N.filter(function(e){return e.code==b}))||void 0===S?void 0:S[0])||{isAdvanceAllowed:!1,isVoucherCreationEnabled:!0,minAmountPayable:100,partPaymentAllowed:!1}:{}),businessService:c}))};function P(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var T=function(e){var r=o.useLocation().state,u=void 0===r?{}:r,c=Digit.UserService.getUser(),s=n.useState(null),d=s[0],v=s[1],E=Digit.Hooks.useQueryParams(),f=E.tenantId,p=E.authorization,_=E.workflow,y=E.consumerCode,S=null==u?void 0:u.paymentAmount,N=a.useTranslation().t,b=(o.useHistory(),o.useLocation()),h=b.pathname,A=b.search,C=o.useParams(),g=C.consumerCode,T=C.businessService,D=(null==u?void 0:u.tenantId)||f||Digit.ULBService.getCurrentTenantId(),O=null==u?void 0:u.propertyId,M=Digit.ULBService.getStateId(),L=i.useForm(),w=L.control,I=L.handleSubmit,R=Digit.Hooks.useCommonMDMS(M,"DIGIT-UI","PaymentGateway"),k=R.data,x=R.isLoading,B=Digit.Hooks.useFetchPayment({tenantId:D,consumerCode:"WNS"===_?y:g,businessService:T},{}),F=B.data,U=B.isLoading;(window.location.href.includes("ISWSCON")||"WNS"===_)&&(g=decodeURIComponent(g)),"WNS"===_&&(g=m(g,"+","/")),n.useEffect(function(){null!=F&&F.Bill&&0==F.Bill.length&&v({key:!0,label:"CS_BILL_NOT_FOUND"})},[F]),n.useEffect(function(){localStorage.setItem("BillPaymentEnabled","true")},[]);var Y,H=u.name,j=u.mobileNumber,W=null!=F&&F.Bill?null==F?void 0:F.Bill[0]:{};return"true"!==p||c.access_token||(localStorage.clear(),sessionStorage.clear(),window.location.href="/"+(null===(Y=window)||void 0===Y?void 0:Y.contextPath)+"/citizen/login?from="+encodeURIComponent(h+A)),x||U?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.BackButton,null,N("CS_COMMON_BACK")),l.createElement("form",{onSubmit:I(function(e){try{var t,n,l,a,o={Transaction:{tenantId:null==W?void 0:W.tenantId,txnAmount:S||W.totalAmount,module:T,billId:W.id,consumerCode:g,productInfo:"Common Payment",gateway:e.paymentType,taxAndPayments:[{billId:W.id,amountPaid:S||W.totalAmount}],user:{name:(H||(null==c||null===(t=c.info)||void 0===t?void 0:t.name)||(null==W?void 0:W.payerName)).trim(),mobileNumber:j||(null==c||null===(n=c.info)||void 0===n?void 0:n.mobileNumber)||(null==W?void 0:W.mobileNumber),tenantId:null==W?void 0:W.tenantId},callbackUrl:window.location.href.includes("mcollect")||"WNS"===_?window.location.protocol+"//"+window.location.host+"/"+(null===(l=window)||void 0===l?void 0:l.contextPath)+"/citizen/payment/success/"+T+"/"+("WNS"===_?encodeURIComponent(g):g)+"/"+D+"?workflow="+("WNS"===_?_:"mcollect"):window.location.protocol+"//"+window.location.host+"/"+(null===(a=window)||void 0===a?void 0:a.contextPath)+"/citizen/payment/success/"+T+"/"+("WNS"===_?encodeURIComponent(g):g)+"/"+D+"?propertyId="+O,additionalDetails:{isWhatsapp:!1}}},i=P(function(){return Promise.resolve(Digit.PaymentService.createCitizenReciept(null==W?void 0:W.tenantId,o)).then(function(e){var t,n=null==e||null===(t=e.Transaction)||void 0===t?void 0:t.redirectUrl;window.location=n})},function(e){var t,n,l,a,o,i,r="CS_PAYMENT_UNKNOWN_ERROR_ON_SERVER";null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&null!==(l=n.Errors)&&void 0!==l&&l[0]&&(r=(null===(a=e.response)||void 0===a||null===(o=a.data)||void 0===o||null===(i=o.Errors)||void 0===i?void 0:i[0]).code),v({key:!0,label:N(r)})});return Promise.resolve(i&&i.then?i.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})},l.createElement(t.Header,null,N("PAYMENT_CS_HEADER")),l.createElement(t.Card,null,l.createElement("div",{className:"payment-amount-info",style:{marginBottom:"26px"}},l.createElement(t.CardLabel,{className:"dark"},N("PAYMENT_CS_TOTAL_AMOUNT_DUE")),l.createElement(t.CardSectionHeader,null," ₹ ",void 0!==S?Number(S).toFixed(2):Number(null==W?void 0:W.totalAmount).toFixed(2))),l.createElement(t.CardLabel,null,N("PAYMENT_CS_SELECT_METHOD")),(null==k?void 0:k.length)&&l.createElement(i.Controller,{name:"paymentType",defaultValue:k[0],control:w,render:function(e){return l.createElement(t.RadioButtons,{selectedOption:e.value,options:k,onSelect:e.onChange})}}),!d&&l.createElement(t.SubmitBar,{label:N("PAYMENT_CS_BUTTON_LABEL"),submit:!0}))),l.createElement(t.InfoBanner,{label:N("CS_COMMON_INFO"),text:N("CS_PAYMENT_REDIRECT_NOTICE")}),d&&l.createElement(t.Toast,{error:d.key,label:N(d.label),onClose:function(){v(null)}}))},D=function(e){return"true"!==localStorage.getItem("BillPaymentEnabled")?(window.history.forward(),null):l.createElement(O,e)},O=function(e){var i,u,s,d,m,v,E,f,p,_,y,S,N,b,h,A,C,g,P,T,D,O,M,L,w,I,R,k,x,B,F,U,Y,H,j,W=a.useTranslation().t,V=r.useQueryClient(),z=Digit.Hooks.useQueryParams(),G=z.eg_pg_txnid,K=z.workflow,q=n.useState(!1),Q=q[0],Z=q[1],$=n.useState(!1),X=$[0],J=$[1],ee=o.useParams(),te=ee.businessService,ne=ee.consumerCode,le=ee.tenantId,ae=(null===(i=Digit)||void 0===i||null===(u=i.Hooks)||void 0===u||null===(s=u.obps)||void 0===s?void 0:s.useOBPSSearch("",{},le,{applicationNo:ne},{},{enabled:window.location.href.includes("bpa")||window.location.href.includes("BPA")}))||{},oe=ae.data,ie=void 0===oe?{}:oe,re=ae.isLoading,ue=Digit.Hooks.usePaymentUpdate({egId:G},te,{retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1}),ce=ue.isLoading,se=ue.data,de=ue.isError,me=Digit.Hooks.useApplicationsForBusinessServiceSearch({businessService:te},{enabled:!1}).label,ve=Digit.Hooks.useRecieptSearch({tenantId:le,businessService:te,receiptNumbers:null==se||null===(d=se.payments)||void 0===d||null===(m=d.Payments)||void 0===m||null===(v=m[0])||void 0===v?void 0:v.paymentDetails[0].receiptNumber},{retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1,select:function(e){return e.Payments[0]},enabled:X}),Ee=ve.data,fe=ve.isLoading,pe=Digit.Hooks.useCommonMDMS(le,"common-masters","ReceiptKey",{select:function(e){var t,n,l;return(null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonPay)||void 0===n||null===(l=n.filter(function(e){return null==te?void 0:te.includes(e.code)})[0])||void 0===l?void 0:l.receiptKey)||"consolidatedreceipt"},retry:!1,staleTime:Infinity,refetchOnWindowFocus:!1}).data,_e=null==se?void 0:se.payments;if(n.useEffect(function(){return function(){localStorage.setItem("BillPaymentEnabled","false"),V.clear()}},[]),n.useEffect(function(){se&&se.txnStatus&&"FAILURE"!==se.txnStatus&&J(!0)},[se]),ce||fe)return l.createElement(t.Loader,null);var ye,Se,Ne,be,he=null==se?void 0:se.applicationNo,Ae=window.Digit.Utils.browser.isMobile();if(de||!_e||!_e.Payments||0===_e.Payments.length||"FAILURE"===se.txnStatus)return l.createElement(t.Card,null,l.createElement(t.Banner,{message:W("CITIZEN_FAILURE_COMMON_PAYMENT_MESSAGE"),info:W("CS_PAYMENT_TRANSANCTION_ID"),applicationNumber:G,successful:!1}),l.createElement(t.CardText,null,W("CS_PAYMENT_FAILURE_MESSAGE")),null!=te&&te.includes("PT")?l.createElement(l.Fragment,null,l.createElement(o.Link,{to:he&&"/"+(null===(Se=window)||void 0===Se?void 0:Se.contextPath)+"/citizen/payment/my-bills/"+te+"/"+he||"/"+(null===(Ne=window)||void 0===Ne?void 0:Ne.contextPath)+"/citizen"},l.createElement(t.SubmitBar,{label:W("CS_PAYMENT_TRY_AGAIN")})),l.createElement("div",{className:"link",style:Ae?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"}},l.createElement(o.Link,{to:"/"+(null===(be=window)||void 0===be?void 0:be.contextPath)+"/citizen"},W("CORE_COMMON_GO_TO_HOME")))):l.createElement(o.Link,{to:"/"+(null===(ye=window)||void 0===ye?void 0:ye.contextPath)+"/citizen"},l.createElement(t.SubmitBar,{label:W("CORE_COMMON_GO_TO_HOME")})));var Ce,ge,Pe,Te,De,Oe,Me=null==se||null===(E=se.payments)||void 0===E?void 0:E.Payments[0],Le=null==Me?void 0:Me.transactionDate,we=function(){try{var e,t=function(){return Promise.resolve(Digit.PaymentService.printReciept(n,{fileStoreIds:l.filestoreIds[0]})).then(function(e){e&&e[l.filestoreIds[0]]&&window.open(e[l.filestoreIds[0]],"_blank"),Z(!1)})};if(Q)return Promise.resolve();Z(!0);var n=Digit.ULBService.getStateId(),l={filestoreIds:[null===(e=_e.Payments[0])||void 0===e?void 0:e.fileStoreId]},a=function(){if(null==Me||!Me.fileStoreId)return Promise.resolve(Digit.PaymentService.generatePdf(n,{Payments:[_e.Payments[0]]},pe)).then(function(e){l=e})}();return Promise.resolve(a&&a.then?a.then(t):t())}catch(e){return Promise.reject(e)}},Ie=function(e,t){void 0===t&&(t="download");try{var n,l,a={applicationNo:null==ie||null===(n=ie[0])||void 0===n?void 0:n.applicationNo};return Promise.resolve(Digit.OBPSService.BPASearch(null==ie||null===(l=ie[0])||void 0===l?void 0:l.tenantId,a)).then(function(n){var l,a;return Promise.resolve(Digit.OBPSService.scrutinyDetails(null==ie||null===(l=ie[0])||void 0===l?void 0:l.tenantId,{edcrNumber:null==ie||null===(a=ie[0])||void 0===a?void 0:a.edcrNumber})).then(function(l){var a,o,i=null==n||null===(a=n.BPA)||void 0===a?void 0:a[0],r=null==l||null===(o=l.edcrDetail)||void 0===o?void 0:o[0],u=new Date;i.additionalDetails.runDate=function(e,t){void 0===t&&(t="dayend");try{var n=e.match(/(\d{4})-(\d{1,2})-(\d{1,2})/),l=new Date(Date.UTC(n[1],n[2]-1,n[3]));return l.setMinutes(l.getMinutes()+l.getTimezoneOffset()),"dayend"===t&&(l.setHours(l.getHours()+24),l.setSeconds(l.getSeconds()-1)),l.getTime()}catch(t){return e}}(u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate());var s=c({},i,{edcrDetail:[c({},r)]});return Promise.resolve(Digit.PaymentService.generatePdf(null==i?void 0:i.tenantId,{Bpa:[s]},e)).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(null==i?void 0:i.tenantId,{fileStoreIds:e.filestoreIds[0]})).then(function(n){var l;return window.open(n[null==e?void 0:e.filestoreIds[0]],"_blank"),s.applicationType=null==i||null===(l=i.additionalDetails)||void 0===l?void 0:l.applicationType,Promise.resolve(Digit.OBPSService.edcr_report_download({BPA:c({},s)})).then(function(e){var n,l,a,o=parseInt(e.status,10);201!==o&&200!==o||("print"==t?(n=new Blob([e.data],{type:"application/pdf"}),l=URL.createObjectURL(n),null!=(a=window.open(l))&&a.addEventListener("load",function(e){a.focus(),a.print()})):function(e,t){if(window.mSewaApp&&window.mSewaApp.isMsewaApp()&&window.mSewaApp.downloadBase64File){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){mSewaApp.downloadBase64File(n.result,"edcrReport.pdf")}}else{var l=document.createElement("a");l.href=URL.createObjectURL(e),l.download="edcrReport.pdf",document.body.append(l),l.click(),l.remove(),setTimeout(function(){return URL.revokeObjectURL(l.href)},7e3)}}(new Blob([e.data],{type:"application/pdf"})))})})})})})}catch(e){return Promise.reject(e)}};if(K)Ce="CITIZEN_SUCCESS_UC_PAYMENT_MESSAGE";else if(null!=Me&&null!==(ge=Me.paymentDetails)&&void 0!==ge&&null!==(Pe=ge[0])&&void 0!==Pe&&Pe.businessService&&null!=Me&&null!==(Te=Me.paymentDetails)&&void 0!==Te&&null!==(De=Te[0])&&void 0!==De&&null!==(Oe=De.businessService)&&void 0!==Oe&&Oe.includes("BPA")){var Re,ke=sessionStorage.getItem("BPA_ARCHITECT_NAME"),xe=ke?JSON.parse(ke):"ARCHITECT";Ce="CITIZEN_SUCCESS_"+(null==Me||null===(Re=Me.paymentDetails[0])||void 0===Re?void 0:Re.businessService.replace(/\./g,"_"))+"_"+xe+"_PAYMENT_MESSAGE"}else if(null!=te&&te.includes("WS")||null!=te&&te.includes("SW"))Ce=W("CITIZEN_SUCCESS_"+(null==Me?void 0:Me.paymentDetails[0].businessService.replace(/\./g,"_"))+"_WS_PAYMENT_MESSAGE");else{var Be,Fe;Ce=null!=Me&&null!==(Be=Me.paymentDetails[0])&&void 0!==Be&&Be.businessService?"CITIZEN_SUCCESS_"+(null==Me||null===(Fe=Me.paymentDetails[0])||void 0===Fe?void 0:Fe.businessService.replace(/\./g,"_"))+"_PAYMENT_MESSAGE":W("CITIZEN_SUCCESS_UC_PAYMENT_MESSAGE")}var Ue,Ye,He,je,We,Ve,ze={padding:"4px 0px",justifyContent:"space-between"},Ge=["PT"].includes(te);return(window.location.href.includes("bpa")||window.location.href.includes("BPA"))&&re?l.createElement(t.Loader,null):l.createElement(t.Card,null,l.createElement(t.Banner,{svg:l.createElement("svg",{className:"payment-svg",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},l.createElement("path",{d:"M20 0C8.96 0 0 8.96 0 20C0 31.04 8.96 40 20 40C31.04 40 40 31.04 40 20C40 8.96 31.04 0 20 0ZM16 30L6 20L8.82 17.18L16 24.34L31.18 9.16L34 12L16 30Z",fill:"white"})),message:W("CS_COMMON_PAYMENT_COMPLETE"),info:W("CS_COMMON_RECIEPT_NO"),applicationNumber:null==Me?void 0:Me.paymentDetails[0].receiptNumber,successful:!0}),l.createElement(t.CardText,null,W(Ce+"_DETAIL")),l.createElement(t.StatusTable,null,l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W(me),text:he}),("PT"===te||K)&&l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W("CS_PAYMENT_BILLING_PERIOD"),text:(Ue=null==Ee||null===(f=Ee.paymentDetails[0])||void 0===f||null===(p=f.bill)||void 0===p?void 0:p.billDetails[0],Ye=Ue||{},He=Ye.taxPeriodFrom,je=Ye.taxPeriodTo,We=Ye.fromPeriod,Ve=Ye.toPeriod,He&&je?"FY "+new Date(He).getFullYear().toString()+"-"+new Date(je).getFullYear().toString():We&&Ve?"mcollect"===K?new Date(We).getDate().toString()+" "+Digit.Utils.date.monthNames[new Date(We).getMonth()].toString()+" "+new Date(We).getFullYear().toString()+" - "+new Date(Ve).getDate()+" "+Digit.Utils.date.monthNames[new Date(Ve).getMonth()]+" "+new Date(Ve).getFullYear():"WNS"===K?new Date(We).getDate().toString()+"/"+(new Date(We).getMonth()+1).toString()+"/"+new Date(We).getFullYear().toString()+" - "+new Date(Ve).getDate()+"/"+(new Date(Ve).getMonth()+1)+"/"+new Date(Ve).getFullYear():"FY "+new Date(We).getFullYear().toString()+"-"+new Date(Ve).getFullYear().toString():"N/A")}),("PT"===te||K)&&l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W("CS_PAYMENT_AMOUNT_PENDING"),text:null!=Ee&&null!==(_=Ee.paymentDetails)&&void 0!==_&&null!==(y=_[0])&&void 0!==y&&y.totalDue&&null!=Ee&&null!==(S=Ee.paymentDetails)&&void 0!==S&&null!==(N=S[0])&&void 0!==N&&N.totalAmountPaid?"₹ "+((null==Ee||null===(b=Ee.paymentDetails)||void 0===b||null===(h=b[0])||void 0===h?void 0:h.totalDue)-(null==Ee||null===(A=Ee.paymentDetails)||void 0===A||null===(C=A[0])||void 0===C?void 0:C.totalAmountPaid)):"₹ 0"}),l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W("CS_PAYMENT_TRANSANCTION_ID"),text:G}),l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W(Ge?"CS_PAYMENT_AMOUNT_PAID_WITHOUT_SYMBOL":"CS_PAYMENT_AMOUNT_PAID"),text:null!=Ee&&null!==(g=Ee.paymentDetails)&&void 0!==g&&null!==(P=g[0])&&void 0!==P&&P.totalAmountPaid?"₹ "+(null==Ee||null===(T=Ee.paymentDetails)||void 0===T||null===(D=T[0])||void 0===D?void 0:D.totalAmountPaid):"₹ 0"}),("PT"!==te||K)&&l.createElement(t.Row,{rowContainerStyle:ze,last:!0,label:W("CS_PAYMENT_TRANSANCTION_DATE"),text:Le&&new Date(Le).toLocaleDateString("in")})),l.createElement("div",{style:{display:"flex"}},"TL"==te?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginRight:"20px",marginTop:"15px",marginBottom:"15px"},onClick:we},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#f47738"},l.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"})),W("TL_RECEIPT")):null,"TL"==te?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginTop:"15px"},onClick:function(){try{var e=le;return Promise.resolve(Digit.TLService.search({applicationNumber:ne,tenantId:le})).then(function(t){var n=function(){if(t)return Promise.resolve(Digit.PaymentService.generatePdf(e,{Licenses:null==t?void 0:t.Licenses},"tlcertificate")).then(function(t){return Promise.resolve(Digit.PaymentService.printReciept(e,{fileStoreIds:t.filestoreIds[0]})).then(function(e){window.open(e[t.filestoreIds[0]],"_blank")})})}();if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#f47738"},l.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"})),W("TL_CERTIFICATE")):null,"BPA_OC"!==(null==ie||null===(O=ie[0])||void 0===O?void 0:O.businessService)||"APPROVED"!==(null==ie||null===(M=ie[0])||void 0===M?void 0:M.status)&&"PENDING_SANC_FEE_PAYMENT"!==(null==ie||null===(L=ie[0])||void 0===L?void 0:L.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return Ie("occupancy-certificate")}},l.createElement(t.DownloadPrefixIcon,null),W("BPA_OC_CERTIFICATE")),"BPA_LOW"===(null==ie||null===(w=ie[0])||void 0===w?void 0:w.businessService)?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return Ie("buildingpermit-low")}},l.createElement(t.DownloadPrefixIcon,null),W("BPA_PERMIT_ORDER")):null,"BPA"!==(null==ie||null===(I=ie[0])||void 0===I?void 0:I.businessService)||"BPA_LOW"===(null==ie||null===(R=ie[0])||void 0===R?void 0:R.businessService)||"BPA_OC"===(null==ie||null===(k=ie[0])||void 0===k?void 0:k.businessService)||"PENDING_SANC_FEE_PAYMENT"!==(null==ie||null===(x=ie[0])||void 0===x?void 0:x.status)&&"APPROVED"!==(null==ie||null===(B=ie[0])||void 0===B?void 0:B.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return Ie("buildingpermit")}},l.createElement(t.DownloadPrefixIcon,null),W("BPA_PERMIT_ORDER"))),(null==te?void 0:te.includes("PT"))&&l.createElement("div",{style:{marginTop:"10px"}},l.createElement(o.Link,{to:"/"+(null===(F=window)||void 0===F?void 0:F.contextPath)+"/citizen/feedback?redirectedFrom=/"+(null===(U=window)||void 0===U?void 0:U.contextPath)+"/citizen/payment/success&propertyId="+(ne||"")+"&acknowldgementNumber="+(G||"")+"&tenantId="+le+"&creationReason="+(null==te||null===(Y=te.split("."))||void 0===Y?void 0:Y[1])},l.createElement(t.SubmitBar,{label:W("CS_REVIEW_AND_FEEDBACK")}))),null!=te&&te.includes("PT")?l.createElement("div",{className:"link",style:Ae?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"},onClick:we},W("CS_DOWNLOAD_RECEIPT")):null,!("TL"==te)||!(null!=te&&te.includes("PT"))&&l.createElement(t.SubmitBar,{onSubmit:we,label:W("COMMON_DOWNLOAD_RECEIPT")}),!("TL"==te)||!(null!=te&&te.includes("PT"))&&l.createElement("div",{className:"link",style:Ae?{marginTop:"8px",width:"100%",textAlign:"center"}:{marginTop:"8px"}},l.createElement(o.Link,{to:"/"+(null===(H=window)||void 0===H?void 0:H.contextPath)+"/citizen"},W("CORE_COMMON_GO_TO_HOME"))),"TL"==te&&l.createElement(o.Link,{to:"/"+(null===(j=window)||void 0===j?void 0:j.contextPath)+"/citizen"},l.createElement(t.SubmitBar,{label:W("CORE_COMMON_GO_TO_HOME")})))},M=function(e){var n=a.useTranslation().t,i=o.useParams();return l.createElement(t.Card,null,l.createElement(t.Banner,{message:"Failure !",complaintNumber:i.consumerCode,successful:!1}),l.createElement(t.CardText,null,n("ES_COMMON_TRACK_COMPLAINT_TEXT")))},L=function(e){var t=e.stateCode,n=e.cityCode,a=e.moduleCode,i=o.useRouteMatch().path,r={stateCode:t,cityCode:n,moduleCode:a};return l.createElement(l.Fragment,null,l.createElement("div",{className:"bills-citizen-wrapper"},l.createElement(o.Switch,null,l.createElement(o.Route,{path:i+"/my-bills/:businessService"},l.createElement(g,{stateCode:t})),l.createElement(o.Route,{path:i+"/billDetails/:businessService/:consumerCode/:paymentAmt"},l.createElement(E,c({},r,{stateCode:t,basePath:i}))),l.createElement(o.Route,{path:i+"/collect/:businessService/:consumerCode"},l.createElement(T,c({},r,{stateCode:t,basePath:i}))),l.createElement(o.Route,{path:i+"/success/:businessService/:consumerCode/:tenantId"},l.createElement(D,r)),l.createElement(o.Route,{path:i+"/failure"},l.createElement(M,r)))))},w=function(e){var o,i,r,u=c({},(s(e),e)),d=a.useTranslation().t,m=n.useState(null==u||null===(o=u.value)||void 0===o?void 0:o.manualReceiptDate),v=m[0],E=m[1],f=n.useState(null==u||null===(i=u.value)||void 0===i?void 0:i.manualReceiptNumber),p=f[0],_=f[1],y=null===(r=window)||void 0===r?void 0:r.location.pathname.includes("FSM");return n.useEffect(function(){if(u.onChange){var e={};v||(e.manualReceiptDate="ES_COMMON_MANUAL_RECEIPT_DATE"),p||(e.manualReceiptNumber="ES_COMMON_MANUAL_RECEIPT_NO"),u.onChange({manualReceiptNumber:p,manualReceiptDate:v,errorObj:e})}},[v,p]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},d("NOC_PAYMENT_RCPT_NO_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:p,type:"text",name:"instrumentNumber",onChange:function(e){return _(e.target.value)}})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},d("NOC_PAYMENT_RECEIPT_ISSUE_DATE_LABEL")," "),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement(t.DatePicker,{date:v,onChange:function(e){E(e)},min:y?Digit.Utils.date.getDate(Date.now()-2592e6):null,max:y?Digit.Utils.date.getDate():null})))))},I=function(e){var t,o,i,r,u=c({},(s(e),e)),d=a.useTranslation().t,m=n.useState(null==u||null===(t=u.value)||void 0===t?void 0:t.last4Digits),v=m[0],E=m[1],f=n.useState(null==u||null===(o=u.value)||void 0===o?void 0:o.transactionNumber),p=f[0],_=f[1],y=n.useState(null==u||null===(i=u.value)||void 0===i?void 0:i.reTransanctionNumber),S=y[0],N=y[1],b=null===(r=window)||void 0===r?void 0:r.location.pathname.includes("FSM");return n.useEffect(function(){if(u.onChange){var e={};v||(e.last4Digits="ES_COMMON_LAST_4_DIGITS"),p||(e.transactionNumber="ES_COMMON_TRANSANCTION_NO"),S||(e.reTransanctionNumber="ES_COMMON_RE_TRANSANCTION_NO"),u.onChange({transactionNumber:p,reTransanctionNumber:S,instrumentNumber:v,errorObj:e})}},[v,p,S]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},d("NOC_PAYMENT_CARD_LAST_DIGITS_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:v,type:"text",name:"instrumentNumber",maxLength:"4",minLength:"4",pattern:b?"^[0-9]+$":null,required:!0,onChange:function(e){return E(e.target.value)}})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},d("NOC_PAYMENT_TRANS_NO_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:p,type:"text",name:"instrumentNumber",required:!0,onChange:function(e){return _(e.target.value)}})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},d("NOC_PAYMENT_RENTR_TRANS_LABEL")+" *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:S,type:"text",name:"instrumentNumber",required:!0,onChange:function(e){return N(e.target.value)}})))))},R=function(e){var o,i,r=a.useTranslation().t,u=n.useState(e.chequeDetails.instrumentDate),c=u[0],s=u[1],d=n.useState(e.chequeDetails.instrumentNumber),m=d[0],v=d[1],E=n.useState(e.chequeDetails.ifscCode),f=E[0],p=E[1],_=n.useState(""),y=_[0],S=_[1],N=n.useState(e.chequeDetails.bankName),b=N[0],h=N[1],A=n.useState(null===(o=e.chequeDetails.bankBranch)||void 0===o?void 0:o.replace("┬á"," ")),C=A[0],g=A[1],T=null===(i=window)||void 0===i?void 0:i.location.pathname.includes("FSM");return n.useEffect(function(){if(e.onChange){var t={};c||(t.instrumentDate="ES_COMMON_INSTRUMENT_DATE"),m||(t.instrumentNumber="ES_COMMON_INSTR_NUMBER"),f||(t.ifscCode="ES_COMMON_IFSC"),e.onChange({instrumentDate:c,instrumentNumber:m,ifscCode:f,bankName:b,bankBranch:C,errorObj:t,transactionNumber:m})}},[b,C,c,m]),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},r("PAYMENT_CHQ_NO_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:m,type:"text",name:"instrumentNumber",onChange:function(e){return v(e.target.value)},required:!0,pattern:T?"^[0-9]+$":null,minlength:T?"6":null,maxlength:T?"6":null})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},r("PAYMENT_CHEQUE_DATE_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement(t.DatePicker,{isRequired:!0,date:c,onChange:function(e){s(e)}})))),l.createElement(l.Fragment,null,l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},r("PAYMENT_IFSC_CODE_LABEL")," *"),l.createElement("div",{className:"field"},l.createElement("div",null,l.createElement("div",{className:"cheque-date"},l.createElement("input",{value:f,type:"text",onChange:function(e){p(e.target.value),S("")},minlength:"11",maxlength:"11",required:!0}),l.createElement("button",{type:"button",onClick:function(){try{var e=P(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/"+f)).then(function(e){var t=function(){if(e.ok)return Promise.resolve(e.json()).then(function(e){var t=e.BRANCH;h(e.BANK),g(null==t?void 0:t.replace("┬á"," "))});S(r("CS_PAYMENT_INCORRECT_IFSC_CODE_ERROR"))}();if(t&&t.then)return t.then(function(){})})},function(){S(r("CS_PAYMENT_INCORRECT_IFSC_CODE_ERROR"))});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}},l.createElement(t.SearchIconSvg,null)))))),y&&l.createElement(t.CardLabelError,{style:{width:"70%",marginLeft:"30%",fontSize:"12px",marginTop:"-21px"}},y),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},r("PAYMENT_BANK_NAME_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:b,type:"text",readOnly:!0,disabled:!0})))),l.createElement("div",{className:"label-field-pair"},l.createElement("h2",{className:"card-label"},r("PAYMENT_BANK_BRANCH_LABEL")),l.createElement("div",{className:"field"},l.createElement("div",{className:"field-container"},l.createElement("input",{className:"employee-card-input",value:C,type:"text",readOnly:!0,disabled:!0}))))))},k=function(e,t){return e===t||e!=e&&t!=t},x=function(e,t){for(var n=e.length;n--;)if(k(e[n][0],t))return n;return-1},B=Array.prototype.splice;function F(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}F.prototype.clear=function(){this.__data__=[],this.size=0},F.prototype.delete=function(e){var t=this.__data__,n=x(t,e);return!(n<0||(n==t.length-1?t.pop():B.call(t,n,1),--this.size,0))},F.prototype.get=function(e){var t=this.__data__,n=x(t,e);return n<0?void 0:t[n][1]},F.prototype.has=function(e){return x(this.__data__,e)>-1},F.prototype.set=function(e,t){var n=this.__data__,l=x(n,e);return l<0?(++this.size,n.push([e,t])):n[l][1]=t,this};var U=F,Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function H(e,t){return e(t={exports:{}},t.exports),t.exports}var j,W="object"==typeof Y&&Y&&Y.Object===Object&&Y,V="object"==typeof self&&self&&self.Object===Object&&self,z=W||V||Function("return this")(),G=z.Symbol,K=Object.prototype,q=K.hasOwnProperty,Q=K.toString,Z=G?G.toStringTag:void 0,$=Object.prototype.toString,X=G?G.toStringTag:void 0,J=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":X&&X in Object(e)?function(e){var t=q.call(e,Z),n=e[Z];try{e[Z]=void 0;var l=!0}catch(e){}var a=Q.call(e);return l&&(t?e[Z]=n:delete e[Z]),a}(e):function(e){return $.call(e)}(e)},ee=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},te=function(e){if(!ee(e))return!1;var t=J(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},ne=z["__core-js_shared__"],le=(j=/[^.]+$/.exec(ne&&ne.keys&&ne.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",ae=Function.prototype.toString,oe=function(e){if(null!=e){try{return ae.call(e)}catch(e){}try{return e+""}catch(e){}}return""},ie=/^\[object .+?Constructor\]$/,re=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ue=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!ee(e)||(t=e,le&&le in t))&&(te(e)?re:ie).test(oe(e));var t}(n)?n:void 0},ce=ue(z,"Map"),se=ue(Object,"create"),de=Object.prototype.hasOwnProperty,me=Object.prototype.hasOwnProperty;function ve(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}ve.prototype.clear=function(){this.__data__=se?se(null):{},this.size=0},ve.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ve.prototype.get=function(e){var t=this.__data__;if(se){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return de.call(t,e)?t[e]:void 0},ve.prototype.has=function(e){var t=this.__data__;return se?void 0!==t[e]:me.call(t,e)},ve.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=se&&void 0===t?"__lodash_hash_undefined__":t,this};var Ee=ve,fe=function(e,t){var n,l,a=e.__data__;return("string"==(l=typeof(n=t))||"number"==l||"symbol"==l||"boolean"==l?"__proto__"!==n:null===n)?a["string"==typeof t?"string":"hash"]:a.map};function pe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var l=e[t];this.set(l[0],l[1])}}pe.prototype.clear=function(){this.size=0,this.__data__={hash:new Ee,map:new(ce||U),string:new Ee}},pe.prototype.delete=function(e){var t=fe(this,e).delete(e);return this.size-=t?1:0,t},pe.prototype.get=function(e){return fe(this,e).get(e)},pe.prototype.has=function(e){return fe(this,e).has(e)},pe.prototype.set=function(e,t){var n=fe(this,e),l=n.size;return n.set(e,t),this.size+=n.size==l?0:1,this};var _e=pe;function ye(e){var t=this.__data__=new U(e);this.size=t.size}ye.prototype.clear=function(){this.__data__=new U,this.size=0},ye.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ye.prototype.get=function(e){return this.__data__.get(e)},ye.prototype.has=function(e){return this.__data__.has(e)},ye.prototype.set=function(e,t){var n=this.__data__;if(n instanceof U){var l=n.__data__;if(!ce||l.length<199)return l.push([e,t]),this.size=++n.size,this;n=this.__data__=new _e(l)}return n.set(e,t),this.size=n.size,this};var Se=ye;function Ne(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _e;++t<n;)this.add(e[t])}Ne.prototype.add=Ne.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ne.prototype.has=function(e){return this.__data__.has(e)};var be=Ne,he=function(e,t){for(var n=-1,l=null==e?0:e.length;++n<l;)if(t(e[n],n,e))return!0;return!1},Ae=function(e,t,n,l,a,o){var i=1&n,r=e.length,u=t.length;if(r!=u&&!(i&&u>r))return!1;var c=o.get(e),s=o.get(t);if(c&&s)return c==t&&s==e;var d=-1,m=!0,v=2&n?new be:void 0;for(o.set(e,t),o.set(t,e);++d<r;){var E=e[d],f=t[d];if(l)var p=i?l(f,E,d,t,e,o):l(E,f,d,e,t,o);if(void 0!==p){if(p)continue;m=!1;break}if(v){if(!he(t,function(e,t){if(!v.has(t)&&(E===e||a(E,e,n,l,o)))return v.push(t)})){m=!1;break}}else if(E!==f&&!a(E,f,n,l,o)){m=!1;break}}return o.delete(e),o.delete(t),m},Ce=z.Uint8Array,ge=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,l){n[++t]=[l,e]}),n},Pe=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},Te=G?G.prototype:void 0,De=Te?Te.valueOf:void 0,Oe=Array.isArray,Me=Object.prototype.propertyIsEnumerable,Le=Object.getOwnPropertySymbols,we=Le?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var l=-1,a=null==t?0:t.length,o=0,i=[];++l<a;){var r=t[l];Me.call(e,r)&&(i[o++]=r)}return i}(Le(e)))}:function(){return[]},Ie=function(e){return null!=e&&"object"==typeof e},Re=function(e){return Ie(e)&&"[object Arguments]"==J(e)},ke=Object.prototype,xe=ke.hasOwnProperty,Be=ke.propertyIsEnumerable,Fe=Re(function(){return arguments}())?Re:function(e){return Ie(e)&&xe.call(e,"callee")&&!Be.call(e,"callee")},Ue=function(){return!1},Ye=H(function(e,t){var n=t&&!t.nodeType&&t,l=n&&e&&!e.nodeType&&e,a=l&&l.exports===n?z.Buffer:void 0;e.exports=(a?a.isBuffer:void 0)||Ue}),He=/^(?:0|[1-9]\d*)$/,je=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&He.test(e))&&e>-1&&e%1==0&&e<t},We=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Ve={};Ve["[object Float32Array]"]=Ve["[object Float64Array]"]=Ve["[object Int8Array]"]=Ve["[object Int16Array]"]=Ve["[object Int32Array]"]=Ve["[object Uint8Array]"]=Ve["[object Uint8ClampedArray]"]=Ve["[object Uint16Array]"]=Ve["[object Uint32Array]"]=!0,Ve["[object Arguments]"]=Ve["[object Array]"]=Ve["[object ArrayBuffer]"]=Ve["[object Boolean]"]=Ve["[object DataView]"]=Ve["[object Date]"]=Ve["[object Error]"]=Ve["[object Function]"]=Ve["[object Map]"]=Ve["[object Number]"]=Ve["[object Object]"]=Ve["[object RegExp]"]=Ve["[object Set]"]=Ve["[object String]"]=Ve["[object WeakMap]"]=!1;var ze,Ge=H(function(e,t){var n=t&&!t.nodeType&&t,l=n&&e&&!e.nodeType&&e,a=l&&l.exports===n&&W.process,o=function(){try{return l&&l.require&&l.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o}),Ke=Ge&&Ge.isTypedArray,qe=Ke?(ze=Ke,function(e){return ze(e)}):function(e){return Ie(e)&&We(e.length)&&!!Ve[J(e)]},Qe=Object.prototype.hasOwnProperty,Ze=Object.prototype,$e=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Xe=Object.prototype.hasOwnProperty,Je=function(e){return function(e,t,n){var l=function(e){return null!=(t=e)&&We(t.length)&&!te(t)?function(e,t){var n=Oe(e),l=!n&&Fe(e),a=!n&&!l&&Ye(e),o=!n&&!l&&!a&&qe(e),i=n||l||a||o,r=i?function(e,t){for(var n=-1,l=Array(e);++n<e;)l[n]=t(n);return l}(e.length,String):[],u=r.length;for(var c in e)!Qe.call(e,c)||i&&("length"==c||a&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||je(c,u))||r.push(c);return r}(e):function(e){if((t=e)!==("function"==typeof(n=t&&t.constructor)&&n.prototype||Ze))return $e(e);var t,n,l=[];for(var a in Object(e))Xe.call(e,a)&&"constructor"!=a&&l.push(a);return l}(e);var t}(e);return Oe(e)?l:function(e,t){for(var n=-1,l=t.length,a=e.length;++n<l;)e[a+n]=t[n];return e}(l,n(e))}(e,0,we)},et=Object.prototype.hasOwnProperty,tt=ue(z,"DataView"),nt=ue(z,"Promise"),lt=ue(z,"Set"),at=ue(z,"WeakMap"),ot=oe(tt),it=oe(ce),rt=oe(nt),ut=oe(lt),ct=oe(at),st=J;(tt&&"[object DataView]"!=st(new tt(new ArrayBuffer(1)))||ce&&"[object Map]"!=st(new ce)||nt&&"[object Promise]"!=st(nt.resolve())||lt&&"[object Set]"!=st(new lt)||at&&"[object WeakMap]"!=st(new at))&&(st=function(e){var t=J(e),n="[object Object]"==t?e.constructor:void 0,l=n?oe(n):"";if(l)switch(l){case ot:return"[object DataView]";case it:return"[object Map]";case rt:return"[object Promise]";case ut:return"[object Set]";case ct:return"[object WeakMap]"}return t});var dt=st,mt=Object.prototype.hasOwnProperty,vt=function(e,t){return{PT:[{head:t("ES_BILL_DETAILS_PT_DETAILS_HEADING"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"PT",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],mcollect:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],"PT.MUTATION":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],TL:[{body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"TL",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],WS:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"WS",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],"WS.ONE_TIME_FEE":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"WS.ONE_TIME_FEE",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],"SW.ONE_TIME_FEE":[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"SW.ONE_TIME_FEE",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],SW:[{head:t("COMMON_PAY_SCREEN_HEADER"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:"SW",consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}],FSM:[{head:t("ES_TITLE_PAYMENT_DETAILS"),body:[{withoutLabel:!0,type:"custom",populators:{name:"amount",customProps:{businessService:e.businessService,consumerCode:e.consumerCode},component:function(e,t){return l.createElement(Et,c({onChange:e.onChange,amount:e.value},t))}}}]}]}},Et=function(e){var o,i,r,u,s,d,m,v=e.businessService,E=e.consumerCode,f=e.onChange,p=a.useTranslation().t,_=Digit.Hooks.useQueryParams(),y=_.workflow,S=_.IsDisconnectionFlow,N=Digit.ULBService.getCurrentTenantId(),b=Digit.Hooks.useFetchPayment({tenantId:N,businessService:v,consumerCode:E}),h=b.data,A=b.isLoading,C=window.location.href.includes("FSM"),g=Digit.Hooks.fsm.useSearch(N,{applicationNos:E},{staleTime:Infinity,enabled:!(null==v||null===(o=v.toUpperCase())||void 0===o||!o.includes("FSM"))}).data,P=n.useState(),T=P[0],D=P[1],O=n.useState(!0),M=O[0],L=O[1],w=Digit.Hooks.fsm.useApplicationDetail(p,N,E,{enabled:!!C},"EMPLOYEE").data,I=null==T||null===(i=T.billDetails)||void 0===i?void 0:i.sort(function(e,t){return t.fromPeriod-e.fromPeriod}),R=(null==I?void 0:I[0])||[],k=function(){return null!=T&&T.totalAmount?null==T?void 0:T.totalAmount:0},x=function(){return null!=g&&g.advanceAmount?null==g?void 0:g.advanceAmount:0},B=(null==T||null===(r=T.billDetails)||void 0===r||null===(u=r.sort(function(e,t){return t.fromPeriod-e.fromPeriod}))||void 0===u?void 0:u.reduce(function(e,t,n){return 0===n?e:e+t.amount},0))||0,F=Digit.Hooks.useGetPaymentRulesForBusinessServices(N),U=F.isLoading,Y=F.data,H=n.useState(),j=H[0],W=H[1];n.useEffect(function(){var e,t,n=null==Y||null===(e=Y.MdmsRes)||void 0===e||null===(t=e.BillingService)||void 0===t?void 0:t.BusinessService;W(null!=n&&n.length?S?c({},n.filter(function(e){return e.code==v})[0],{partPaymentAllowed:!1}):n.filter(function(e){return e.code==v})[0]:{})},[Y]);var V=j||{},z=V.minAmountPayable,G=V.isAdvanceAllowed,K=n.useState(p("CS_PAYMENT_FULL_AMOUNT")),q=K[0],Q=K[1],Z=n.useState(k()),$=Z[0],X=Z[1],J=n.useState(!0),ee=J[0],te=J[1],ne=n.useState(""),le=ne[0],ae=ne[1],oe=function(e){X(e)};n.useEffect(function(){"mcollect"===y&&(null==R?void 0:R.billAccountDetails)&&(null==R||R.billAccountDetails.map(function(e){e.taxHeadCode.includes("CGST")?e.order=3:e.taxHeadCode.includes("SGST")&&(e.order=4)}))},[null==R?void 0:R.billAccountDetails]),n.useEffect(function(){var e=z&&$>=z&&$<=k()&&!le;("WS"===v||"SW"===v)&&$>k()&&G&&(e=z&&$>=z&&!le),q!=p("CS_PAYMENT_FULL_AMOUNT")?te(e):te(!0)},[q,$]),n.useEffect(function(){if(!T&&h){var e=h.Bill.filter(function(e){return e.consumerCode==E})[0];D(e)}},[h]),n.useEffect(function(){q!==p("CS_PAYMENT_FULL_AMOUNT")?ie($.toString()):(ae(""),oe(k()))},[q,T]),n.useEffect(function(){q!==p("CS_PAYMENT_FULL_AMOUNT")?f({amount:$,paymentAllowed:ee,error:le,minAmountPayable:z}):f({amount:k(),paymentAllowed:!0,error:le,minAmountPayable:z})},[ee,le,$,q]);var ie=function(e){ae(""),isNaN(e)||e.includes(".")?ae("AMOUNT_INVALID"):!G&&e>k()?ae("CS_ADVANCED_PAYMENT_NOT_ALLOWED"):e<z&&ae("CS_CANT_PAY_BELOW_MIN_AMOUNT"),oe(e)};if(A||U)return l.createElement(t.Loader,null);var re,ue,ce,se,de,me,ve,Ee={textAlign:"left",borderBottom:"#D6D5D4 1px solid",padding:"16px 12px",whiteSpace:"break-spaces"},fe={textAlign:"left",borderBottom:"#D6D5D4 1px solid",padding:"8px 10px",breakWord:"no-break"},pe="DSO_INPROGRESS"===(null==g?void 0:g.applicationStatus);return l.createElement(l.Fragment,null,l.createElement(t.StatusTable,null,!C&&T&&{PT:{heading:"ES_BILL_DETAILS_PT_DETAILS_HEADING",details:[{keyValue:"PT_PROPERTY_ID",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",function(e){var t=e[0],n=t.fromPeriod,l=t.toPeriod;return n&&l?"FY "+new Date(n).getFullYear().toString()+"-"+new Date(l).getFullYear().toString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billDetails",function(e){return e[0].currentBillNo||"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",function(e){var t=e[0].currentExpiryDate;return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},mcollect:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"UC_CHALLAN_NO",keyPath:["consumerCode"],fallback:""}]},"PT.MUTATION":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"PDF_STATIC_LABEL_MUATATION_NUMBER_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_BILL_NO",keyPath:["billDetails",function(e){return e[0].currentBillNo||"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",function(e){var t=e[0].currentExpiryDate;return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},TL:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"TL_TRADE_LICENSE_LABEL",keyPath:["consumerCode"],fallback:""}]},"WS.ONE_TIME_FEE":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_APP_NO_LABEL",keyPath:["consumerCode"],fallback:""}]},"SW.ONE_TIME_FEE":{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_APP_NO_LABEL",keyPath:["consumerCode"],fallback:""}]},WS:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_COL_CONSUMER_NO_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",function(e){var t=e[0],n=t.fromPeriod,l=t.toPeriod;return n&&l?new Date(n).toLocaleDateString()+" - "+new Date(l).toLocaleDateString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billNumber"],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",function(e){var t=e[0].currentExpiryDate;return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},SW:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"WS_COMMON_TABLE_COL_CONSUMER_NO_LABEL",keyPath:["consumerCode"],fallback:""},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",function(e){var t=e[0],n=t.fromPeriod,l=t.toPeriod;return n&&l?new Date(n).toLocaleDateString()+" - "+new Date(l).toLocaleDateString():"N/A"}],fallback:"N/A"},{keyValue:"CS_BILL_NO",keyPath:["billNumber"],fallback:"N/A"},{keyValue:"CS_BILL_DUEDATE",keyPath:["billDetails",function(e){var t=e[0].expiryDate;return t?new Date(t).toLocaleDateString():"N/A"}],fallback:"N/A"}]},FSM:{heading:"COMMON_PAY_SCREEN_HEADER",details:[{keyValue:"ADV_TOTAL_AMOUNT",keyPath:["totalAmount"],fallback:""},{keyValue:"ADV_COLLECTION",keyPath:["totalAmountPaid"],fallback:"N/A"}]}}[y||v].details.map(function(e,n){var a=e.keyPath.reduce(function(e,t){return"function"==typeof t?t(e):e[t]},T);return l.createElement(t.Row,{key:n+"bill",label:p(e.keyValue),text:a})})),C?l.createElement(t.StatusTable,null,l.createElement(t.Row,{label:p("ES_PAYMENT_DETAILS_AMOUNT_PER_TRIP"),textStyle:{textAlign:"left"},text:"₹ "+Number(null!=w&&null!==(me=w.additionalDetails)&&void 0!==me&&me.tripAmount?null==w||null===(ve=w.additionalDetails)||void 0===ve?void 0:ve.tripAmount:0).toFixed(2)}),l.createElement(t.Row,{label:p("ES_PAYMENT_DETAILS_TOTAL_AMOUNT"),textStyle:{textAlign:"left"},text:null!=g&&g.paymentPreference?"₹ "+Number(null==T?void 0:T.totalAmount).toFixed(2):"₹ "+Number(null!=w&&w.totalAmount?null==w?void 0:w.totalAmount:0).toFixed(2)}),!(null!=g&&g.paymentPreference)&&l.createElement(t.Row,pe?{label:p("ES_PAYMENT_DETAILS_ADV_AMOUNT_PAID"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"₹ "+Number(x()).toFixed(2)}:{label:p("ES_PAYMENT_DETAILS_ADV_AMOUNT_DUE"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"₹ "+Number(x()).toFixed(2)}),"PENDING_APPL_FEE_PAYMENT"!==(null==g?void 0:g.applicationStatus)?l.createElement(t.Row,{label:p("FSM_DUE_AMOUNT_TO_BE_PAID"),textStyle:{fontWeight:"bold",textAlign:"left"},text:"₹ "+Number(null!=T&&T.totalAmount?null==T?void 0:T.totalAmount:0).toFixed(2)}):null):l.createElement(t.StatusTable,{style:{paddingTop:"46px"}},l.createElement(t.Row,{label:p("ES_PAYMENT_TAXHEADS"),textStyle:{fontWeight:"bold"},text:p("ES_PAYMENT_AMOUNT")}),l.createElement("hr",{style:{width:"40%"},className:"underline"}),null==R||null===(s=R.billAccountDetails)||void 0===s?void 0:s.sort(function(e,t){return e.order-t.order}).map(function(e,n){var a;return l.createElement(t.Row,{key:n+"taxheads",labelStyle:{fontWeight:"normal"},textStyle:{textAlign:"right",maxWidth:"100px"},label:p(e.taxHeadCode),text:"₹ "+(null===(a=e.amount)||void 0===a?void 0:a.toFixed(2))})}),null!=B&&null!==(d=B.toFixed)&&void 0!==d&&d.call(B,2)?l.createElement(t.Row,{labelStyle:{fontWeight:"normal"},textStyle:{textAlign:"right",maxWidth:"100px"},label:p("COMMON_ARREARS"),text:"₹ "+(null==B||null===(m=B.toFixed)||void 0===m?void 0:m.call(B,2))||Number(0).toFixed(2)}):null,l.createElement("hr",{style:{width:"40%"},className:"underline"}),l.createElement(t.Row,{label:p("CS_PAYMENT_TOTAL_AMOUNT"),textStyle:{fontWeight:"bold",textAlign:"right",maxWidth:"100px"},text:"₹ "+Number(k()).toFixed(2)}),!M&&!y&&"TL"!==v&&(null==I?void 0:I.length)>1&&l.createElement(n.Fragment,null,l.createElement("div",{className:"row last"},l.createElement("div",{style:{maxWidth:"100px"},onClick:function(){return L(!0)},className:"filter-button value"},p("ES_COMMON_VIEW_DETAILS"))))),M&&(null==I?void 0:I.length)>1&&!y&&"TL"!==v&&l.createElement(l.Fragment,null,l.createElement("div",{style:{maxWidth:"95%",display:"inline-block",textAlign:"right"}},l.createElement("div",{style:{display:"flex",padding:"10px",paddingLeft:"unset",maxWidth:"95%"}},l.createElement("div",{style:{backgroundColor:"#EEEEEE",overflowX:"auto"}},l.createElement("table",{className:"table-fixed-column-common-pay"},l.createElement("thead",null,l.createElement("tr",null,l.createElement("th",{style:Ee},p("CS_BILL_NO")),l.createElement("th",{style:c({},Ee)},p("CS_PAYMENT_BILLING_PERIOD")),l.createElement("th",{style:c({},Ee)},p("CS_BILL_DUEDATE")),null==I||null===(re=I.filter(function(e,t){return t>0}))||void 0===re||null===(ue=re[0])||void 0===ue||null===(ce=ue.billAccountDetails)||void 0===ce||null===(se=ce.sort(function(e,t){return e.order-t.order}))||void 0===se?void 0:se.map(function(e,t){return l.createElement("th",{style:c({},Ee),key:t},p(e.taxHeadCode))}),l.createElement("th",{style:Ee},p("TOTAL_TAX")))),l.createElement("tbody",null,null==I||null===(de=I.filter(function(e,t){return t>0}))||void 0===de?void 0:de.map(function(e,t){var n,a,o,i=null==e||null===(n=e.billAccountDetails)||void 0===n?void 0:n.sort(function(e,t){return e.order-t.order});return l.createElement("tr",{key:t},l.createElement("td",{style:fe},null==e?void 0:e.billNumber),l.createElement("td",{style:fe},(o=(a=e).toPeriod,new Date(a.fromPeriod).toLocaleDateString()+"-"+new Date(o).toLocaleDateString())),l.createElement("td",{style:fe},(null==e?void 0:e.expiryDate)&&new Date(null==e?void 0:e.expiryDate).toLocaleDateString()),i.map(function(e,t){return l.createElement("td",{style:fe,key:t},e.amount)}),l.createElement("td",{style:fe},e.amount))}))))),l.createElement("div",{style:{float:"left"},onClick:function(){return L(!1)},className:"filter-button"},p("ES_COMMON_HIDE_DETAILS")))),!C&&(null==j?void 0:j.partPaymentAllowed)&&l.createElement("div",{style:{marginTop:"50px"},className:"bill-payment-amount"},l.createElement(t.CardSectionHeader,null,p("CS_COMMON_PAYMENT_AMOUNT")),l.createElement(t.RadioButtons,{style:{display:"flex"},innerStyles:{padding:"5px"},selectedOption:q,onSelect:Q,options:j.partPaymentAllowed?[p("CS_PAYMENT_FULL_AMOUNT"),p("CS_PAYMENT_CUSTOM_AMOUNT")]:[p("CS_PAYMENT_FULL_AMOUNT")]}),l.createElement("div",{style:{position:"relative"}},l.createElement("span",{className:"payment-amount-front",style:{border:"1px solid "+(q===p("CS_PAYMENT_FULL_AMOUNT")?"#9a9a9a":"black")}},"₹"),q!==p("CS_PAYMENT_FULL_AMOUNT")?l.createElement(t.TextInput,{style:{width:"30%"},className:"text-indent-xl",onChange:function(e){return ie(e.target.value)},value:$,disable:0===k()}):l.createElement(t.TextInput,{style:{width:"30%"},className:"text-indent-xl",value:k(),disable:!0}),"CS_CANT_PAY_BELOW_MIN_AMOUNT"===le?l.createElement("span",{className:"card-label-error"},p(le),": ","₹"+z):l.createElement("span",{className:"card-label-error"},p(le)))))},ft=["ManualRecieptDetails","paymentModeDetails"],pt=["errorObj"],_t=function(e){var i,u=Digit.Hooks.useQueryParams(),s=u.workflow,m=u.IsDisconnectionFlow,v=a.useTranslation().t,E=o.useHistory(),f=r.useQueryClient(),p=(o.useRouteMatch(),o.useParams()),_=p.consumerCode,y=p.businessService,S=Digit.ULBService.getCurrentTenantId(),N=o.useLocation().search;window.location.href.includes("ISWSAPP")&&(_=new URLSearchParams(N).get("applicationNumber")),(window.location.href.includes("ISWSCON")||"WS"===s)&&(_=decodeURIComponent(_));var b=Digit.Hooks.useFetchPayment({tenantId:S,consumerCode:_,businessService:y}),h=b.data,A=b.isLoading,C=null!=h&&h.Bill?null==h?void 0:h.Bill[0]:{},g=Digit.Hooks.fsm.useSearch(S,{applicationNos:_},{staleTime:Infinity,enabled:!(null==y||null===(i=y.toUpperCase())||void 0===i||!i.includes("FSM"))}).data,T=null==g?void 0:g.advanceAmount,D=function(e,t){return{cardConfig:[{head:t("PAYMENT_CARD_HEAD"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"paymentModeDetails",customProps:{},defaultValue:{},component:function(e,t){return l.createElement(I,c({onChange:e.onChange,value:e.value},t))}}}]}]}}(0,v).cardConfig,O=function(e,t){return{chequeConfig:[{head:t("PAYMENT_CHEQUE_HEAD"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"paymentModeDetails",customProps:{},defaultValue:{instrumentNumber:"",instrumentDate:"",ifscCode:"",bankName:"",bankBranch:""},component:function(e,t){return l.createElement(R,c({onChange:e.onChange,chequeDetails:e.value},t))}}}]}]}}(0,v).chequeConfig,M=function(e,t){return{cashConfig:[{head:t("NOC_PAYMENT_RCPT_DETAILS"),headId:"paymentInfo",body:[{withoutLabel:!0,type:"custom",populators:{name:"ManualRecieptDetails",customProps:{},defaultValue:{manualReceiptNumber:"",manualReceiptDate:""},component:function(e,t){return l.createElement(w,c({},t,{onChange:e.onChange,value:e.value}))}}}]}]}}(0,v).cashConfig,L=n.useState({}),x=L[0],B=L[1],F=n.useState(null),U=F[0],Y=F[1];n.useEffect(function(){null!=h&&h.Bill&&0===h.Bill.length&&Y({key:"error",action:"CS_BILL_NOT_FOUND"})},[h]);var H=[{code:"CASH",label:v("COMMON_MASTERS_PAYMENTMODE_CASH")},{code:"CHEQUE",label:v("COMMON_MASTERS_PAYMENTMODE_CHEQUE")},{code:"CARD",label:v("COMMON_MASTERS_PAYMENTMODE_CREDIT/DEBIT CARD")}],j={CHEQUE:O,CARD:D};n.useEffect(function(){e.setLink(v("PAYMENT_COLLECT_LABEL"))},[]);var W=function(){return H},V=[{code:"OWNER",name:v("COMMON_OWNER")},{code:"OTHER",name:v("COMMON_OTHER")}],z=n.useState((null==x?void 0:x.selectedPaymentMode)||W()[0]),G=z[0],K=z[1],q=n.useState((null==x?void 0:x.paidBy)||{code:"OWNER",name:v("COMMON_OWNER")}),Q=q[0],Z=q[1];n.useEffect(function(){var e,t,n,l;null===(e=document)||void 0===e||null===(t=e.getElementById("paymentInfo"))||void 0===t||t.scrollIntoView({behavior:"smooth"}),null===(n=document)||void 0===n||null===(l=n.querySelector("#paymentInfo + .label-field-pair input"))||void 0===l||l.focus()},[G]);var $,X=[{head:s||"TL"===y?"":v("COMMON_PAYMENT_HEAD"),body:[{label:v("PAY_TOTAL_AMOUNT"),populators:l.createElement(t.CardSectionHeader,{style:{marginBottom:0,textAlign:"right"}}," ","₹ "+(null==C?void 0:C.totalAmount)," ")}]},{head:v("PAYMENT_PAID_BY_HEAD"),body:[{label:v("PAYMENT_PAID_BY_LABEL"),isMandatory:!0,type:"custom",populators:{name:"paidBy",customProps:{t:v,isMendatory:!0,option:V,optionKey:"name"},component:function(e,n){return l.createElement(t.Dropdown,c({},n,{selected:e.value,select:function(t){t.name==V[0].name?e.setValue("payerName",null==C?void 0:C.payerName):(e.setValue("payerName",""),e.setValue("payerMobile","")),e.onChange(t),Z(t)}}))},defaultValue:(null==x?void 0:x.paidBy)||V[0]}},{label:v("PAYMENT_PAYER_NAME_LABEL"),isMandatory:!0,disable:!("OWNER"!==(null==Q?void 0:Q.code)||!(null!=C&&C.payerName||null!=x&&x.payerName)),type:"text",populators:{name:"payerName",validation:{required:!0,pattern:/^[A-Za-z]/},error:v("PAYMENT_INVALID_NAME"),defaultValue:(null==C?void 0:C.payerName)||(null==x?void 0:x.payerName)||"",className:"payment-form-text-input-correction"}},{label:v("PAYMENT_PAYER_MOB_LABEL"),isMandatory:!0,type:"text",populators:{name:"payerMobile",validation:{required:!0,pattern:/^[6-9]\d{9}$/},error:v("CORE_COMMON_APPLICANT_MOBILE_NUMBER_INVALID"),className:"payment-form-text-input-correction"}}]},{head:v("PAYMENT_MODE_HEAD"),body:[{label:v("PAYMENT_MODE_LABEL"),type:"custom",populators:{name:"paymentMode",customProps:{options:W(),optionsKey:"label",style:{display:"flex",flexWrap:"wrap"},innerStyles:{minWidth:"33%"}},defaultValue:(null==x?void 0:x.paymentMode)||W()[0],component:function(e,n){return l.createElement(t.RadioButtons,c({selectedOption:e.value,onSelect:function(t){e.onChange(t)}},n))}}}]}],J=window.location.href.includes("FSM");return A?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Header,{styles:{marginLeft:"15px"}},v(J?"PAYMENT_COLLECT_LABEL":"PAYMENT_COLLECT")),l.createElement(t.FormComposer,{cardStyle:{paddingBottom:"100px"},label:v("PAYMENT_COLLECT_LABEL"),config:function(){var e,t;(vt({consumerCode:_,businessService:y},v)[s?"SW"===y&&"WS"===s?y:s:y]||s||"TL"===y||y.includes("ONE_TIME_FEE"))&&X.splice(0,1);var n=X.concat(j[null==x||null===(e=x.paymentMode)||void 0===e?void 0:e.code]||[]);return n=null===(t=n)||void 0===t?void 0:t.concat(M),vt({consumerCode:_,businessService:y},v)[s?"SW"===y&&"WS"===s?y:s:y]?vt({consumerCode:_,businessService:y},v)[s?"SW"===y&&"WS"===s?y:s:y].concat(n):n}(),onSubmit:function(t){try{var n,l,a,o,i,r,u,p,N,b;if(C.totalAmount=Math.round(C.totalAmount),t.paidBy=t.paidBy.code,vt({consumerCode:_,businessService:y},v)[s?"SW"===y&&"WS"===s?y:s:y]&&(null==t||null===(n=t.amount)||void 0===n||!n.paymentAllowed)){var h,A,D,O,M="CS_CANT_PAY_BELOW_MIN_AMOUNT"===(null==t||null===(h=t.amount)||void 0===h?void 0:h.error)?v(null==t||null===(A=t.amount)||void 0===A?void 0:A.error)+"- "+(null==t||null===(D=t.amount)||void 0===D?void 0:D.minAmountPayable):v(null==t||null===(O=t.amount)||void 0===O?void 0:O.error);return Y({key:"error",action:M}),Promise.resolve()}var L=t.ManualRecieptDetails,w=t.paymentModeDetails,I=(d(t,ft),w||{}),R=d(I,pt),k={Payment:{mobileNumber:t.payerMobile,paymentDetails:[{businessService:y,billId:C.id,totalDue:C.totalAmount,totalAmountPaid:(null==t||null===(l=t.amount)||void 0===l?void 0:l.amount)||C.totalAmount}],tenantId:C.tenantId,totalDue:C.totalAmount,totalAmountPaid:(null==t||null===(a=t.amount)||void 0===a?void 0:a.amount)||C.totalAmount,paymentMode:t.paymentMode.code,payerName:t.payerName,paidBy:t.paidBy}};if(null===T||"PENDING_APPL_FEE_PAYMENT"!==(null==g?void 0:g.applicationStatus)||g.paymentPreference||(k.Payment.paymentDetails[0].totalAmountPaid=T,k.Payment.totalAmountPaid=T,k.Payment.totalDue=C.totalAmount),t.ManualRecieptDetails.manualReceiptDate&&(k.Payment.paymentDetails[0].manualReceiptDate=new Date(L.manualReceiptDate).getTime()),t.ManualRecieptDetails.manualReceiptNumber&&(k.Payment.paymentDetails[0].manualReceiptNumber=L.manualReceiptNumber),k.Payment.paymentMode=null==t||null===(o=t.paymentMode)||void 0===o?void 0:o.code,t.paymentModeDetails){var x;if(k.Payment=c({},k.Payment,R),delete k.Payment.paymentModeDetails,t.paymentModeDetails.errorObj){var B=t.paymentModeDetails.errorObj,F=Object.keys(B).map(function(e){return v(B[e])}).join();if(F)return Y({key:"error",action:F+" "+v("ES_ERROR_REQUIRED")}),setTimeout(function(){return Y(null)},5e3),Promise.resolve()}t.errorMsg&&Y({key:"error",action:v(errorMsg)}),k.Payment.instrumentDate=new Date(null==k||null===(x=k.Payment)||void 0===x?void 0:x.instrumentDate).getTime(),k.Payment.transactionNumber=t.paymentModeDetails.transactionNumber}if(null!=t&&null!==(i=t.paymentModeDetails)&&void 0!==i&&i.transactionNumber){if(t.paymentModeDetails.transactionNumber!==t.paymentModeDetails.reTransanctionNumber&&["CARD"].includes(t.paymentMode.code))return Y({key:"error",action:v("ERR_TRASACTION_NUMBERS_DONT_MATCH")}),setTimeout(function(){return Y(null)},5e3),Promise.resolve();delete k.Payment.last4Digits,delete k.Payment.reTransanctionNumber}if(null!==(r=k.Payment)&&void 0!==r&&null!==(u=r.instrumentNumber)&&void 0!==u&&u.length&&(null===(p=k.Payment)||void 0===p||null===(N=p.instrumentNumber)||void 0===N?void 0:N.length)<6&&"CHEQUE"===(null==k||null===(b=k.Payment)||void 0===b?void 0:b.paymentMode))return Y({key:"error",action:v("ERR_CHEQUE_NUMBER_LESS_THAN_6")}),setTimeout(function(){return Y(null)},5e3),Promise.resolve();var U=P(function(){return Promise.resolve(Digit.PaymentService.createReciept(S,k)).then(function(t){var n,l,a,o,i,r,u,c,s,d;f.invalidateQueries(),E.push(m?e.basePath+"/success/"+y+"/"+(null==t||null===(n=t.Payments[0])||void 0===n||null===(l=n.paymentDetails[0])||void 0===l?void 0:l.receiptNumber.replace(/\//g,"%2F"))+"/"+(null==t||null===(a=t.Payments[0])||void 0===a||null===(o=a.paymentDetails[0])||void 0===o||null===(i=o.bill)||void 0===i?void 0:i.consumerCode)+"?IsDisconnectionFlow="+m:e.basePath+"/success/"+y+"/"+(null==t||null===(r=t.Payments[0])||void 0===r||null===(u=r.paymentDetails[0])||void 0===u?void 0:u.receiptNumber.replace(/\//g,"%2F"))+"/"+(null==t||null===(c=t.Payments[0])||void 0===c||null===(s=c.paymentDetails[0])||void 0===s||null===(d=s.bill)||void 0===d?void 0:d.consumerCode)+"?IsDisconnectionFlow="+m)})},function(e){var t,n,l,a;null===(t=Y({key:"error",action:null==e||null===(n=e.response)||void 0===n||null===(l=n.data)||void 0===l||null===(a=l.Errors)||void 0===a?void 0:a.map(function(e){return v(e.code)})}))||void 0===t||t.join(" , "),setTimeout(function(){return Y(null)},5e3)});return Promise.resolve(U&&U.then?U.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},formState:x,defaultValues:{payerName:(null===($=(null==C?void 0:C.payerName)||(null==x?void 0:x.payerName)||"")||void 0===$?void 0:$.trim())||""},isDisabled:!m&&(null==C||!C.totalAmount||!C.totalAmount>0),onFormValueChange:function(e,t){(function e(t,n,l,a,o){return t===n||(null==t||null==n||!Ie(t)&&!Ie(n)?t!=t&&n!=n:function(e,t,n,l,a,o){var i=Oe(e),r=Oe(t),u=i?"[object Array]":dt(e),c=r?"[object Array]":dt(t),s="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),m=u==c;if(m&&Ye(e)){if(!Ye(t))return!1;i=!0,s=!1}if(m&&!s)return o||(o=new Se),i||qe(e)?Ae(e,t,n,l,a,o):function(e,t,n,l,a,o,i){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Ce(e),new Ce(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return k(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var r=ge;case"[object Set]":if(r||(r=Pe),e.size!=t.size&&!(1&l))return!1;var u=i.get(e);if(u)return u==t;l|=2,i.set(e,t);var c=Ae(r(e),r(t),l,a,o,i);return i.delete(e),c;case"[object Symbol]":if(De)return De.call(e)==De.call(t)}return!1}(e,t,u,n,l,a,o);if(!(1&n)){var v=s&&mt.call(e,"__wrapped__"),E=d&&mt.call(t,"__wrapped__");if(v||E){var f=v?e.value():e,p=E?t.value():t;return o||(o=new Se),a(f,p,n,l,o)}}return!!m&&(o||(o=new Se),function(e,t,n,l,a,o){var i=1&n,r=Je(e),u=r.length;if(u!=Je(t).length&&!i)return!1;for(var c=u;c--;){var s=r[c];if(!(i?s in t:et.call(t,s)))return!1}var d=o.get(e),m=o.get(t);if(d&&m)return d==t&&m==e;var v=!0;o.set(e,t),o.set(t,e);for(var E=i;++c<u;){var f=e[s=r[c]],p=t[s];if(l)var _=i?l(p,f,s,t,e,o):l(f,p,s,e,t,o);if(!(void 0===_?f===p||a(f,p,n,l,o):_)){v=!1;break}E||(E="constructor"==s)}if(v&&!E){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(v=!1)}return o.delete(e),o.delete(t),v}(e,t,n,l,a,o))}(t,n,l,a,e,o))})(t.paymentMode,G)||(B(t),K(x.paymentMode))}}),U&&l.createElement(t.Toast,{error:"error"===U.key,label:v("success"===U.key?"ES_"+y.split(".")[0].toLowerCase()+"_"+U.action+"_UPDATE_SUCCESS":U.action),onClose:function(){return Y(null)},style:{maxWidth:"670px"}}))},yt=function(e){var i,u,s,d,m,v,E,f,p,_,y,S,N,b,h,A=o.useHistory(),C=a.useTranslation().t,g=r.useQueryClient(),P=Digit.Hooks.useQueryParams().IsDisconnectionFlow,T=n.useState(!1),D=T[0],O=T[1],M=n.useState(null),L=M[0],w=M[1],I=(null===(i=location)||void 0===i||null===(u=i.pathname)||void 0===u?void 0:u.includes("payment/success/FSM.TRIP_CHARGES"))?C("PAYMENT_COLLECT_LABEL")+" / "+C("PAYMENT_COLLECT"):C("PAYMENT_LOCALIZATION_RESPONSE");e.setLink(I);var R=o.useParams(),k=R.consumerCode,x=R.receiptNumber,B=R.businessService,F=Digit.ULBService.getCurrentTenantId();x=x.replace(/%2F/g,"/");var U=(null===(s=Digit)||void 0===s||null===(d=s.Hooks)||void 0===d||null===(m=d.obps)||void 0===m?void 0:m.useOBPSSearch("",{},F,{applicationNo:k},{},{enabled:!(null==B||!B.includes("BPA"))}))||{},Y=U.data,H=void 0===Y?{}:Y,j=U.isLoading,W=Digit.UserService.hasAccess("FSM_EDITOR_EMP")||!1;n.useEffect(function(){return function(){g.clear()}},[]),n.useEffect(function(){var e,t;switch(L){case"GO_TO_HOME":return A.push("/"+(null===(e=window)||void 0===e?void 0:e.contextPath)+"/employee");case"ASSIGN_TO_DSO":return A.push("/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/employee/fsm/application-details/"+k);default:return null}},[L]);var V=["GO_TO_HOME"];W&&(V=[].concat(V,["ASSIGN_TO_DSO"]));var z=null==B?void 0:B.includes("FSM"),G=Digit.Hooks.useCommonMDMS(F,"common-masters","ReceiptKey",{select:function(e){var t,n,l;return(null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonPay)||void 0===n||null===(l=n.filter(function(e){return null==B?void 0:B.includes(e.code)})[0])||void 0===l?void 0:l.receiptKey)||"consolidatedreceipt"}}).data,K=function(e,t){void 0===t&&(t="download");try{var n,l,a={applicationNo:null==H||null===(n=H[0])||void 0===n?void 0:n.applicationNo};return Promise.resolve(Digit.OBPSService.BPASearch(null==H||null===(l=H[0])||void 0===l?void 0:l.tenantId,a)).then(function(n){var l,a;return Promise.resolve(Digit.OBPSService.scrutinyDetails(null==H||null===(l=H[0])||void 0===l?void 0:l.tenantId,{edcrNumber:null==H||null===(a=H[0])||void 0===a?void 0:a.edcrNumber})).then(function(l){var a,o,i=null==n||null===(a=n.BPA)||void 0===a?void 0:a[0],r=null==l||null===(o=l.edcrDetail)||void 0===o?void 0:o[0],u=new Date;i.additionalDetails.runDate=function(e,t){void 0===t&&(t="dayend");try{var n=e.match(/(\d{4})-(\d{1,2})-(\d{1,2})/),l=new Date(Date.UTC(n[1],n[2]-1,n[3]));return l.setMinutes(l.getMinutes()+l.getTimezoneOffset()),"dayend"===t&&(l.setHours(l.getHours()+24),l.setSeconds(l.getSeconds()-1)),l.getTime()}catch(t){return e}}(u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate());var s=c({},i,{edcrDetail:[c({},r)]});return Promise.resolve(Digit.PaymentService.generatePdf(null==i?void 0:i.tenantId,{Bpa:[s]},e)).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(null==i?void 0:i.tenantId,{fileStoreIds:e.filestoreIds[0]})).then(function(n){var l,a;return window.open(n[null==e?void 0:e.filestoreIds[0]],"_blank"),s.applicationType=null==H||null===(l=H[0])||void 0===l||null===(a=l.additionalDetails)||void 0===a?void 0:a.applicationType,Promise.resolve(Digit.OBPSService.edcr_report_download({BPA:c({},s)})).then(function(e){var n,l,a,o=parseInt(e.status,10);201!==o&&200!==o||("print"==t?(n=new Blob([e.data],{type:"application/pdf"}),l=URL.createObjectURL(n),null!=(a=window.open(l))&&a.addEventListener("load",function(e){a.focus(),a.print()})):function(e,t){if(window.mSewaApp&&window.mSewaApp.isMsewaApp()&&window.mSewaApp.downloadBase64File){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){mSewaApp.downloadBase64File(n.result,"edcrReport.pdf")}}else{var l=document.createElement("a");l.href=URL.createObjectURL(e),l.download="edcrReport.pdf",document.body.append(l),l.click(),l.remove(),setTimeout(function(){return URL.revokeObjectURL(l.href)},7e3)}}(new Blob([e.data],{type:"application/pdf"})))})})})})})}catch(e){return Promise.reject(e)}};return null!=B&&B.includes("BPA")&&j?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,l.createElement(t.Card,null,l.createElement(t.Banner,{message:C("ES_PAYMENT_COLLECTED"),info:C("PAYMENT_LOCALIZATION_RECIEPT_NO"),applicationNumber:x,successful:!0}),l.createElement(t.CardText,null,function(){if(null!=B&&B.includes("BPA")){var e=sessionStorage.getItem("BPA_ARCHITECT_NAME"),t=e?JSON.parse(e):"ARCHITECT";return C("ES_PAYMENT_"+B+"_"+t+"_SUCCESSFUL_DESCRIPTION")}return null!=B&&B.includes("WS")||null!=B&&B.includes("SW")?C("ES_PAYMENT_WS_"+(null==B?void 0:B.replace(/\./g,"_"))+"_SUCCESSFUL_DESCRIPTION"):C("ES_PAYMENT_SUCCESSFUL_DESCRIPTION")}()),G?l.createElement("div",{style:{display:"flex"}},l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset",marginRight:"20px"},onClick:"true"===P?function(){try{var e=F||Digit.ULBService.getCurrentTenantId(),t=window.location.href.substring(window.location.href.lastIndexOf(k),window.location.href.lastIndexOf("?"));return Promise.resolve(Digit.Utils.downloadReceipt(t,B,"consolidatedreceipt",e)).then(function(){})}catch(e){return Promise.reject(e)}}:function(){try{var e=Digit.ULBService.getCurrentTenantId(),t=Digit.ULBService.getStateId();return Promise.resolve(Digit.PaymentService.getReciept(e,B,{receiptNumbers:x})).then(function(e){var n;function l(){return Promise.resolve(Digit.PaymentService.printReciept(t,{fileStoreIds:a.filestoreIds[0]})).then(function(e){window.open(e[a.filestoreIds[0]],"_blank")})}var a={filestoreIds:[null===(n=e.Payments[0])||void 0===n?void 0:n.fileStoreId]},o=function(n){if(null===(n=e.Payments[0])||void 0===n||!n.fileStoreId)return Promise.resolve(Digit.PaymentService.generatePdf(t,{Payments:e.Payments},G)).then(function(e){a=e})}();return o&&o.then?o.then(l):l()})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})),C("CS_COMMON_PRINT_RECEIPT")),"TL"==B?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(){try{var e=Digit.ULBService.getCurrentTenantId(),t=Digit.ULBService.getStateId();return Promise.resolve(Digit.TLService.search({applicationNumber:k,tenantId:e})).then(function(e){var n=function(){if(e)return Promise.resolve(Digit.PaymentService.generatePdf(t,{Licenses:null==e?void 0:e.Licenses},"tlcertificate")).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(t,{fileStoreIds:e.filestoreIds[0]})).then(function(t){window.open(t[e.filestoreIds[0]],"_blank")})})}();if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},l.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),l.createElement("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"})),C("CS_COMMON_PRINT_CERTIFICATE")):null,"BPA_OC"!==(null==H||null===(v=H[0])||void 0===v?void 0:v.businessService)||"APPROVED"!==(null==H||null===(E=H[0])||void 0===E?void 0:E.status)&&"PENDING_SANC_FEE_PAYMENT"!==(null==H||null===(f=H[0])||void 0===f?void 0:f.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return K("occupancy-certificate")}},l.createElement(t.DownloadPrefixIcon,null),C("BPA_OC_CERTIFICATE")),"BPA_LOW"===(null==H||null===(p=H[0])||void 0===p?void 0:p.businessService)?l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return K("buildingpermit-low")}},l.createElement(t.DownloadPrefixIcon,null),C("BPA_PERMIT_ORDER")):null,"BPA"!==(null==H||null===(_=H[0])||void 0===_?void 0:_.businessService)||"BPA_LOW"===(null==H||null===(y=H[0])||void 0===y?void 0:y.businessService)||"BPA_OC"===(null==H||null===(S=H[0])||void 0===S?void 0:S.businessService)||"PENDING_SANC_FEE_PAYMENT"!==(null==H||null===(N=H[0])||void 0===N?void 0:N.status)&&"APPROVED"!==(null==H||null===(b=H[0])||void 0===b?void 0:b.status)?null:l.createElement("div",{className:"primary-label-btn d-grid",style:{marginLeft:"unset"},onClick:function(e){return K("buildingpermit")}},l.createElement(t.DownloadPrefixIcon,null),C("BPA_PERMIT_ORDER"))):null),z?l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},D?l.createElement(t.Menu,{localeKeyPrefix:"ES_COMMON",options:V,t:C,onSelect:function(e){w(e),O(!1)}}):null,l.createElement(t.SubmitBar,{label:C("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return O(!D)}})):l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},l.createElement(o.Link,{to:"/"+(null===(h=window)||void 0===h?void 0:h.contextPath)+"/employee"},l.createElement(t.SubmitBar,{label:C("CORE_COMMON_GO_TO_HOME")}))))},St=function(e){var n;e.setLink("Response");var i=a.useTranslation().t,r=o.useParams().consumerCode;return l.createElement(l.Fragment,null,l.createElement(t.Card,null,l.createElement(t.Banner,{message:i("ES_PAYMENT_COLLECTED_ERROR"),complaintNumber:r,successful:!1}),l.createElement(t.CardText,null,i("ES_PAYMENT_FAILED_DETAILS"))),l.createElement(t.ActionBar,{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline"}},l.createElement(o.Link,{to:"/"+(null===(n=window)||void 0===n?void 0:n.contextPath)+"/employee"},l.createElement(t.SubmitBar,{label:i("CORE_COMMON_GO_TO_HOME")}))))},Nt={a:["1","2","3"],b:["4","5","6"],c:["7","8","9"],j:["10","11","12"],k:["22","45"],l:["456"]},bt=function(e){var i=e.stateCode,r=o.useParams(),u=r.moduleName,c=r.pageName,s=a.useTranslation().t,d=n.useState(""),m=d[0],v=d[1],E=n.useState(""),f=E[0],p=E[1],_=Digit.Hooks.dss.useMDMS(i,"common-masters",["uiCommonConstants"],{select:function(e){var t,n;return(null==e||null===(t=e["common-masters"])||void 0===t||null===(n=t.uiCommonConstants)||void 0===n?void 0:n[0])||{}},enabled:!0}),y=_.data,S=_.isLoading;return n.useEffect(function(){var e,t,n=(null==y||null===(e=y[u])||void 0===e||null===(t=e["iframe-routes"])||void 0===t?void 0:t[c])||{},l=(null==n?void 0:n.isOrigin)?"development"===process.env.NODE_ENV?"https://qa.digit.org":document.location.origin:null==n?void 0:n.domain,a=(null==n?void 0:n.title)||"";v(""+l+((null==n?void 0:n.routePath)||"")),p(a)},[y,u,c]),S?l.createElement(t.Loader,null):m?l.createElement(l.Fragment,null,l.createElement(t.Header,null,s(f)),l.createElement("div",{className:"app-iframe-wrapper"},l.createElement("iframe",{src:m,title:f,className:"app-iframe"}))):l.createElement("div",null,"No Iframe To Load")};u.subFormRegistry.addSubForm("testForm",{addedFields:[],middlewares:[{middleWare_1:function(e,t,n){try{return e.a="a",Promise.resolve(n(e))}catch(e){return Promise.reject(e)}}},{middleWare_2:function(e,t,n){try{return e.b="b",Promise.resolve(n(e))}catch(e){return Promise.reject(e)}}},{middleWare_3:function(e,t,n){try{var l=function(){return Promise.resolve(n(e))};e.c="c";var a=function(){if("b"===e.b){var t=P(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/hdfc0000090")).then(function(t){var n=function(){if(t.ok)return Promise.resolve(t.json()).then(function(t){e.BANKFROMMiddleWare=t.BANK});alert("Wrong IFSC Code")}();if(n&&n.then)return n.then(function(){})})},function(){alert("Something Went Wrong !")});if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(a&&a.then?a.then(l):l())}catch(e){return Promise.reject(e)}}}],state:{firstDDoptions:["a","b","c"],secondDDoptions:Nt.a,thirdDDoptions:["d","e","f"]},fields:[{label:"first",name:"pehla",defaultValue:"b",customProps:function(e){return{isMendatory:!0,option:e.firstDDoptions}},component:function(e,n){return l.createElement(t.Dropdown,c({select:function(t){e.setState({secondDDoptions:Nt[t]}),e.setValue("doosra",""),e.onChange(t)},selected:e.value},n))},validations:{}},{label:"second",name:"doosra",customProps:function(e){return{isMendatory:!0,option:e.secondDDoptions}},defaultValue:function(e){return e.secondDDoptions[1]},component:function(e,n){return l.createElement(t.Dropdown,c({select:function(t){e.onChange(t)},selected:e.value},n))}},{label:"third",name:"teesra",customProps:function(e){return{isMendatory:!0,option:e.thirdDDoptions}},defaultValue:"d",component:function(e,n){return l.createElement(t.Dropdown,c({select:function(t){e.onChange(t)},selected:e.value},n))}},{label:"IFSC",name:"ifsc",customProps:{isMendatory:!0,setBankDetailsFromIFSC:function(e){try{var t=P(function(){return Promise.resolve(window.fetch("https://ifsc.razorpay.com/"+e.getValues("ifsc"))).then(function(t){var n=function(){if(t.ok)return Promise.resolve(t.json()).then(function(t){var n=t.BRANCH;e.setValue("bank",t.BANK),e.setValue("branch",n)});alert("Wrong IFSC Code")}();if(n&&n.then)return n.then(function(){})})},function(){alert("Something Went Wrong !")});return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}},defaultValue:"",component:function(e,n){return l.createElement("div",{className:"ifsc-field"},l.createElement("input",{value:e.value,type:"text",onChange:function(t){e.setState({ifsc:t.target.value}),e.onChange(t.target.value)}}),l.createElement("button",{type:"button",onClick:function(){n.setBankDetailsFromIFSC(e)}},l.createElement(t.SearchIconSvg,null)))}},{label:"Bank",name:"bank",defaultValue:"d",component:function(e,t){return l.createElement("input",{readOnly:!0,value:e.value})}},{label:"Branch",name:"branch",defaultValue:"d",component:function(e,t){return l.createElement("input",{readOnly:!0,value:e.value})}}]});var ht=function(e){var t,i,r,u,s,d,m,v=e.stateCode,E=e.cityCode,f=e.moduleCode,p=o.useRouteMatch().path,_=a.useTranslation().t,y=n.useState(null),S=y[0],N={stateCode:v,cityCode:E,moduleCode:f,setLink:y[1]},b=(null===(t=location)||void 0===t||null===(i=t.pathname)||void 0===i?void 0:i.includes("fsm"))||(null===(r=location)||void 0===r||null===(u=r.pathname)||void 0===u?void 0:u.includes("FSM"));return l.createElement(l.Fragment,null,l.createElement("p",{className:"breadcrumb",style:{marginLeft:"15px"}},l.createElement(o.Link,{to:"/"+(null===(s=window)||void 0===s?void 0:s.contextPath)+"/employee"},_("ES_COMMON_HOME")),b?l.createElement(o.Link,{to:"/"+(null===(d=window)||void 0===d?void 0:d.contextPath)+"/employee/fsm/home"},"/ ",_("ES_TITLE_FSM")," "):null,b?l.createElement(o.Link,{to:"/"+(null===(m=window)||void 0===m?void 0:m.contextPath)+"/employee/fsm/inbox"},"/ ",_("ES_TITLE_INBOX")):null,"/ ",S),l.createElement(o.Switch,null,l.createElement(o.Route,{path:p+"/collect/:businessService/:consumerCode"},l.createElement(_t,c({},N,{basePath:p}))),l.createElement(o.Route,{path:p+"/success/:businessService/:receiptNumber/:consumerCode"},l.createElement(yt,N)),l.createElement(o.Route,{path:p+"/integration/:moduleName/:pageName"},l.createElement(bt,N)),l.createElement(o.Route,{path:p+"/failure"},l.createElement(St,N))))},At={getBillDetailsConfigWithBusinessService:function(e,t){switch(null==e?void 0:e.toLowerCase().split(".")[0]){case"pt":return{"my-bill":[{keyValue:"CS_COMMON_AMOUNT_DUE",keyPath:[function(e){var n,a=(new Date).getTime()-new Date(null===(n=e.billDetails[0])||void 0===n?void 0:n.toPeriod).getTime(),o=Math.floor(a/864e5);return l.createElement(l.Fragment,null,"₹"+e.totalAmount,o>=0?l.createElement("span",{className:"card-label-error",style:{fontSize:"16px",fontWeight:"normal"}}," ( "+t("CS_PAYMENT_OVERDUE")+" "+o+" "+t(1===o?"CS_COMMON_DAY":"CS_COMMON_DAYS")+")"):null)}],fallback:"N/A",noteStyle:{fontWeight:"bold",fontSize:"24px",paddingTop:"5px"}},{keyValue:"PT_PROPERTY_ID",keyPath:["propertyId"],fallback:""},{keyValue:"CS_OWNER_NAME",keyPath:["owners",0,"name"],fallback:"ES_TITLE_FSM"},{keyValue:"PT_PROPERTY_ADDRESS",keyPath:["address","locality","name"],fallback:"CS_APPLICATION_TYPE_DESLUDGING"},{keyValue:"CS_PAYMENT_BILLING_PERIOD",keyPath:["billDetails",function(e){var t=e[0],n=t.fromPeriod,l=t.toPeriod;return n&&l?"FY "+new Date(n).getFullYear().toString()+"-"+new Date(l).getFullYear().toString():"N/A"}],fallback:"N/A"},{keyValue:"PT_DUE_DATE",keyPath:["billDetails",function(e){var t,n;if(null===(t=e[0])||void 0===t||!t.toPeriod)return"N/A";var l=new Date(null===(n=e[0])||void 0===n?void 0:n.toPeriod),a=Digit.Utils.date.monthNames[l.getMonth()];return l.getDate()+" "+a+" "+l.getFullYear()}],fallback:"N/A"}],response:[]};case"fsm":return{"my-bill":[{keyValue:"CS_COMMON_AMOUNT_DUE",keyPath:["totalAmount",function(e){return e.toFixed(2)},function(e){return"₹"+e}],fallback:"N/A",noteStyle:{fontWeight:"bold",fontSize:"24px",paddingTop:"5px"}}],response:[]}}}};exports.PaymentLinks=function(e){return a.useTranslation(),null},exports.PaymentModule=function(e){var n=e.stateCode,a=e.cityCode,i=e.moduleCode,r=void 0===i?"Payment":i,u=e.userType,c=o.useRouteMatch(),s=c.path,d=c.url;return 0===Object.keys({data:{}}).length?l.createElement(t.Loader,null):l.createElement(l.Fragment,null,"citizen"===u?l.createElement(L,{stateCode:n,moduleCode:r,cityCode:a,path:s,url:d}):l.createElement(ht,{stateCode:n,cityCode:a,moduleCode:r}))},exports.paymentConfigs=At;
